{"generatedAt":1737626504995,"generateTime":478,"contents":[{"_path":"/config","_dir":"","_draft":false,"_partial":false,"_locale":"","publicProps":{"title":"Green Digital Skills","baseURL":"green-digital-skills","repoName":"green-digital-skills","repoOwner":"esciencecenter-digital-skills","organization":"Netherlands eScience Center and SURF","organizationURL":"https://www.esciencecenter.nl","organizationLogo":"/main/media/nlesc-surf.svg","categoryOrder":["Lecture","Workshop"]},"_id":"local_fs:config.json","_type":"json","title":"Config","_source":"local_fs","_file":"config.json","_stem":"config","_extension":"json"},{"_path":"/","_dir":"","_draft":false,"_partial":false,"_locale":"","title":"Hello world","description":"Here is some markdown content.","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"hello-world"},"children":[{"type":"text","value":"Hello world"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here is some markdown content."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"/lessons/demo"},"children":[{"type":"text","value":"Demo lesson link"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:index.md","_source":"local_fs","_file":"index.md","_stem":"index","_extension":"md","plainText":"# Hello world\n\nHere is some markdown content.\n\n[Demo lesson link](/lessons/demo)"},{"_path":"/license","_dir":"","_draft":false,"_partial":false,"_locale":"","title":"LICENSE","description":"The content of the modules/ folder of this project is licensed under a Creative Commons Attribution 4.0 International License.","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"rel":["license"],"href":"http://creativecommons.org/licenses/by/4.0/"},"children":[{"type":"element","tag":"img","props":{"alt":"Creative Commons License","style":"border-width:0","src":"https://i.creativecommons.org/l/by/4.0/88x31.png"},"children":[]}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"text","value":"The content of the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"modules/"}]},{"type":"text","value":" folder of this project is licensed under a "},{"type":"element","tag":"a","props":{"rel":["license"],"href":"http://creativecommons.org/licenses/by/4.0/"},"children":[{"type":"text","value":"Creative Commons Attribution 4.0 International License"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This license does not apply to any image files in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"modules"}]},{"type":"text","value":" folder or its subfolders.\nImage files are files with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".png"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".jpg"}]},{"type":"text","value":", "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".svg"}]},{"type":"text","value":", or "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":".gif"}]},{"type":"text","value":" extensions."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:LICENSE.md","_source":"local_fs","_file":"LICENSE.md","_stem":"LICENSE","_extension":"md","plainText":"<a rel=\"license\" href=\"http://creativecommons.org/licenses/by/4.0/\"><img alt=\"Creative Commons License\" style=\"border-width:0\" src=\"https://i.creativecommons.org/l/by/4.0/88x31.png\" /></a><br />The content of the `modules/` folder of this project is licensed under a <a rel=\"license\" href=\"http://creativecommons.org/licenses/by/4.0/\">Creative Commons Attribution 4.0 International License</a>.\n\nThis license does not apply to any image files in the `modules` folder or its subfolders.\nImage files are files with `.png`, `.jpg`, `.svg`, or `.gif` extensions.\n"},{"_path":"/main/about","_dir":"main","_draft":false,"_partial":false,"_locale":"","title":"About","description":"","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"about-the-green-digital-skills-course"},"children":[{"type":"text","value":"About the Green Digital Skills course"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this course, we want to equip the attendees with\na basic knowledge of the link from digital and computational science to energy consumption, and\neventually equivalent CO2 emissions."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The course material consists of two parts:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"a lecture, in three chapters, introducing the general topic of "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"green"}]},{"type":"text","value":" computing"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"a set of hands-on exercises, covering general good practices for software development, and tools for measuring energy and CO2 emissions on your laptop or on HPC clusters"}]}]},{"type":"element","tag":"h2","props":{"id":"target-audience"},"children":[{"type":"text","value":"Target audience"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The target audience for this course includes, but is not limited to, students, reseachers,\ndata scientists, and IT support staff performing computational science, handling data, or\nusing/developing scientific software."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"about-the-green-digital-skills-course","depth":2,"text":"About the Green Digital Skills course"},{"id":"target-audience","depth":2,"text":"Target audience"}]}},"_type":"markdown","_id":"local_fs:main:about.md","_source":"local_fs","_file":"main/about.md","_stem":"main/about","_extension":"md","plainText":"---\ntitle: About\n---\n\n## About the Green Digital Skills course\n\nIn this course, we want to equip the attendees with\na basic knowledge of the link from digital and computational science to energy consumption, and\neventually equivalent CO2 emissions.\n\nThe course material consists of two parts: \n - a lecture, in three chapters, introducing the general topic of `green` computing\n - a set of hands-on exercises, covering general good practices for software development, and tools for measuring energy and CO2 emissions on your laptop or on HPC clusters \n\n\n## Target audience\n\nThe target audience for this course includes, but is not limited to, students, reseachers,\ndata scientists, and IT support staff performing computational science, handling data, or\nusing/developing scientific software.\n"},{"_path":"/main/contribute","_dir":"main","_draft":false,"_partial":false,"_locale":"","title":"Contribute","description":"","body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"contributing-to-this-lesson"},"children":[{"type":"text","value":"Contributing to this lesson"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Add contributing guidelines for you project."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"contributing-to-this-lesson","depth":2,"text":"Contributing to this lesson"}]}},"_type":"markdown","_id":"local_fs:main:contribute.md","_source":"local_fs","_file":"main/contribute.md","_stem":"main/contribute","_extension":"md","plainText":"---\ntitle: Contribute\n---\n\n## Contributing to this lesson\n\nAdd contributing guidelines for you project."},{"_path":"/main/workshops","_dir":"main","_draft":false,"_partial":false,"_locale":"","title":"Workshops","description":"","order":4,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"past-workshops"},"children":[{"type":"text","value":"Past workshops"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"right"},"children":[{"type":"text","value":"Date"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Organisation"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Location"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Comments"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"2024-11-21"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Netherlands eScience Center, SURF"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Prinses Máxima Centrum voor Kinderoncologie, The Netherlands"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Pilot workshop"}]}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"past-workshops","depth":2,"text":"Past workshops"}]}},"_type":"markdown","_id":"local_fs:main:workshops.md","_source":"local_fs","_file":"main/workshops.md","_stem":"main/workshops","_extension":"md","plainText":"---\ntitle: Workshops\norder: 4\n---\n\n## Past workshops\n\n| Date               | Organisation                 | Location                              | Comments                    |\n|-------------------:|:-----------------------------|:--------------------------------------|:----------------------------|\n| 2024-11-21         | Netherlands eScience Center, SURF  | Prinses Máxima Centrum voor Kinderoncologie, The Netherlands | Pilot workshop          |\n"},{"_path":"/modules/environmental_impact/exercises","_dir":"environmental_impact","_draft":false,"_partial":false,"_locale":"","title":"Exercises","description":"","type":"exercise","order":4,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"exercises"},"children":[{"type":"text","value":"Exercises"}]},{"type":"element","tag":"h3","props":{"id":"estimate-the-carbon-cost-for-your-work"},"children":[{"type":"text","value":"Estimate the carbon cost for your work"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Try using the Green Algorithms calculator ("},{"type":"element","tag":"a","props":{"href":"http://calculator.green-algorithms.org/","rel":["nofollow"]},"children":[{"type":"text","value":"http://calculator.green-algorithms.org/"}]},{"type":"text","value":")\nto estimate the environmental cost of a calculation you have done recently in your daily work\n(or a potential calculation you may wish to do in future)."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"exercises","depth":2,"text":"Exercises","children":[{"id":"estimate-the-carbon-cost-for-your-work","depth":3,"text":"Estimate the carbon cost for your work"}]}]}},"_type":"markdown","_id":"local_fs:modules:environmental_impact:exercises.md","_source":"local_fs","_file":"modules/environmental_impact/exercises.md","_stem":"modules/environmental_impact/exercises","_extension":"md","plainText":"---\ntitle: Exercises\ntype: exercise\norder: 4\n---\n\n## Exercises\n\n\n### Estimate the carbon cost for your work\nTry using the Green Algorithms calculator (<http://calculator.green-algorithms.org/>)\nto estimate the environmental cost of a calculation you have done recently in your daily work\n(or a potential calculation you may wish to do in future).\n"},{"_path":"/modules/environmental_impact","_dir":"modules","_draft":false,"_partial":false,"_locale":"","title":"Environmental Impact","description":"","order":2,"category":"Lecture","author":"eScience Center","thumbnail":"energy-budget-thumbnail.avif","abstract":"Learn about the imact of Information Computing Technology on carbon output and initiatives to measure and reduce this.","visibility":"visible","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"category-1"},"children":[{"type":"text","value":"Category 1"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:environmental_impact:index.md","_source":"local_fs","_file":"modules/environmental_impact/index.md","_stem":"modules/environmental_impact/index","_extension":"md","plainText":"---\norder: 2\ncategory: Lecture\ntitle: Environmental Impact\nauthor: eScience Center\nthumbnail: \"energy-budget-thumbnail.avif\"\nabstract: Learn about the imact of Information Computing Technology on carbon output and initiatives to measure and reduce this. \nvisibility: visible\n---\n\n# Category 1\n"},{"_path":"/modules/environmental_impact/info","_dir":"environmental_impact","_draft":false,"_partial":false,"_locale":"","title":"Learning objectives","description":"","type":"info","order":0,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"learning-objectives"},"children":[{"type":"text","value":"Learning Objectives"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this module you will learn to answer the following questions:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Why is green computing important?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What is energy and power in the context of computing?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What is an energy budget and what is it for?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How can we quantify our environmental impact?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What are typical values of energy usage?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How much CO$_2$ is produced and how does this depend on the country and time of day?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Where in my workflow is energy primarily consumed?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What are significant sources of energy usage that I might not expect?"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"learning-objectives","depth":2,"text":"Learning Objectives"}]}},"_type":"markdown","_id":"local_fs:modules:environmental_impact:info.md","_source":"local_fs","_file":"modules/environmental_impact/info.md","_stem":"modules/environmental_impact/info","_extension":"md","plainText":"---\ntitle: Learning objectives\ntype: info\norder: 0\n---\n\n## Learning Objectives\n\nIn this module you will learn to answer the following questions:\n\n* Why is green computing important?\n* What is energy and power in the context of computing?\n* What is an energy budget and what is it for?\n* How can we quantify our environmental impact?\n* What are typical values of energy usage?\n* How much CO$_2$ is produced and how does this depend on the country and time of day?\n* Where in my workflow is energy primarily consumed?\n* What are significant sources of energy usage that I might not expect?\n"},{"_path":"/modules/environmental_impact/slides_energy_budget","_dir":"environmental_impact","_draft":false,"_partial":false,"_locale":"","title":"Energy","description":"===","type":"slides","order":2,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"energy-in-computing"},"children":[{"type":"text","value":"Energy in Computing"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"we-will-try-to-answer"},"children":[{"type":"text","value":"We will try to answer"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"How much energy is a lot of energy?"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Does Information Computing Technology use a lot of energy?"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Where is the energy going?"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"how-much-energy-is-a-lot-of-energy"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"How much energy is a lot of energy?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h2","props":{"id":"typical-values-of-energy"},"children":[{"type":"text","value":"Typical values of energy"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Energy (J)"}]},{"type":"element","tag":"th","props":{"align":"right"},"children":[{"type":"text","value":"Examples"}]},{"type":"element","tag":"th","props":{"align":"right"},"children":[{"type":"text","value":"Equ. gCO$_2$"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e0"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e1"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e2"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e3 (kJ)"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e4"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e5"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e6 (MJ)"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"3.6e6 (1 kWh)"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"305"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e7"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e8"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e9 (0.27 MWh)"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"???????????????????????????????????"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Do you have a feel for how much 1 Joule actually is?\nPress down arrow to see the examples for different orders of magnitude."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"=="}]},{"type":"element","tag":"h2","props":{"id":"typical-values-of-energy-1"},"children":[{"type":"text","value":"Typical values of energy"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Energy (J)"}]},{"type":"element","tag":"th","props":{"align":"right"},"children":[{"type":"text","value":"Examples"}]},{"type":"element","tag":"th","props":{"align":"right"},"children":[{"type":"text","value":"Equ. gCO$_2$"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e0"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"Lift an apple to your mouth"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e1"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"Tennis ball kin. energy at 220 km/h"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e2"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e3 (kJ)"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"Standby LED (0.3W) for 1 hour"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e4"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"LED-based lightbulb (3W) for 1 hour"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e5"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"15 mn bike ride"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e6 (MJ)"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"~ 2km drive"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"3.6e6 (1 kWh)"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"Bring 10L of water to boil"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"305"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e7"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"Human energy need per day"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e8"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"Average daily cons. of 3 NL homes"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"1.0e9 (0.27 MWh)"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[{"type":"text","value":"Round trip flight AMS-LON for 2"}]},{"type":"element","tag":"td","props":{"align":"right"},"children":[]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"does-information-computing-technology-use-a-lot-of-energy"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Does Information Computing Technology use a lot of energy?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"ict-uses-a-lot-of-energy"},"children":[{"type":"text","value":"ICT uses a lot of energy"}]},{"type":"element","tag":"div","props":{"style":"width: 40%; float: left; margin-top: 1%"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Information Computing Technology (ICT)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Predicted major increase in electricity demand:"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"from 8% to 21% in 2030."}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Responsible for about 2% of global CO$_2$ emmisions, on par with the aviation sector."}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 60%; float: right"},"children":[{"type":"element","tag":"img","props":{"src":"/modules/environmental_impact/media/ICT_EnergyConsumption_Jones_2018.png","width":"100%",")":"","<":"","div":""},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"On the graph:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"4 components to ICT demand: network infra., consumer device (not including IoT-connected devices), data center and production from first three components (cradle-to-gate)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"this is an expected prediction, best and worst case scenario are 12% and 50%, resp."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"As researchers we use devices (laptops, workstations), local/national clusters (e.g. Snellius) and cloud services (SURF Cloud, AWS, ...).\nOur day2day work embedded in ICT."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"overall-contribution-of-ict"},"children":[{"type":"text","value":"Overall contribution of ICT"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Computing carbon footprint can be split into two main contributions:\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Embodied"}]},{"type":"text","value":": from raw material extraction, to distribution"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Usage"}]},{"type":"text","value":": Powering, memory, infrastructure"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"does-optimizing-matter"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Does optimizing matter?"}]}]},{"type":"element","tag":"div","props":{"style":"width: 40%; float: left; margin-top: 1%"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Most CO$_2$ comes from the usage of data centers not the building of them"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Reducing your energy while running software indeed matters."}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 60%; float: right"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Higher CO2 emissions from the use phase across ICT infrastructure","src":"/modules/environmental_impact/media/higher-co2-emissions-from-use-phase-across-ict-infrastructure.png"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here is something that adds to the story of “optimization of energy”: This CO$_2$ footprint of use phase vs production phase shows that most of the CO$_2$ comes from the usage of data centers not the building of them. So reducing your energy while running software indeed matters."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"data-centers"},"children":[{"type":"text","value":"Data centers"}]},{"type":"element","tag":"div","props":{"style":"width: 45%; float: right;"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Compute and/or storage"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Efficiency characterized by Power Usage Effectiveness (PUE)\n"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"$$ PUE = P_{total} / P_{IT} $$"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Quantifies overhead. Gives you e.g. how much cooling power you need per unit of compute"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Best data centers are now down to about 10% extra for cooling, but still large variability. Used to be around 100%."}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 55%; float: left; margin-top: 1%"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Data center PUE","src":"/modules/environmental_impact/media/PUE_DataCenter.svg"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"$P_$ in PUE not limited to CPU/GPU, also include network, memory storage, backups, ..."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"where-is-the-energy-going"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Where is the energy going?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"data-storage"},"children":[{"type":"text","value":"Data storage"}]},{"type":"element","tag":"div","props":{"style":"width: 55%; float: left; margin-top: 10%"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Different type of storage for different usages: latency, volume, ..."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Very different energy consumption depending on state: idle, reading, writing"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Storage efficiency (W/TB) strongly tied to technological solution"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Storage efficiency has decreased over the years"}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 45%; float: right"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Storage Tier Efficiency","src":"/modules/environmental_impact/media/DataStorageEnergy.png"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Not a widely used ranking of storage technologies, but indicative of each Tier plus/minuses"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Lower table shows efficiency projection from 2013 to 2020. Figures assume a data center equiped\nwith only a given Tier of storage"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"compute-devices-processors"},"children":[{"type":"text","value":"Compute devices: processors"}]},{"type":"element","tag":"div","props":{"style":"width: 40%; float: left; margin-top: 1%"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Compute devices are powered by electricity"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Electrons themselves are used to perform the operations encoded in your softwares"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Number of operations processors can crunch per second has continuously increased"}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 60%; float: right"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Consumer CPU performances","src":"/modules/environmental_impact/media/CPUFlops_overTime.png"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Over the past 40 years, the number of operations processors\ncan crunch per second has continuously increased"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Figure: consumer CPU performances over 40 years (relative). (Hennessy J. and Patterson D. A., Computer Architecture (5th edition))"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"supercomputers-are-also-doing-more"},"children":[{"type":"text","value":"Supercomputers are also doing more"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"TOP500 GFLOPS","src":"/modules/environmental_impact/media/top500_performance_evolution.svg"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"This trend extends to supercomputers (e.g. Snellius) and data centers. Top500 records performances\nof the world's (500) biggest computers on the same problem for over 30 years:"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Initially growth faster than Moore's law, but slowing down past 2013. Switch to GPUs around 2019\nkept the curve on track with Moore's law even though transitor/surface is increasing slower than Moore's law."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Figure: now showing GFLOPs, blue biggest supercomputer, red average of the 500."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"cpu-energy-consumption-how-does-it-relate-to-flops"},"children":[{"type":"text","value":"CPU energy consumption: how does it relate to FLOPs ?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Increase in FLOPs mostly related to:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"improved manufacturing, more transistor/surface (Moore's law)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"low level instructions handling improvements"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"increase in CPU clock rate (until mid-2000)"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-does-it-mean-for-energy"},"children":[{"type":"text","value":"What does it mean for energy ?"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"More transistors lead to more power, but smaller transistors need less voltage"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CPU have a baseline (idle) power consumption ($P_0$), due to current leakage, unless closing circuit totally"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Active power consumption of CPUs: "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"$$ \\sim P_0 + C * V(f)^2 * f \\sim f^3 $$"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"$f$: clock rate"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"$V$: voltage, higher voltage needed with higher clockrate to transfer information faster"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Energy: power * time, time needed $1/f$ (fixed number of operations) ->\n"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"$$ E \\sim f^2 $$"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This may seem like a lot of detail.\nWhat really matters here is understanding that the energy usage of the CPU is influenced by the clock rate (frequency).\nIncreases in clock rate cause a disproportionate increase in energy usage (since f is squared)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"computer-performances-flopswatt"},"children":[{"type":"text","value":"Computer performances: FLOPs/Watt"}]},{"type":"element","tag":"div","props":{"style":"width: 40%; float: right"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Raw FLOPs data are not an appropriate measure of how efficient a CPU (or GPU) is."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The 10$^8$ increase in FLOPs does not translate to needing a nuclear power plant to run Snellius."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Green500 ranks the Top500 supercomputer based on their power consumption since 2014.\nCompared to Koomey's prediction: factor 2 improvement every 1.57 years."}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 60%; float: left; margin-top: 1%"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Green500 efficiency","src":"/modules/environmental_impact/media/green500_efficiency_evolution.svg"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Figure: now showing GFLOPs/Watts, compared to Koomey's prediction (CPU then GPU after 2019)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"key-points"},"children":[{"type":"text","value":"Key points"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"ICT energy use is significant and projected to increase greatly"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Energy use has a strong dependence on clock frequency\n"},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"$$ E \\sim f^2 $$"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Most CO$_2$ production comes from the usage of data centers not the building of them"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://www.esciencecenter.nl","rel":["nofollow"]},"children":[{"type":"text","value":"www.esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"mailto:info@esciencecenter.nl"},"children":[{"type":"text","value":"info@esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"020 - 460 47 70"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"we-will-try-to-answer","depth":3,"text":"We will try to answer"},{"id":"how-much-energy-is-a-lot-of-energy","depth":3,"text":"How much energy is a lot of energy?"},{"id":"typical-values-of-energy","depth":2,"text":"Typical values of energy"},{"id":"typical-values-of-energy-1","depth":2,"text":"Typical values of energy","children":[{"id":"does-information-computing-technology-use-a-lot-of-energy","depth":3,"text":"Does Information Computing Technology use a lot of energy?"},{"id":"ict-uses-a-lot-of-energy","depth":3,"text":"ICT uses a lot of energy"},{"id":"overall-contribution-of-ict","depth":3,"text":"Overall contribution of ICT"},{"id":"does-optimizing-matter","depth":3,"text":"Does optimizing matter?"},{"id":"data-centers","depth":3,"text":"Data centers"},{"id":"where-is-the-energy-going","depth":3,"text":"Where is the energy going?"},{"id":"data-storage","depth":3,"text":"Data storage"},{"id":"compute-devices-processors","depth":3,"text":"Compute devices: processors"},{"id":"supercomputers-are-also-doing-more","depth":3,"text":"Supercomputers are also doing more"},{"id":"cpu-energy-consumption-how-does-it-relate-to-flops","depth":3,"text":"CPU energy consumption: how does it relate to FLOPs ?"},{"id":"what-does-it-mean-for-energy","depth":3,"text":"What does it mean for energy ?"},{"id":"computer-performances-flopswatt","depth":3,"text":"Computer performances: FLOPs/Watt"},{"id":"key-points","depth":3,"text":"Key points"}]}]}},"_type":"markdown","_id":"local_fs:modules:environmental_impact:slides_energy_budget.md","_source":"local_fs","_file":"modules/environmental_impact/slides_energy_budget.md","_stem":"modules/environmental_impact/slides_energy_budget","_extension":"md","plainText":"---\ntitle: Energy\ntype: slides\norder: 2\n---\n\n<!-- .slide: data-state=\"title\" -->\n\n# Energy in Computing\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n### We will try to answer\n- _How much energy is a lot of energy?_\n- _Does Information Computing Technology use a lot of energy?_\n- _Where is the energy going?_\n\n===\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _How much energy is a lot of energy?_\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n## Typical values of energy\n\n| Energy (J) | Examples | Equ. gCO$_2$ |\n| :-------- | -------: |--------:|\n| 1.0e0 | ??????????????????????????????????? | |\n| 1.0e1 | ??????????????????????????????????? | |\n| 1.0e2 | ??????????????????????????????????? | |\n| 1.0e3 (kJ) | ??????????????????????????????????? | |\n| 1.0e4 | ??????????????????????????????????? | |\n| 1.0e5 | ??????????????????????????????????? | |\n| 1.0e6 (MJ) | ??????????????????????????????????? | |\n| 3.6e6 (1 kWh)| ??????????????????????????????????? | 305 |\n| 1.0e7 | ??????????????????????????????????? | |\n| 1.0e8 | ??????????????????????????????????? | |\n| 1.0e9 (0.27 MWh) | ??????????????????????????????????? | | |\n\nNote:\n\nDo you have a feel for how much 1 Joule actually is?\nPress down arrow to see the examples for different orders of magnitude.\n\n==\n\n## Typical values of energy\n\n| Energy (J) | Examples | Equ. gCO$_2$ |\n| :-------- | -------: |--------:|\n| 1.0e0 | Lift an apple to your mouth | |\n| 1.0e1 | Tennis ball kin. energy at 220 km/h  | |\n| 1.0e2 |  | |\n| 1.0e3 (kJ) | Standby LED (0.3W) for 1 hour | |\n| 1.0e4 | LED-based lightbulb (3W) for 1 hour | |\n| 1.0e5 | 15 mn bike ride | |\n| 1.0e6 (MJ) | ~ 2km drive | |\n| 3.6e6 (1 kWh)| Bring 10L of water to boil | 305 |\n| 1.0e7 | Human energy need per day | |\n| 1.0e8 | Average daily cons. of 3 NL homes | |\n| 1.0e9 (0.27 MWh) | Round trip flight AMS-LON for 2 | |\n\n===\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _Does Information Computing Technology use a lot of energy?_\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### ICT uses a lot of energy\n\n<div style=\"width: 40%; float: left; margin-top: 1%\">\n\n* Information Computing Technology (ICT) \n* Predicted major increase in electricity demand:\n- from 8% to 21% in 2030.\n\n* Responsible for about 2% of global CO$_2$ emmisions, on par with the aviation sector.\n\n</div>\n\n<div style=\"width: 60%; float: right\">\n<img src=\"media/ICT_EnergyConsumption_Jones_2018.png\" width=\"100%\")\n</div>\n\nNote:\n\nOn the graph:\n - 4 components to ICT demand: network infra., consumer device (not including IoT-connected devices), data center and production from first three components (cradle-to-gate)\n - this is an expected prediction, best and worst case scenario are 12% and 50%, resp.\n\nAs researchers we use devices (laptops, workstations), local/national clusters (e.g. Snellius) and cloud services (SURF Cloud, AWS, ...).\nOur day2day work embedded in ICT.\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Overall contribution of ICT\n\n- Computing carbon footprint can be split into two main contributions:\n  - *Embodied*: from raw material extraction, to distribution\n  - *Usage*: Powering, memory, infrastructure\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### _Does optimizing matter?_\n\n<div style=\"width: 40%; float: left; margin-top: 1%\">\n\n* Most CO$_2$ comes from the usage of data centers not the building of them\n* Reducing your energy while running software indeed matters.\n\n</div>\n\n<div style=\"width: 60%; float: right\">\n\n![Higher CO2 emissions from the use phase across ICT infrastructure](media/higher-co2-emissions-from-use-phase-across-ict-infrastructure.png)\n\n</div>\n\n\nNote:\n\nHere is something that adds to the story of “optimization of energy”: This CO$_2$ footprint of use phase vs production phase shows that most of the CO$_2$ comes from the usage of data centers not the building of them. So reducing your energy while running software indeed matters.\n\n===\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Data centers\n\n<div style=\"width: 45%; float: right;\">\n\n* Compute and/or storage\n* Efficiency characterized by Power Usage Effectiveness (PUE)\n `$$ PUE = P_{total} / P_{IT} $$`\n* Quantifies overhead. Gives you e.g. how much cooling power you need per unit of compute\n* Best data centers are now down to about 10% extra for cooling, but still large variability. Used to be around 100%.\n\n</div>\n\n\n<div style=\"width: 55%; float: left; margin-top: 1%\">\n\n![Data center PUE](media/PUE_DataCenter.svg)\n\n</div>\n\nNote:\n - $P_{IT}$ in PUE not limited to CPU/GPU, also include network, memory storage, backups, ...\n\n===\n\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _Where is the energy going?_\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Data storage\n\n<div style=\"width: 55%; float: left; margin-top: 10%\">\n\n* Different type of storage for different usages: latency, volume, ...\n* Very different energy consumption depending on state: idle, reading, writing\n* Storage efficiency (W/TB) strongly tied to technological solution\n* Storage efficiency has decreased over the years\n\n</div>\n\n<div style=\"width: 45%; float: right\">\n\n![Storage Tier Efficiency](media/DataStorageEnergy.png)\n\n</div>\n\nNote: \n\n - Not a widely used ranking of storage technologies, but indicative of each Tier plus/minuses\n - Lower table shows efficiency projection from 2013 to 2020. Figures assume a data center equiped\nwith only a given Tier of storage\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Compute devices: processors\n\n<div style=\"width: 40%; float: left; margin-top: 1%\">\n\n* Compute devices are powered by electricity\n* Electrons themselves are used to perform the operations encoded in your softwares\n* Number of operations processors can crunch per second has continuously increased\n\n</div>\n\n<div style=\"width: 60%; float: right\">\n\n![Consumer CPU performances](media/CPUFlops_overTime.png)\n\n</div>\n\nNote:\n\n- Over the past 40 years, the number of operations processors\ncan crunch per second has continuously increased\n\n- Figure: consumer CPU performances over 40 years (relative). (Hennessy J. and Patterson D. A., Computer Architecture (5th edition)) \n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Supercomputers are also doing more\n\n![TOP500 GFLOPS](media/top500_performance_evolution.svg)\n\nNote:\n\n - This trend extends to supercomputers (e.g. Snellius) and data centers. Top500 records performances\nof the world's (500) biggest computers on the same problem for over 30 years:\n\n - Initially growth faster than Moore's law, but slowing down past 2013. Switch to GPUs around 2019\nkept the curve on track with Moore's law even though transitor/surface is increasing slower than Moore's law.\n\n - Figure: now showing GFLOPs, blue biggest supercomputer, red average of the 500.\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### CPU energy consumption: how does it relate to FLOPs ?\n\nIncrease in FLOPs mostly related to:\n - improved manufacturing, more transistor/surface (Moore's law)\n - low level instructions handling improvements\n - increase in CPU clock rate (until mid-2000)\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### What does it mean for energy ?\n - More transistors lead to more power, but smaller transistors need less voltage \n - CPU have a baseline (idle) power consumption ($P_0$), due to current leakage, unless closing circuit totally\n - Active power consumption of CPUs: `$$ \\sim P_0 + C * V(f)^2 * f \\sim f^3 $$`\n    - $f$: clock rate\n    - $V$: voltage, higher voltage needed with higher clockrate to transfer information faster\n - Energy: power * time, time needed $1/f$ (fixed number of operations) ->\n    `$$ E \\sim f^2 $$`\n    \nNote:\n\nThis may seem like a lot of detail.\nWhat really matters here is understanding that the energy usage of the CPU is influenced by the clock rate (frequency).\nIncreases in clock rate cause a disproportionate increase in energy usage (since f is squared)\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Computer performances: FLOPs/Watt\n\n<div style=\"width: 40%; float: right\">\n\n* Raw FLOPs data are not an appropriate measure of how efficient a CPU (or GPU) is.\n* The 10$^8$ increase in FLOPs does not translate to needing a nuclear power plant to run Snellius.\n* Green500 ranks the Top500 supercomputer based on their power consumption since 2014.\nCompared to Koomey's prediction: factor 2 improvement every 1.57 years.\n\n</div>\n\n\n<div style=\"width: 60%; float: left; margin-top: 1%\">\n\n![Green500 efficiency](media/green500_efficiency_evolution.svg)\n\n</div>\n\nNote:\n\nFigure: now showing GFLOPs/Watts, compared to Koomey's prediction (CPU then GPU after 2019).\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Key points\n\n- ICT energy use is significant and projected to increase greatly\n- Energy use has a strong dependence on clock frequency\n`$$ E \\sim f^2 $$`\n- Most CO$_2$ production comes from the usage of data centers not the building of them\n\n===\n\n<!-- .slide: data-state=\"keepintouch\" -->\n\nwww.esciencecenter.nl\n\ninfo@esciencecenter.nl\n\n020 - 460 47 70\n"},{"_path":"/modules/environmental_impact/slides_energy_budget_part_2","_dir":"environmental_impact","_draft":false,"_partial":false,"_locale":"","title":"Carbon","description":"===","type":"slides","order":3,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"carbon-in-computing"},"children":[{"type":"text","value":"Carbon in Computing"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"we-will-try-to-answer"},"children":[{"type":"text","value":"We will try to answer"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"What does this mean for carbon production?"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"What can we do about it?"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Will these things help?"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-does-this-mean-for-carbon-production"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"What does this mean for carbon production?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h2","props":{"id":"energy-carbon-intensity"},"children":[{"type":"text","value":"Energy Carbon intensity"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Carbon intensity has a large spatial and temporal variability."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Extreme differences between countries"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Countries with very low carbon intensity (e.g. Norway): 20g per kWh"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Countries with high carbon intensity (e.g. Australia): 700g per kWh"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"You can make a big difference by running the exact same thing on the same hardware, but in a different country"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"So far, we've talked about energy -> a proxy for CO$_2$ emission, using the energy carbon intensity"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can get an idea for real time carbon intensity in Europe here:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://app.electricitymaps.com/map","rel":["nofollow"]},"children":[{"type":"text","value":"https://app.electricitymaps.com/map"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h1","props":{"id":"typical-footprint"},"children":[{"type":"text","value":"Typical footprint"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Carbon footprint of data centres anually is around 100 MT of CO$_2$ equivalent\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"That is the same as the entire US aviation in the same time."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Not all these data centres are doing HPC"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"About 500 Tonnes of CO$_2$ estimated for training GPT3\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"IPC says we should aim for 2 tonnes of CO$_2$ per person per year to keep global warming in check."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Not every model has such huge impacts, but we need to be mindful"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h1","props":{"id":"dutch-specific-energy-mix"},"children":[{"type":"text","value":"Dutch specific energy mix"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.nowtricity.com/country/netherlands","rel":["nofollow"]},"children":[{"type":"text","value":"Nowtricity"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-can-we-do-about-it"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"What can we do about it?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are many tools and initiatives aimed at dealing with these issues"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"estimating-impact"},"children":[{"type":"text","value":"Estimating impact"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"A researcher at Cambridge, Loïc Lannelongue, started a project called Green Algorithms:\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Made a calculator to estimate energy cost and carbon footprint of your algorithm"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Necessary for assessing how to make computing more environmentally sustainable"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h2","props":{"id":"the-online-calculator"},"children":[{"type":"text","value":"The online calculator"}]},{"type":"element","tag":"div","props":{"style":"width: 60%; float: left; margin-top: 1%"},"children":[{"type":"element","tag":"img","props":{"src":"/modules/environmental_impact/media/green-algorithms-calculator-example.png"},"children":[]}]},{"type":"element","tag":"div","props":{"style":"width: 40%; float: right; margin-top: 1%"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The Green Algorithms online calculator makes it quick and easy to estimate the carbon footprint"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Can be found here: "},{"type":"element","tag":"a","props":{"href":"https://calculator.green-algorithms.org/","rel":["nofollow"]},"children":[{"type":"text","value":"https://calculator.green-algorithms.org/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"There is also a Green Algorithms tool for HPC"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"green-algorithms-4-hpc"},"children":[{"type":"text","value":"Green Algorithms 4 HPC"}]},{"type":"element","tag":"center","props":{},"children":[{"type":"element","tag":"img","props":{"src":"media/GA4HPC.png","width":"60%"},"children":[]},{"type":"element","tag":"small","props":{},"children":[{"type":"text","value":" "},{"type":"element","tag":"https:","props":{"github.com":"","greenalgorithms":"","greenalgorithms4hpc":""},"children":[{"type":"text","value":" "}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Green Algorithms one online calculator isn’t very practical in an HPC setting, where very many jobs are run. This tool uses the logged info about the jobs which ran on the system and estimates corresponding energy usage and carbon footprint."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Very early days, but very lightweight. Currently works with systems using SLURM but in principle is adaptable to other schedulers/workflow systems."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"See "},{"type":"element","tag":"a","props":{"href":"https://www.green-algorithms.org/GA4HPC/","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.green-algorithms.org/GA4HPC/"}]},{"type":"text","value":" for more."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"the-green-disc"},"children":[{"type":"text","value":"The Green DiSC"}]},{"type":"element","tag":"center","props":{},"children":[{"type":"element","tag":"img","props":{"src":"media/greendisc.png","width":"40%"},"children":[]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Also managed by Loïc Lannelongue (Green Algorithms)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Three levels of certification: Bronze, Silver and Gold"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Focusses on computing (other schemes cover heating, travel etc.)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Computing includes:\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"HPC infrastructure"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Data storage and hardware policy"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Eventually sustainability as part of teaching"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Managed by the same person as worked on the Green Algorithms calculator."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Read in more detail here: "},{"type":"element","tag":"a","props":{"href":"https://www.software.ac.uk/GreenDiSC","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.software.ac.uk/GreenDiSC"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"will-these-things-help"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Will these things help?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Some practical considerations to discuss"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h2","props":{"id":"yet-more-paperwork"},"children":[{"type":"text","value":"Yet more paperwork?"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Is this just more work for researchers when filling out grant applications?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"All applications must estimate the environmental impact of their models."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"They did this in France and researchers still applied. The Green Algorithms Calculator was required to be used for the applications. Researchers accepted it was a fair request and still continued applying."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"If a project is cheap financially, but has a large carbon cost, there should be an explicit justification why"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-is-too-much-energy-anyway"},"children":[{"type":"text","value":"What is too much energy anyway?"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Do the potential benefits outweigh the environmental costs?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"We should think of energy (or CO$_2$) the same way we think of money"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What matters is the "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"cost-benefit"}]},{"type":"text","value":" ratio"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Is €1M a lot? Not if it leads to curing a major disease"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Currently researchers are used to making the scientific case for the money they request"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"They should also be able to make the case for the corresponding carbon footprint"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The energy and carbon cost can often be hidden or abstracted from the researcher's perspective"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"key-points"},"children":[{"type":"text","value":"Key points"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Carbon intensity has a large spatial and temporal variability\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Carbon footprint of data centres anually is roughly the same as the entire US aviation in the same time"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Several tools and initiatives exist to help with this\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Online calculators, carbon estimation tools, certification schemes"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Cost-benefit analysis is as important as the raw carbon cost"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://www.esciencecenter.nl","rel":["nofollow"]},"children":[{"type":"text","value":"www.esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"mailto:info@esciencecenter.nl"},"children":[{"type":"text","value":"info@esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"020 - 460 47 70"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"we-will-try-to-answer","depth":3,"text":"We will try to answer"},{"id":"what-does-this-mean-for-carbon-production","depth":3,"text":"What does this mean for carbon production?"},{"id":"energy-carbon-intensity","depth":2,"text":"Energy Carbon intensity","children":[{"id":"what-can-we-do-about-it","depth":3,"text":"What can we do about it?"},{"id":"estimating-impact","depth":3,"text":"Estimating impact"}]},{"id":"the-online-calculator","depth":2,"text":"The online calculator","children":[{"id":"green-algorithms-4-hpc","depth":3,"text":"Green Algorithms 4 HPC"},{"id":"the-green-disc","depth":3,"text":"The Green DiSC"},{"id":"will-these-things-help","depth":3,"text":"Will these things help?"}]},{"id":"yet-more-paperwork","depth":2,"text":"Yet more paperwork?","children":[{"id":"what-is-too-much-energy-anyway","depth":3,"text":"What is too much energy anyway?"},{"id":"key-points","depth":3,"text":"Key points"}]}]}},"_type":"markdown","_id":"local_fs:modules:environmental_impact:slides_energy_budget_part_2.md","_source":"local_fs","_file":"modules/environmental_impact/slides_energy_budget_part_2.md","_stem":"modules/environmental_impact/slides_energy_budget_part_2","_extension":"md","plainText":"---\ntitle: Carbon\ntype: slides\norder: 3\n---\n\n<!-- .slide: data-state=\"title\" -->\n\n# Carbon in Computing\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n### We will try to answer\n- _What does this mean for carbon production?_\n- _What can we do about it?_\n- _Will these things help?_\n\n===\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _What does this mean for carbon production?_\n\n===\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n## Energy Carbon intensity\n- Carbon intensity has a large spatial and temporal variability.\n- Extreme differences between countries\n- Countries with very low carbon intensity (e.g. Norway): 20g per kWh\n- Countries with high carbon intensity (e.g. Australia): 700g per kWh\n- You can make a big difference by running the exact same thing on the same hardware, but in a different country\n\nNote:\n\nSo far, we've talked about energy -> a proxy for CO$_2$ emission, using the energy carbon intensity\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\nYou can get an idea for real time carbon intensity in Europe here:\n\n\n[https://app.electricitymaps.com/map](https://app.electricitymaps.com/map)\n\n===\n\n<!-- .slide: data-state=\"empty-slide\" data-background-iframe=\"https://app.electricitymaps.com/map\" -->\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n# Typical footprint\n- Carbon footprint of data centres anually is around 100 MT of CO$_2$ equivalent\n  - That is the same as the entire US aviation in the same time.\n  - Not all these data centres are doing HPC\n- About 500 Tonnes of CO$_2$ estimated for training GPT3\n  - IPC says we should aim for 2 tonnes of CO$_2$ per person per year to keep global warming in check. \n  - Not every model has such huge impacts, but we need to be mindful\n\nNote:\n\n\n===\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n# Dutch specific energy mix\n\n[Nowtricity](https://www.nowtricity.com/country/netherlands)\n\n===\n\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _What can we do about it?_\n\nNote:\n\nThere are many tools and initiatives aimed at dealing with these issues\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Estimating impact\n- A researcher at Cambridge, Loïc Lannelongue, started a project called Green Algorithms: \n  - Made a calculator to estimate energy cost and carbon footprint of your algorithm\n  - Necessary for assessing how to make computing more environmentally sustainable\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n## The online calculator\n\n<div style=\"width: 60%; float: left; margin-top: 1%\">\n\n<img src=\"media/green-algorithms-calculator-example.png\" />\n\n</div>\n\n\n<div style=\"width: 40%; float: right; margin-top: 1%\">\n\n- The Green Algorithms online calculator makes it quick and easy to estimate the carbon footprint\n- Can be found here: <https://calculator.green-algorithms.org/>\n- There is also a Green Algorithms tool for HPC\n\n</div>\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"empty-slide\" data-background-iframe=\"https://calculator.green-algorithms.org/\" -->\n\n===\n\n### Green Algorithms 4 HPC\n\n<center>\n<img src=\"media/GA4HPC.png\" width=\"60%\" />\n<small> <https://github.com/GreenAlgorithms/GreenAlgorithms4HPC> </small>\n</center>\n\nNote:\n\nGreen Algorithms one online calculator isn’t very practical in an HPC setting, where very many jobs are run. This tool uses the logged info about the jobs which ran on the system and estimates corresponding energy usage and carbon footprint.\n\nVery early days, but very lightweight. Currently works with systems using SLURM but in principle is adaptable to other schedulers/workflow systems.\n\nSee <https://www.green-algorithms.org/GA4HPC/> for more.\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### The Green DiSC\n\n<center>\n\n<img src=\"media/greendisc.png\" width=40% />\n\n</center>\n\n* Also managed by Loïc Lannelongue (Green Algorithms)\n* Three levels of certification: Bronze, Silver and Gold \n* Focusses on computing (other schemes cover heating, travel etc.)\n* Computing includes:\n  * HPC infrastructure\n  * Data storage and hardware policy\n  * Eventually sustainability as part of teaching\n\nNote:\n\nManaged by the same person as worked on the Green Algorithms calculator.\n\nRead in more detail here: <https://www.software.ac.uk/GreenDiSC>\n\n===\n\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _Will these things help?_\n\nNote:\n\nSome practical considerations to discuss\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n## Yet more paperwork?\n\n- Is this just more work for researchers when filling out grant applications?\n- All applications must estimate the environmental impact of their models.\n- They did this in France and researchers still applied. The Green Algorithms Calculator was required to be used for the applications. Researchers accepted it was a fair request and still continued applying.\n- If a project is cheap financially, but has a large carbon cost, there should be an explicit justification why\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### What is too much energy anyway?\n- Do the potential benefits outweigh the environmental costs?\n- **We should think of energy (or CO$_2$) the same way we think of money**\n  - What matters is the _cost-benefit_ ratio\n  - Is €1M a lot? Not if it leads to curing a major disease\n- Currently researchers are used to making the scientific case for the money they request\n- They should also be able to make the case for the corresponding carbon footprint\n- The energy and carbon cost can often be hidden or abstracted from the researcher's perspective\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Key points\n\n- Carbon intensity has a large spatial and temporal variability\n  - Carbon footprint of data centres anually is roughly the same as the entire US aviation in the same time\n- Several tools and initiatives exist to help with this\n  - Online calculators, carbon estimation tools, certification schemes\n- Cost-benefit analysis is as important as the raw carbon cost\n\n===\n\n<!-- .slide: data-state=\"keepintouch\" -->\n\nwww.esciencecenter.nl\n\ninfo@esciencecenter.nl\n\n020 - 460 47 70\n"},{"_path":"/modules/environmental_impact/useful_links","_dir":"environmental_impact","_draft":false,"_partial":false,"_locale":"","title":"Useful links","description":"","type":"reading","order":5,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"reading-material"},"children":[{"type":"text","value":"Reading material"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.green-algorithms.org/","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.green-algorithms.org/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.green-algorithms.org/GA4HPC/","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.green-algorithms.org/GA4HPC/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://en.wikichip.org/w/images/8/83/Intel_Architecture%2C_Code_Name_Skylake_Deep_Dive-_A_New_Architecture_to_Manage_Power_Performance_and_Energy_Efficiency.pdf","rel":["nofollow"]},"children":[{"type":"text","value":"https://en.wikichip.org/w/images/8/83/Intel_Architecture%2C_Code_Name_Skylake_Deep_Dive-_A_New_Architecture_to_Manage_Power_Performance_and_Energy_Efficiency.pdf"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.sciencedirect.com/science/article/pii/S1364032123002794?ssrnid=4258869&dgcid=SSRN_redirect_SD","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.sciencedirect.com/science/article/pii/S1364032123002794?ssrnid=4258869&dgcid=SSRN_redirect_SD"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://greenict.fi/en/greenict_producerguide/","rel":["nofollow"]},"children":[{"type":"text","value":"https://greenict.fi/en/greenict_producerguide/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.mdpi.com/2078-1547/6/1/117","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.mdpi.com/2078-1547/6/1/117"}]}]}]},{"type":"element","tag":"h2","props":{"id":"listening-material"},"children":[{"type":"text","value":"Listening material"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://codeforthought.buzzsprout.com/1326658/14838208-en-make-computing-greener-loic-lannelongue","rel":["nofollow"]},"children":[{"type":"text","value":"https://codeforthought.buzzsprout.com/1326658/14838208-en-make-computing-greener-loic-lannelongue"}]}]}]},{"type":"element","tag":"h2","props":{"id":"useful-links"},"children":[{"type":"text","value":"Useful links"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.nowtricity.com/country/netherlands/","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.nowtricity.com/country/netherlands/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.datacentermap.com/the-netherlands/","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.datacentermap.com/the-netherlands/"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://app.electricitymaps.com/map","rel":["nofollow"]},"children":[{"type":"text","value":"https://app.electricitymaps.com/map"}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"reading-material","depth":2,"text":"Reading material"},{"id":"listening-material","depth":2,"text":"Listening material"},{"id":"useful-links","depth":2,"text":"Useful links"}]}},"_type":"markdown","_id":"local_fs:modules:environmental_impact:useful_links.md","_source":"local_fs","_file":"modules/environmental_impact/useful_links.md","_stem":"modules/environmental_impact/useful_links","_extension":"md","plainText":"---\ntitle: Useful links\ntype: reading\norder: 5\n---\n\n## Reading material\n* <https://www.green-algorithms.org/>\n* <https://www.green-algorithms.org/GA4HPC/>\n* <https://en.wikichip.org/w/images/8/83/Intel_Architecture%2C_Code_Name_Skylake_Deep_Dive-_A_New_Architecture_to_Manage_Power_Performance_and_Energy_Efficiency.pdf>\n* <https://www.sciencedirect.com/science/article/pii/S1364032123002794?ssrnid=4258869&dgcid=SSRN_redirect_SD>\n* <https://greenict.fi/en/greenict_producerguide/>\n* <https://www.mdpi.com/2078-1547/6/1/117>\n\n## Listening material\n* <https://codeforthought.buzzsprout.com/1326658/14838208-en-make-computing-greener-loic-lannelongue>\n\n## Useful links\n* <https://www.nowtricity.com/country/netherlands/>\n* <https://www.datacentermap.com/the-netherlands/>\n* <https://app.electricitymaps.com/map>\n"},{"_path":"/modules/hpc-handson/earl","_dir":"hpc-handson","_draft":false,"_partial":false,"_locale":"","title":"EARL","description":"The EAR Library is automatically loaded with MPI applications when EAR is enabled. EAR supports the utilization of both mpirun/mpiexec and srun commands.\nTo enable EAR in your job script when launching an MPI application you will need to include the following SBATCH options in your job script.","type":"reading","order":4,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"earl"},"children":[{"type":"text","value":"EARL"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The EAR Library is automatically loaded with MPI applications when EAR is enabled. EAR supports the utilization of both mpirun/mpiexec and srun commands.\nTo enable EAR in your job script when launching an MPI application you will need to include the following SBATCH options in your job script."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"srun"}]},{"type":"text","value":" is the preferred job launcher when using EAR, as the EARL is a SLURM plugin! You will collect the largest amount of energy metrics when using srun\nRunning MPI applications with EARL is automatic for SLURM systems when using srun. All the jobs are monitored by EAR and the Library is loaded by default when EAR is enabled in the job script. To run a job with srun and EARL there is no need to load the EAR module. When using slurm commands for job submission, both Intel and OpenMPI implementations are supported. When using sbatch/srun or salloc to submit a job, Intel MPI and OpenMPI are supported."}]},{"type":"element","tag":"h3","props":{"id":"example-usage-in-a-batch-script"},"children":[{"type":"text","value":"Example usage in a batch script"}]},{"type":"element","tag":"pre","props":{"code":"#SBATCH --ear=on\n#SBATCH --ear-policy=monitoring\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"#SBATCH --ear=on\n#SBATCH --ear-policy=monitoring\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Example:"}]},{"type":"element","tag":"pre","props":{"code":"#!/bin/bash\n \n#SBATCH -p rome\n#SBATCH -t 00:30:00\n#SBATCH --ntasks=128\n \n#SBATCH --ear=on\n#SBATCH --ear-policy=monitoring\n#SBATCH --ear-verbose=1\n \nsrun myapplication\n","language":"bash","meta":"","className":["language-bash"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"#!/bin/bash\n \n#SBATCH -p rome\n#SBATCH -t 00:30:00\n#SBATCH --ntasks=128\n \n#SBATCH --ear=on\n#SBATCH --ear-policy=monitoring\n#SBATCH --ear-verbose=1\n \nsrun myapplication\n"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"example-usage-in-a-batch-script","depth":3,"text":"Example usage in a batch script"}]}},"_type":"markdown","_id":"local_fs:modules:hpc-handson:EARL.md","_source":"local_fs","_file":"modules/hpc-handson/EARL.md","_stem":"modules/hpc-handson/EARL","_extension":"md","plainText":"---\ntitle: EARL\ntype: reading\norder: 4\n---\n\n# EARL\n\nThe EAR Library is automatically loaded with MPI applications when EAR is enabled. EAR supports the utilization of both mpirun/mpiexec and srun commands.\nTo enable EAR in your job script when launching an MPI application you will need to include the following SBATCH options in your job script.\n\n`srun` is the preferred job launcher when using EAR, as the EARL is a SLURM plugin! You will collect the largest amount of energy metrics when using srun\nRunning MPI applications with EARL is automatic for SLURM systems when using srun. All the jobs are monitored by EAR and the Library is loaded by default when EAR is enabled in the job script. To run a job with srun and EARL there is no need to load the EAR module. When using slurm commands for job submission, both Intel and OpenMPI implementations are supported. When using sbatch/srun or salloc to submit a job, Intel MPI and OpenMPI are supported.\n\n\n### Example usage in a batch script\n\n```\n#SBATCH --ear=on\n#SBATCH --ear-policy=monitoring\n```\n\nExample:\n```bash\n#!/bin/bash\n \n#SBATCH -p rome\n#SBATCH -t 00:30:00\n#SBATCH --ntasks=128\n \n#SBATCH --ear=on\n#SBATCH --ear-policy=monitoring\n#SBATCH --ear-verbose=1\n \nsrun myapplication\n```\n"},{"_path":"/modules/hpc-handson/exercises","_dir":"hpc-handson","_draft":false,"_partial":false,"_locale":"","title":"Exercises","description":"Choose an application from the list below","type":"exercise","order":6,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"exercises"},"children":[{"type":"text","value":"Exercises"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Choose an application from the list "},{"type":"element","tag":"a","props":{"href":"#applications"},"children":[{"type":"text","value":"below"}]}]},{"type":"element","tag":"h3","props":{"id":"_1-monitor-an-application-with-ear"},"children":[{"type":"text","value":"1. Monitor an application with EAR"}]},{"type":"element","tag":"h3","props":{"id":"_2-identify-whether-the-applicaiton-is-cpu-intensive-or-memorycommunication-intensive"},"children":[{"type":"text","value":"2. Identify whether the applicaiton is CPU intensive or Memory/Communication intensive"}]},{"type":"element","tag":"h3","props":{"id":"_3-play-with-pytorch-automatic-mixed-precision-and-maybe-model-size-what-impacts-on-energy-does-this-have"},"children":[{"type":"text","value":"3. Play with PyTorch Automatic Mixed Precision, and maybe model \"size\". What impacts on Energy does this have?"}]},{"type":"element","tag":"h2","props":{"id":"applications"},"children":[{"type":"text","value":"Applications"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"All of the Applications used in this tutorial can be found in the project space "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/projects/0/energy-course/"}]}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#synthetic-applications"},"children":[{"type":"text","value":"Synthetic Applications"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#scientific-applications"},"children":[{"type":"text","value":"Scientific Applications"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#hemepure"},"children":[{"type":"text","value":"HemePure"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#palabos"},"children":[{"type":"text","value":"Palabos"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#gromacs"},"children":[{"type":"text","value":"GROMACS"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"#pytorch"},"children":[{"type":"text","value":"PyTorch"}]}]}]}]}]},{"type":"element","tag":"h2","props":{"id":"synthetic-applications"},"children":[{"type":"text","value":"Synthetic Applications"}]},{"type":"element","tag":"h3","props":{"id":"nas-parallel-benchmarks-npb34-mz-mpiopenmp-sp-mz-benchmark"},"children":[{"type":"text","value":"NAS Parallel Benchmarks (NPB3.4-MZ MPI+OpenMP) - SP-MZ Benchmark"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The NAS Parallel Benchmarks (NPB) are a small set of programs designed to help evaluate the performance of parallel supercomputers. The benchmarks are derived from computational fluid dynamics (CFD) applications "},{"type":"element","tag":"a","props":{"href":"https://www.nas.nasa.gov/software/npb.html","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.nas.nasa.gov/software/npb.html"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this course we will use the \"Multi-zone versions of NPB\" (NPB-MZ). These are designed to exploit multiple levels of parallelism in applications and to test the effectiveness of multi-level and hybrid parallelization (MPI-OpenMP) paradigms and tools. Specifically we use the SP-MZ (even-size zones within a problem class, increased number of zones as problem class grows)."}]},{"type":"element","tag":"h5","props":{"id":"problem-sizes"},"children":[{"type":"text","value":"Problem Sizes:"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Class"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Mesh size (x)"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Mesh size (y)"}]},{"type":"element","tag":"th","props":{},"children":[{"type":"text","value":"Mesh size (z)"}]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"C"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"240"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"320"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"28"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"D"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"1632"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"1216"}]},{"type":"element","tag":"td","props":{},"children":[{"type":"text","value":"34"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Example jobscript\n"},{"type":"element","tag":"a","props":{"href":"/modules/hpc-handson/scripts/NPB_job.sh","target":"_blank"},"children":[{"type":"text","value":"NPB_job.sh"}]}]},{"type":"element","tag":"h2","props":{"id":"scientific-applications"},"children":[{"type":"text","value":"Scientific Applications"}]},{"type":"element","tag":"h3","props":{"id":"hemepure"},"children":[{"type":"text","value":"HemePure"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"HemePure/HemeLB developed by the team of Prof Peter Coveney at University College London (UCL), is a software pipeline that simulates blood flow. HemePure is specifically designed to efficiently handle sparse topologies, supports real-time visualization and remote steering of the simulation and can handle fully resolved realistic vessels like those found in the human brain. "},{"type":"element","tag":"a","props":{"href":"https://github.com/UCL-CCS/HemePure","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/UCL-CCS/HemePure"}]},{"type":"element","tag":"br","props":{},"children":[]},{"type":"element","tag":"a","props":{"href":"https://github.com/UCL-CCS/HemePure-GPU","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/UCL-CCS/HemePure-GPU"}]}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The executables are located in the directory "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"/projects/0/energy-course/HemePure"}]},{"type":"text","value":". There you will find the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"hemepure"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"hemepure_gpu"}]},{"type":"text","value":" (CUDA enabled) exectubles.\n"},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"How to run a case"}]},{"type":"text","value":"\nWe will be running through an example of pressure driven flow through a bifurcation available in the HemeLB download."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"CPU example jobscript\n"},{"type":"element","tag":"a","props":{"href":"/modules/hpc-handson/scripts/HemePure_CPU_job.sh","target":"_blank"},"children":[{"type":"text","value":"hemepure_cpu_job.sh"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"GPU example jobscript\n"},{"type":"element","tag":"a","props":{"href":"/modules/hpc-handson/scripts/HemePure_GPU_job.sh","target":"_blank"},"children":[{"type":"text","value":"hemepure_gpu_job.sh"}]}]},{"type":"element","tag":"h3","props":{"id":"palabos"},"children":[{"type":"text","value":"Palabos"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Palabos (Parallel Lattice Boltzmann Solver) library is a framework for general-purpose computational fluid dynamics (CFD), with a kernel based on the lattice Boltzmann method. The case we use in this course is a simulation of blood flow in a inside the 3D aneurysm geometry. "},{"type":"element","tag":"a","props":{"href":"https://palabos.unige.ch/","rel":["nofollow"]},"children":[{"type":"text","value":"https://palabos.unige.ch/"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"example jobscript\n"},{"type":"element","tag":"a","props":{"href":"/modules/hpc-handson/scripts/Palabos_job.sh","target":"_blank"},"children":[{"type":"text","value":"palabos_job.sh"}]}]},{"type":"element","tag":"h3","props":{"id":"gromacs"},"children":[{"type":"text","value":"GROMACS"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"GROMACS"}]},{"type":"text","value":" A free and open-source software suite for high-performance molecular dynamics and output analysis."}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"The HECBioSim Benchmarks:"}]},{"type":"text","value":" ("},{"type":"element","tag":"a","props":{"href":"https://www.hecbiosim.ac.uk/access-hpc/benchmarks","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.hecbiosim.ac.uk/access-hpc/benchmarks"}]},{"type":"text","value":")"}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"HECBioSim benchmark suite"}]},{"type":"text","value":" consists of a set of simple benchmarks for a number of popular Molecular Dynamics (MD) engines, each of which is set at a different atom count. The benchmark suite currently contains benchmarks for the AMBER, GROMACS, LAMMPS and NAMD molecular dynamics packages."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this example we will choose the \"465K atom system - hEGFR Dimer of 1IVO and 1NQL\" simulation (which can be found here "},{"type":"element","tag":"a","props":{"href":"https://github.com/victorusu/GROMACS_Benchmark_Suite/tree/1.0.0/HECBioSim/hEGFRDimer","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/victorusu/GROMACS_Benchmark_Suite/tree/1.0.0/HECBioSim/hEGFRDimer"}]},{"type":"text","value":"). This simulation contains a total number of atoms = 465,399 (Protein atoms = 21,749  Lipid atoms = 134,268  Water atoms = 309,087  Ions = 295). The run will take about 10 minutes to execute (using all 128 cores of an AMD ROME node). The image below shows the simulation that we will run."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"20K atom system"}]}]}]},{"type":"element","tag":"pre","props":{"code":"curl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/Crambin/benchmark.tpr -o Crambin_benchmark.tpr\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/Crambin/benchmark.tpr -o Crambin_benchmark.tpr\n"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"1.4M atom system"}]}]}]},{"type":"element","tag":"pre","props":{"code":"curl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/hEGFRDimerPair/benchmark.tpr -o hEGFRDimerPair_benchmark.tpr\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/hEGFRDimerPair/benchmark.tpr -o hEGFRDimerPair_benchmark.tpr\n"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"3M atom system"}]}]}]},{"type":"element","tag":"pre","props":{"code":"curl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/hEGFRDimerSmallerPL/benchmark.tpr -o hEGFRDimerSmallerPL_benchmark.tpr\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"curl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/hEGFRDimerSmallerPL/benchmark.tpr -o hEGFRDimerSmallerPL_benchmark.tpr\n"}]}]},{"type":"element","tag":"h3","props":{"id":"pytorch"},"children":[{"type":"text","value":"PyTorch"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The ResNet model is based on the Deep Residual Learning for Image Recognition from this paper "},{"type":"element","tag":"a","props":{"href":"https://arxiv.org/abs/1512.03385","rel":["nofollow"]},"children":[{"type":"text","value":"https://arxiv.org/abs/1512.03385"}]},{"type":"element","tag":"a","props":{"href":"https://pytorch.org/hub/pytorch_vision_resnet/","rel":["nofollow"]},"children":[{"type":"text","value":"https://pytorch.org/hub/pytorch_vision_resnet/"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"torchvision should be installed in your environment first"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Example how to install 2023"}]},{"type":"element","tag":"pre","props":{"code":"module load 2023\nmodule load PyTorch/2.1.2-foss-2023a-CUDA-12.1.1\nmodule load torchvision/0.16.0-foss-2023a-CUDA-12.1.1\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"module load 2023\nmodule load PyTorch/2.1.2-foss-2023a-CUDA-12.1.1\nmodule load torchvision/0.16.0-foss-2023a-CUDA-12.1.1\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Example jobscript\n"},{"type":"element","tag":"a","props":{"href":"/modules/hpc-handson/scripts/PyTorch_job.sh","target":"_blank"},"children":[{"type":"text","value":"PyTorch_job.sh"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"_1-monitor-an-application-with-ear","depth":3,"text":"1. Monitor an application with EAR"},{"id":"_2-identify-whether-the-applicaiton-is-cpu-intensive-or-memorycommunication-intensive","depth":3,"text":"2. Identify whether the applicaiton is CPU intensive or Memory/Communication intensive"},{"id":"_3-play-with-pytorch-automatic-mixed-precision-and-maybe-model-size-what-impacts-on-energy-does-this-have","depth":3,"text":"3. Play with PyTorch Automatic Mixed Precision, and maybe model \"size\". What impacts on Energy does this have?"},{"id":"applications","depth":2,"text":"Applications"},{"id":"synthetic-applications","depth":2,"text":"Synthetic Applications","children":[{"id":"nas-parallel-benchmarks-npb34-mz-mpiopenmp-sp-mz-benchmark","depth":3,"text":"NAS Parallel Benchmarks (NPB3.4-MZ MPI+OpenMP) - SP-MZ Benchmark"}]},{"id":"scientific-applications","depth":2,"text":"Scientific Applications","children":[{"id":"hemepure","depth":3,"text":"HemePure"},{"id":"palabos","depth":3,"text":"Palabos"},{"id":"gromacs","depth":3,"text":"GROMACS"},{"id":"pytorch","depth":3,"text":"PyTorch"}]}]}},"_type":"markdown","_id":"local_fs:modules:hpc-handson:exercises.md","_source":"local_fs","_file":"modules/hpc-handson/exercises.md","_stem":"modules/hpc-handson/exercises","_extension":"md","plainText":"---\ntitle: Exercises\ntype: exercise\norder: 6\n---\n\n# Exercises\nChoose an application from the list [below](#applications)\n### 1. Monitor an application with EAR\n### 2. Identify whether the applicaiton is CPU intensive or Memory/Communication intensive\n### 3. Play with PyTorch Automatic Mixed Precision, and maybe model \"size\". What impacts on Energy does this have?\n\n\n## Applications\n\nAll of the Applications used in this tutorial can be found in the project space `/projects/0/energy-course/`\n\n1. [Synthetic Applications](#synthetic-applications)\n2. [Scientific Applications](#scientific-applications)\n   - [HemePure](#hemepure)\n   - [Palabos](#palabos)\n   - [GROMACS](#gromacs)\n   - [PyTorch](#pytorch)\n\n\n## Synthetic Applications\n### NAS Parallel Benchmarks (NPB3.4-MZ MPI+OpenMP) - SP-MZ Benchmark\n> The NAS Parallel Benchmarks (NPB) are a small set of programs designed to help evaluate the performance of parallel supercomputers. The benchmarks are derived from computational fluid dynamics (CFD) applications https://www.nas.nasa.gov/software/npb.html\n\n\nIn this course we will use the \"Multi-zone versions of NPB\" (NPB-MZ). These are designed to exploit multiple levels of parallelism in applications and to test the effectiveness of multi-level and hybrid parallelization (MPI-OpenMP) paradigms and tools. Specifically we use the SP-MZ (even-size zones within a problem class, increased number of zones as problem class grows).\n\n##### Problem Sizes:\n\n| Class     | Mesh size (x)  | Mesh size (y)  | Mesh size (z)  |\n| ----------- | ----------- | ----------- | ----------- |\n| C | 240 | 320 | 28 |\n| D | 1632  | 1216 | 34 |\n\nExample jobscript\n[NPB_job.sh](scripts/NPB_job.sh)\n\n\n\n## Scientific Applications\n### HemePure\n> HemePure/HemeLB developed by the team of Prof Peter Coveney at University College London (UCL), is a software pipeline that simulates blood flow. HemePure is specifically designed to efficiently handle sparse topologies, supports real-time visualization and remote steering of the simulation and can handle fully resolved realistic vessels like those found in the human brain. https://github.com/UCL-CCS/HemePure        \nhttps://github.com/UCL-CCS/HemePure-GPU\n\n* The executables are located in the directory `/projects/0/energy-course/HemePure`. There you will find the `hemepure` and `hemepure_gpu` (CUDA enabled) exectubles.\n**How to run a case**\nWe will be running through an example of pressure driven flow through a bifurcation available in the HemeLB download.\n\nCPU example jobscript\n[hemepure_cpu_job.sh](scripts/HemePure_CPU_job.sh)\n\nGPU example jobscript\n[hemepure_gpu_job.sh](scripts/HemePure_GPU_job.sh)\n\n### Palabos\n\n> The Palabos (Parallel Lattice Boltzmann Solver) library is a framework for general-purpose computational fluid dynamics (CFD), with a kernel based on the lattice Boltzmann method. The case we use in this course is a simulation of blood flow in a inside the 3D aneurysm geometry. https://palabos.unige.ch/\n\nexample jobscript\n[palabos_job.sh](scripts/Palabos_job.sh)\n\n\n### GROMACS\n> **GROMACS** A free and open-source software suite for high-performance molecular dynamics and output analysis.\n\n> **The HECBioSim Benchmarks:** (https://www.hecbiosim.ac.uk/access-hpc/benchmarks)\n\n> **HECBioSim benchmark suite** consists of a set of simple benchmarks for a number of popular Molecular Dynamics (MD) engines, each of which is set at a different atom count. The benchmark suite currently contains benchmarks for the AMBER, GROMACS, LAMMPS and NAMD molecular dynamics packages.\n\nIn this example we will choose the \"465K atom system - hEGFR Dimer of 1IVO and 1NQL\" simulation (which can be found here <https://github.com/victorusu/GROMACS_Benchmark_Suite/tree/1.0.0/HECBioSim/hEGFRDimer>). This simulation contains a total number of atoms = 465,399 (Protein atoms = 21,749  Lipid atoms = 134,268  Water atoms = 309,087  Ions = 295). The run will take about 10 minutes to execute (using all 128 cores of an AMD ROME node). The image below shows the simulation that we will run.\n\n- **20K atom system** \n```\ncurl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/Crambin/benchmark.tpr -o Crambin_benchmark.tpr\n```\n- **1.4M atom system** \n``` \ncurl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/hEGFRDimerPair/benchmark.tpr -o hEGFRDimerPair_benchmark.tpr\n``` \n- **3M atom system** \n```\ncurl -LJ https://github.com/victorusu/GROMACS_Benchmark_Suite/raw/1.0.0/HECBioSim/hEGFRDimerSmallerPL/benchmark.tpr -o hEGFRDimerSmallerPL_benchmark.tpr\n```\n\n\n\n\n\n### PyTorch\n> The ResNet model is based on the Deep Residual Learning for Image Recognition from this paper https://arxiv.org/abs/1512.03385 \nhttps://pytorch.org/hub/pytorch_vision_resnet/\n\n**torchvision should be installed in your environment first**\n\nExample how to install 2023\n```\nmodule load 2023\nmodule load PyTorch/2.1.2-foss-2023a-CUDA-12.1.1\nmodule load torchvision/0.16.0-foss-2023a-CUDA-12.1.1\n```\n\nExample jobscript\n[PyTorch_job.sh](scripts/PyTorch_job.sh)\n\n"},{"_path":"/modules/hpc-handson/further_reading","_dir":"hpc-handson","_draft":false,"_partial":false,"_locale":"","title":"Reading material","description":"","type":"reading","order":10,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"reading-material"},"children":[{"type":"text","value":"Reading material"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"EAR documentation for use on Snellius here: "},{"type":"element","tag":"a","props":{"href":"https://servicedesk.surf.nl/wiki/pages/viewpage.action?pageId=62226671","rel":["nofollow"]},"children":[{"type":"text","value":"https://servicedesk.surf.nl/wiki/pages/viewpage.action?pageId=62226671"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"EAR full documentation can be found here "},{"type":"element","tag":"a","props":{"href":"https://gitlab.bsc.es/ear_team/ear/-/wikis/home","rel":["nofollow"]},"children":[{"type":"text","value":"https://gitlab.bsc.es/ear_team/ear/-/wikis/home"}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:hpc-handson:further_reading.md","_source":"local_fs","_file":"modules/hpc-handson/further_reading.md","_stem":"modules/hpc-handson/further_reading","_extension":"md","plainText":"---\ntitle: Reading material\ntype: reading\norder: 10\n---\n\n# Reading material\n\n* EAR documentation for use on Snellius here: https://servicedesk.surf.nl/wiki/pages/viewpage.action?pageId=62226671\n* EAR full documentation can be found here https://gitlab.bsc.es/ear_team/ear/-/wikis/home\n\n\n"},{"_path":"/modules/hpc-handson","_dir":"modules","_draft":false,"_partial":false,"_locale":"","title":"High Performance Computing","description":"","order":3,"category":"Workshop","author":"SURF","thumbnail":"hpc-thumbnail.avif","abstract":"Learn how to use the Energy Aware Runtime tool on Snellius to profile jobs and reduce energy usage.","visibility":"visible","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"category-1"},"children":[{"type":"text","value":"Category 1"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:hpc-handson:index.md","_source":"local_fs","_file":"modules/hpc-handson/index.md","_stem":"modules/hpc-handson/index","_extension":"md","plainText":"---\norder: 3\ncategory: Workshop\ntitle: High Performance Computing\nauthor: SURF\nthumbnail: \"hpc-thumbnail.avif\"\nabstract: Learn how to use the Energy Aware Runtime tool on Snellius to profile jobs and reduce energy usage.\nvisibility: visible\n---\n\n# Category 1\n"},{"_path":"/modules/hpc-handson/info","_dir":"hpc-handson","_draft":false,"_partial":false,"_locale":"","title":"Learning objectives","description":"","type":"info","order":0,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"learning-objectives"},"children":[{"type":"text","value":"Learning Objectives"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this module you will learn to answer the following questions:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How do I optimize the energy usage of code I run on an HPC cluster?"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"learning-objectives","depth":2,"text":"Learning Objectives"}]}},"_type":"markdown","_id":"local_fs:modules:hpc-handson:info.md","_source":"local_fs","_file":"modules/hpc-handson/info.md","_stem":"modules/hpc-handson/info","_extension":"md","plainText":"---\ntitle: Learning objectives\ntype: info\norder: 0\n---\n\n## Learning Objectives\n\nIn this module you will learn to answer the following questions:\n\n* How do I optimize the energy usage of code I run on an HPC cluster?\n"},{"_path":"/modules/hpc-handson/introduction","_dir":"hpc-handson","_draft":false,"_partial":false,"_locale":"","title":"Introduction","description":"","type":"reading","order":3,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"energy-aware-runtime-ear-monitoring-tutorial"},"children":[{"type":"text","value":"Energy Aware Runtime (EAR) Monitoring Tutorial"}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"EAR documentation for use on Snellius here: "},{"type":"element","tag":"a","props":{"href":"https://servicedesk.surf.nl/wiki/pages/viewpage.action?pageId=62226671","rel":["nofollow"]},"children":[{"type":"text","value":"https://servicedesk.surf.nl/wiki/pages/viewpage.action?pageId=62226671"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"EAR full documentation can be found here "},{"type":"element","tag":"a","props":{"href":"https://gitlab.bsc.es/ear_team/ear/-/wikis/home","rel":["nofollow"]},"children":[{"type":"text","value":"https://gitlab.bsc.es/ear_team/ear/-/wikis/home"}]}]}]},{"type":"element","tag":"h1","props":{"id":"section-outline"},"children":[{"type":"text","value":"Section Outline"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"introduction"},"children":[{"type":"text","value":"Introduction"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"earl"},"children":[{"type":"text","value":"EARL"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"tools"},"children":[{"type":"text","value":"Tools"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"exercises"},"children":[{"type":"text","value":"Exercises"}]}]}]},{"type":"element","tag":"h2","props":{"id":"introduction"},"children":[{"type":"text","value":"Introduction"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The Energy Aware Runtime (EAR) package provides an energy management framework for super computers. This tutorial covers the \"end-user\" experience with EAR."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"EAR usage on Snellius can be decomposed into two \"services.\""}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The EAR library (EARL): EARL is loaded (at runtime) when launching an application through the EAR Loader (EARLO) and SLURM plugin (EARPLUG). The EARL provides functionality to monitor energy (and performance) metrics of an application and additionally the ability to select the optimal CPU frequency according to the application and the node characteristics."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Tools: Which include Job accounting (via the command eacct) which queries energy information of a particular job or list of jobs from the the EAR database (EAR DB) on Snellius."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"EAR_configuration","src":"/modules/hpc-handson/media/EAR_config.png"},"children":[]}]},{"type":"element","tag":"h3","props":{"id":"eard-node-manager"},"children":[{"type":"text","value":"EARD: Node Manager"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The node daemon is the component in charge of providing any kind of services that requires privileged capabilities. Current version is conceived as an external process executed with root privileges.\nThe EARD provides the following services, each one covered by one thread:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Provides privileged metrics to EARL such as the average frequency, uncore integrated memory controller counters to compute the memory bandwidth, as well as energy metrics (DC node, DRAM and package energy).\nImplements a periodic power monitoring service. This service allows EAR package to control the total energy consumed in the system.\nOffers a remote API used by EARplug, EARGM and EAR commands. This API accepts requests such as get the system status, change policy settings or notify new job/end job events."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"introduction","depth":2,"text":"Introduction","children":[{"id":"eard-node-manager","depth":3,"text":"EARD: Node Manager"}]}]}},"_type":"markdown","_id":"local_fs:modules:hpc-handson:introduction.md","_source":"local_fs","_file":"modules/hpc-handson/introduction.md","_stem":"modules/hpc-handson/introduction","_extension":"md","plainText":"---\ntitle: Introduction\ntype: reading\norder: 3\n---\n\n# Energy Aware Runtime (EAR) Monitoring Tutorial\n\n>EAR documentation for use on Snellius here: https://servicedesk.surf.nl/wiki/pages/viewpage.action?pageId=62226671\n>\n>EAR full documentation can be found here https://gitlab.bsc.es/ear_team/ear/-/wikis/home\n\n# Section Outline\n\n1. [Introduction](introduction)\n2. [EARL](earl)\n3. [Tools](tools)\n4. [Exercises](exercises)\n\n## Introduction\n\nThe Energy Aware Runtime (EAR) package provides an energy management framework for super computers. This tutorial covers the \"end-user\" experience with EAR.\n\nEAR usage on Snellius can be decomposed into two \"services.\" \n\n1. The EAR library (EARL): EARL is loaded (at runtime) when launching an application through the EAR Loader (EARLO) and SLURM plugin (EARPLUG). The EARL provides functionality to monitor energy (and performance) metrics of an application and additionally the ability to select the optimal CPU frequency according to the application and the node characteristics. \n\n2. Tools: Which include Job accounting (via the command eacct) which queries energy information of a particular job or list of jobs from the the EAR database (EAR DB) on Snellius.\n\n![EAR_configuration](media/EAR_config.png)\n\n### EARD: Node Manager\nThe node daemon is the component in charge of providing any kind of services that requires privileged capabilities. Current version is conceived as an external process executed with root privileges.\nThe EARD provides the following services, each one covered by one thread:\n\nProvides privileged metrics to EARL such as the average frequency, uncore integrated memory controller counters to compute the memory bandwidth, as well as energy metrics (DC node, DRAM and package energy).\nImplements a periodic power monitoring service. This service allows EAR package to control the total energy consumed in the system.\nOffers a remote API used by EARplug, EARGM and EAR commands. This API accepts requests such as get the system status, change policy settings or notify new job/end job events.\n"},{"_path":"/modules/hpc-handson/slides_hpc","_dir":"hpc-handson","_draft":false,"_partial":false,"_locale":"","title":"HPC Hands-on","description":"Note:","type":"slides","order":1,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"hands-on-session-hpc-track"},"children":[{"type":"text","value":"Hands-on Session: HPC track"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Ben Czaja will bring his own slides"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:hpc-handson:slides_HPC.md","_source":"local_fs","_file":"modules/hpc-handson/slides_HPC.md","_stem":"modules/hpc-handson/slides_HPC","_extension":"md","plainText":"---\ntitle: HPC Hands-on\ntype: slides\norder: 1\n---\n\n<!-- .slide: data-state=\"title\" -->\n\n# Hands-on Session: HPC track\n\nNote:\n\nBen Czaja will bring his own slides\n\n===\n"},{"_path":"/modules/hpc-handson/tools","_dir":"hpc-handson","_draft":false,"_partial":false,"_locale":"","title":"EAR Tools","description":"EAR is available on Snellius as a module","type":"reading","order":5,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"ear-tools"},"children":[{"type":"text","value":"EAR Tools"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"EAR is available on Snellius as a module"}]},{"type":"element","tag":"pre","props":{"code":"module load 2022\nmodule load ear\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"module load 2022\nmodule load ear\n"}]}]},{"type":"element","tag":"h3","props":{"id":"job-accounting-eacct"},"children":[{"type":"text","value":"Job accounting (eacct)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The eacct command shows accounting information stored in the EAR DB for jobs (and step) IDs. The command uses EAR’s configuration file to determine if the user running it is privileged or not, as non-privileged users can only access their information. It provides the following options. The ear module needs to be loaded to use the eacct command."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"eacct example usage\nThe basic usage of eacct retrieves the last 20 applications (by default) of the user executing it. The default behavior shows data from each job-step, aggregating the values from each node in said job-step. If using SLURM as a job manager, a sbatch job-step is created with the data from the entire execution. A specific job may be specified with -j option:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Default: Show the last 20 jobs (maximum) executed by the user."}]},{"type":"element","tag":"pre","props":{"code":"eacct\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"eacct\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Query a specific job"}]},{"type":"element","tag":"pre","props":{"code":"eacct -J 123456789\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"eacct -J 123456789\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Query a specific job-step"}]},{"type":"element","tag":"pre","props":{"code":"eacct -J 123456789.0\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"eacct -J 123456789.0\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Show metrics (averaged per job.stepid) from 3 jobs"}]},{"type":"element","tag":"pre","props":{"code":"eacct -j 175966,175967,175968\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"eacct -j 175966,175967,175968\n"}]}]},{"type":"element","tag":"h4","props":{"id":"important-options"},"children":[{"type":"text","value":"Important Options"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-l"}]},{"type":"text","value":" shows the information for each node for each job instead of the global statistics for said job."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-r"}]},{"type":"text","value":" shows the EAR loop signatures. Users, job ids, and step ids can be specified as if were showing job information."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"-c"}]},{"type":"text","value":" specifies the file where the output will be stored in CSV format. If the argument is \"no_file\" the output will be printed to STDOUT "},{"type":"element","tag":"span","props":{},"children":[{"type":"text","value":"default: off"}]}]}]},{"type":"element","tag":"h3","props":{"id":"example"},"children":[{"type":"text","value":"Example:"}]},{"type":"element","tag":"pre","props":{"code":"squeue\n             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)\n           2884239      rome ear_sbat benjamic  R       2:19      1 tcn352\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"squeue\n             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)\n           2884239      rome ear_sbat benjamic  R       2:19      1 tcn352\n"}]}]},{"type":"element","tag":"pre","props":{"code":"[benjamic@int4 EAR]$ eacct -j 2884239\n    JOB-STEP USER       APPLICATION      POLICY NODES AVG/DEF/IMC(GHz) TIME(s)    POWER(W) GBS     CPI   ENERGY(J)    GFLOPS/W IO(MBs) MPI%  G-POW (T/U)   G-FREQ  G-UTIL(G/MEM)\n2884239-sb   benjamic   ear_sbatch_GROMA MO     1     2.57/2.60/---    386.00     596.51   ---     ---   230253       ---      ---     ---   ---           ---     ---          \n2884239-0    benjamic   ear_sbatch_GROMA MO     1     2.57/2.60/1.47   348.64     617.18   8.33    0.33  215175       0.2930   0.3     77.6  0.00/---      ---     --- \n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"[benjamic@int4 EAR]$ eacct -j 2884239\n    JOB-STEP USER       APPLICATION      POLICY NODES AVG/DEF/IMC(GHz) TIME(s)    POWER(W) GBS     CPI   ENERGY(J)    GFLOPS/W IO(MBs) MPI%  G-POW (T/U)   G-FREQ  G-UTIL(G/MEM)\n2884239-sb   benjamic   ear_sbatch_GROMA MO     1     2.57/2.60/---    386.00     596.51   ---     ---   230253       ---      ---     ---   ---           ---     ---          \n2884239-0    benjamic   ear_sbatch_GROMA MO     1     2.57/2.60/1.47   348.64     617.18   8.33    0.33  215175       0.2930   0.3     77.6  0.00/---      ---     --- \n"}]}]},{"type":"element","tag":"h3","props":{"id":"application-characterization"},"children":[{"type":"text","value":"Application Characterization"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"EAR is not only a tool that will throttle CPU Freqs, but it also allows you to collect \"traces\" of your application, and characterize it. This is especially handy for large many node jobs, that often prove difficult to profile. In this way EAR is also a \"light-weight\" profiler for large applications."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The image below illustrates the usage of EAR to show the characteristics of a variety of multi-node CPU based applications side by side. This information can be obtained via the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"monitoring"}]},{"type":"text","value":" policy in EAR, and visualized with the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"eacct"}]},{"type":"text","value":" tool."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Application_char","src":"/modules/hpc-handson/media/CPU_characterization_plot.png"},"children":[]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"job-accounting-eacct","depth":3,"text":"Job accounting (eacct)"},{"id":"example","depth":3,"text":"Example:"},{"id":"application-characterization","depth":3,"text":"Application Characterization"}]}},"_type":"markdown","_id":"local_fs:modules:hpc-handson:tools.md","_source":"local_fs","_file":"modules/hpc-handson/tools.md","_stem":"modules/hpc-handson/tools","_extension":"md","plainText":"---\ntitle: EAR Tools\ntype: reading\norder: 5\n---\n\n\n# EAR Tools\n\nEAR is available on Snellius as a module\n```\nmodule load 2022\nmodule load ear\n```\n### Job accounting (eacct)\nThe eacct command shows accounting information stored in the EAR DB for jobs (and step) IDs. The command uses EAR’s configuration file to determine if the user running it is privileged or not, as non-privileged users can only access their information. It provides the following options. The ear module needs to be loaded to use the eacct command.\n\neacct example usage\nThe basic usage of eacct retrieves the last 20 applications (by default) of the user executing it. The default behavior shows data from each job-step, aggregating the values from each node in said job-step. If using SLURM as a job manager, a sbatch job-step is created with the data from the entire execution. A specific job may be specified with -j option:\n\nDefault: Show the last 20 jobs (maximum) executed by the user.\n```\neacct\n```\nQuery a specific job\n```\neacct -J 123456789\n```\nQuery a specific job-step\n```\neacct -J 123456789.0\n```\nShow metrics (averaged per job.stepid) from 3 jobs\n```\neacct -j 175966,175967,175968\n```\n\n#### Important Options\n - `-l` shows the information for each node for each job instead of the global statistics for said job.\n - `-r` shows the EAR loop signatures. Users, job ids, and step ids can be specified as if were showing job information.\n - `-c` specifies the file where the output will be stored in CSV format. If the argument is \"no_file\" the output will be printed to STDOUT [default: off]\n\n\n### Example:\n\n```\nsqueue\n             JOBID PARTITION     NAME     USER ST       TIME  NODES NODELIST(REASON)\n           2884239      rome ear_sbat benjamic  R       2:19      1 tcn352\n```\n\n```\n[benjamic@int4 EAR]$ eacct -j 2884239\n    JOB-STEP USER       APPLICATION      POLICY NODES AVG/DEF/IMC(GHz) TIME(s)    POWER(W) GBS     CPI   ENERGY(J)    GFLOPS/W IO(MBs) MPI%  G-POW (T/U)   G-FREQ  G-UTIL(G/MEM)\n2884239-sb   benjamic   ear_sbatch_GROMA MO     1     2.57/2.60/---    386.00     596.51   ---     ---   230253       ---      ---     ---   ---           ---     ---          \n2884239-0    benjamic   ear_sbatch_GROMA MO     1     2.57/2.60/1.47   348.64     617.18   8.33    0.33  215175       0.2930   0.3     77.6  0.00/---      ---     --- \n```\n\n### Application Characterization\n\nEAR is not only a tool that will throttle CPU Freqs, but it also allows you to collect \"traces\" of your application, and characterize it. This is especially handy for large many node jobs, that often prove difficult to profile. In this way EAR is also a \"light-weight\" profiler for large applications.\n\nThe image below illustrates the usage of EAR to show the characteristics of a variety of multi-node CPU based applications side by side. This information can be obtained via the `monitoring` policy in EAR, and visualized with the `eacct` tool.\n\n![Application_char](media/CPU_characterization_plot.png)\n"},{"_path":"/modules/introduction-handson/ex_motivation","_dir":"introduction-handson","_draft":false,"_partial":false,"_locale":"","title":"Why care?","description":"Discuss with your neighbour, group or the room...","type":"exercise","order":2,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"why-care-about-green-coding"},"children":[{"type":"text","value":"Why care about green coding?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Discuss with your neighbour, group or the room..."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"...why you are here at this workshop about reducing the environmental footprint of computing and software development?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"...whether you are motivated to reduce your environmental impact"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:introduction-handson:ex_motivation.md","_source":"local_fs","_file":"modules/introduction-handson/ex_motivation.md","_stem":"modules/introduction-handson/ex_motivation","_extension":"md","plainText":"---\ntitle: Why care?\ntype: exercise\norder: 2\n---\n\n# Why care about green coding?\n\nDiscuss with your neighbour, group or the room...\n* ...why you are here at this workshop about reducing the environmental footprint of computing and software development?\n* ...whether you are motivated to reduce your environmental impact\n"},{"_path":"/modules/introduction-handson/ex_workfloor","_dir":"introduction-handson","_draft":false,"_partial":false,"_locale":"","title":"Green workplace","description":"While this workshop is a lot about optimizing the use of computers for sustainability, there is much more to sustainability than that. Global warming is not only a technical problem, it is also one of habits and consumption.","type":"exercise","order":3,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"workfloor-action"},"children":[{"type":"text","value":"Workfloor action"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"While this workshop is a lot about optimizing the use of computers for sustainability, there is much more to sustainability than that. Global warming is not only a technical problem, it is also one of habits and consumption."}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Think about your day to day work environment and think how you can make your workplace more environmentally sustainable. Think out of the box."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Write down some action points"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Discuss with your neighbour and steal any points that you think are relevant to your workplace."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pick one item from the list, which might be feasible to achieve next week."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Commit to it!"}]}]},{"type":"element","tag":"small","props":{},"children":[{"type":"text","value":"\nSome suggestions:\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Policies at work regarding environmental sustainability, are there any and if so, are they good enough?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Go to work by bike/public transport instead of by car"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Rethink your presence at scientific conferences, if you need to go, can you travel by train instead of airplane?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What bank/energe provider/insurrance company does your organization use? Can you make them switch to a more sustainable option?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How is catering arranged? Are there enough plant based options? Some organizations decide to only serve plant based food, is this an option?"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"PS. You can do the same for your personal home environment!"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:introduction-handson:ex_workfloor.md","_source":"local_fs","_file":"modules/introduction-handson/ex_workfloor.md","_stem":"modules/introduction-handson/ex_workfloor","_extension":"md","plainText":"---\ntitle: Green workplace\ntype: exercise\norder: 3\n---\n\n# Workfloor action\n\nWhile this workshop is a lot about optimizing the use of computers for sustainability, there is much more to sustainability than that. Global warming is not only a technical problem, it is also one of habits and consumption.\n\n1. Think about your day to day work environment and think how you can make your workplace more environmentally sustainable. Think out of the box. \n2. Write down some action points\n3. Discuss with your neighbour and steal any points that you think are relevant to your workplace. \n4. Pick one item from the list, which might be feasible to achieve next week. \n5. Commit to it! \n\n<small>\nSome suggestions:\n\n- Policies at work regarding environmental sustainability, are there any and if so, are they good enough?\n- Go to work by bike/public transport instead of by car\n- Rethink your presence at scientific conferences, if you need to go, can you travel by train instead of airplane?\n- What bank/energe provider/insurrance company does your organization use? Can you make them switch to a more sustainable option?\n- How is catering arranged? Are there enough plant based options? Some organizations decide to only serve plant based food, is this an option?\n\n</small>\n\nPS. You can do the same for your personal home environment!"},{"_path":"/modules/introduction-handson/further_reading_module1","_dir":"introduction-handson","_draft":false,"_partial":false,"_locale":"","title":"Reading material","description":"","type":"reading","order":4,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"reading-material"},"children":[{"type":"text","value":"Reading material"}]},{"type":"element","tag":"h2","props":{"id":"courses-in-green-computing-that-could-be-of-interest"},"children":[{"type":"text","value":"Courses in \"Green\" computing that could be of interest"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://research.vu.nl/en/courses/green-lab-4","rel":["nofollow"]},"children":[{"type":"text","value":"https://research.vu.nl/en/courses/green-lab-4"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://training.linuxfoundation.org/training/green-software-for-practitioners-lfc131/","rel":["nofollow"]},"children":[{"type":"text","value":"https://training.linuxfoundation.org/training/green-software-for-practitioners-lfc131/"}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"courses-in-green-computing-that-could-be-of-interest","depth":2,"text":"Courses in \"Green\" computing that could be of interest"}]}},"_type":"markdown","_id":"local_fs:modules:introduction-handson:further_reading_module1.md","_source":"local_fs","_file":"modules/introduction-handson/further_reading_module1.md","_stem":"modules/introduction-handson/further_reading_module1","_extension":"md","plainText":"---\ntitle: Reading material\ntype: reading\norder: 4\n---\n\n# Reading material\n\n## Courses in \"Green\" computing that could be of interest\n* <https://research.vu.nl/en/courses/green-lab-4>\n* <https://training.linuxfoundation.org/training/green-software-for-practitioners-lfc131/>\n"},{"_path":"/modules/introduction-handson","_dir":"modules","_draft":false,"_partial":false,"_locale":"","title":"Introduction","description":"Photo by feey on Unsplash","order":1,"category":"Workshop","author":"eScience Center","abstract":"Putting this workshop in perspective. Why are you here, where lie your interests, what can you do beyond this workshop?","thumbnail":"introduction-thumbnail.jpg","visibility":"visible","body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Photo by "},{"type":"element","tag":"a","props":{"href":"https://unsplash.com/@feeypflanzen?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash"},"children":[{"type":"text","value":"feey"}]},{"type":"text","value":" on "},{"type":"element","tag":"a","props":{"href":"https://unsplash.com/photos/a-potted-plant-with-gardening-utensils-in-it-x7LjEDxKmiw?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash"},"children":[{"type":"text","value":"Unsplash"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:introduction-handson:index.md","_source":"local_fs","_file":"modules/introduction-handson/index.md","_stem":"modules/introduction-handson/index","_extension":"md","plainText":"---\norder: 1\ncategory: Workshop\ntitle: Introduction\nauthor: eScience Center\nabstract: Putting this workshop in perspective. Why are you here, where lie your interests, what can you do beyond this workshop?\nthumbnail: \"introduction-thumbnail.jpg\"\nvisibility: visible\n---\n\nPhoto by <a href=\"https://unsplash.com/@feeypflanzen?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash\">feey</a> on <a href=\"https://unsplash.com/photos/a-potted-plant-with-gardening-utensils-in-it-x7LjEDxKmiw?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash\">Unsplash</a>\n  "},{"_path":"/modules/introduction-handson/info","_dir":"introduction-handson","_draft":false,"_partial":false,"_locale":"","title":"Learning objectives","description":"","type":"info","order":0,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"learning-objectives"},"children":[{"type":"text","value":"Learning Objectives"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this module you will learn to answer the following questions:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Think about your motivation to join this effort. Why do you care about green coding?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Think about policies at work, hardware usage etc. What can you do yourself?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What should be part of internal policy?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How do you communicate this to others (such as management)?"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"learning-objectives","depth":2,"text":"Learning Objectives"}]}},"_type":"markdown","_id":"local_fs:modules:introduction-handson:info.md","_source":"local_fs","_file":"modules/introduction-handson/info.md","_stem":"modules/introduction-handson/info","_extension":"md","plainText":"---\ntitle: Learning objectives\ntype: info\norder: 0\n---\n\n## Learning Objectives\n\nIn this module you will learn to answer the following questions:\n\n* Think about your motivation to join this effort. Why do you care about green coding?\n* Think about policies at work, hardware usage etc. What can you do yourself? \n* What should be part of internal policy?\n* How do you communicate this to others (such as management)?\n"},{"_path":"/modules/introduction-handson/sl_introduction-handson","_dir":"introduction-handson","_draft":false,"_partial":false,"_locale":"","title":"Introduction","description":"===","type":"slides","order":1,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"introduction-hands-on-workshop"},"children":[{"type":"text","value":"Introduction hands-on workshop"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h2","props":{"id":"choose-your-own-adventure"},"children":[{"type":"text","value":"Choose your own adventure"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"yellow-and-black-arrow-sign","src":"/modules/introduction-handson/media/image.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"small","props":{},"children":[{"type":"text","value":"Photo by "},{"type":"element","tag":"a","props":{"href":"https://unsplash.com/@khyta?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash"},"children":[{"type":"text","value":"Khyta"}]},{"type":"text","value":" on "},{"type":"element","tag":"a","props":{"href":"https://unsplash.com/photos/yellow-and-black-arrow-sign-ifJiAtVRthI?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash"},"children":[{"type":"text","value":"Unsplash"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:\nWe use a "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"choose your own adventure approach"}]},{"type":"text","value":" in this hands-on part of the workshop to acommodate for the variety in skill sets."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h2","props":{"id":"choose-your-own-adventure-1"},"children":[{"type":"text","value":"Choose your own adventure"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Software development\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Good practices"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"CI/CD optimization"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Code Carbon, measuring"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"High Performance Computing"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:\nWe have two modules, each with various chapters or exercises. It is not possible to finish everything."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h2","props":{"id":"this-website-is-here-to-stay"},"children":[{"type":"text","value":"This website is here to stay"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Come back to do the other exercises"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Share with others who are interested"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Help us build this, contribute to the contents!"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://www.esciencecenter.nl","rel":["nofollow"]},"children":[{"type":"text","value":"www.esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"mailto:info@esciencecenter.nl"},"children":[{"type":"text","value":"info@esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"020 - 460 47 70"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"choose-your-own-adventure","depth":2,"text":"Choose your own adventure"},{"id":"choose-your-own-adventure-1","depth":2,"text":"Choose your own adventure"},{"id":"this-website-is-here-to-stay","depth":2,"text":"This website is here to stay"}]}},"_type":"markdown","_id":"local_fs:modules:introduction-handson:sl_introduction-handson.md","_source":"local_fs","_file":"modules/introduction-handson/sl_introduction-handson.md","_stem":"modules/introduction-handson/sl_introduction-handson","_extension":"md","plainText":"---\ntitle: Introduction\ntype: slides\norder: 1\n---\n\n<!-- .slide: data-state=\"title\" -->\n\n# Introduction hands-on workshop\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n## Choose your own adventure\n\n![yellow-and-black-arrow-sign](media/image.png)\n\n<small>Photo by <a href=\"https://unsplash.com/@khyta?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash\">Khyta</a> on <a href=\"https://unsplash.com/photos/yellow-and-black-arrow-sign-ifJiAtVRthI?utm_content=creditCopyText&utm_medium=referral&utm_source=unsplash\">Unsplash</a>\n      </small>\n\nNote:\nWe use a *choose your own adventure approach* in this hands-on part of the workshop to acommodate for the variety in skill sets. \n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n## Choose your own adventure\n\n* Software development\n  * Good practices\n  * CI/CD optimization\n  * Code Carbon, measuring \n* High Performance Computing\n\nNote:\nWe have two modules, each with various chapters or exercises. It is not possible to finish everything. \n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n## This website is here to stay\n\n* Come back to do the other exercises\n* Share with others who are interested\n* Help us build this, contribute to the contents!\n\nNote:\n\n\n===\n\n<!-- .slide: data-state=\"keepintouch\" -->\n\n\nwww.esciencecenter.nl\n\ninfo@esciencecenter.nl\n\n020 - 460 47 70\n"},{"_path":"/modules/introduction","_dir":"modules","_draft":false,"_partial":false,"_locale":"","title":"Introduction","description":"","order":1,"category":"Lecture","author":"eScience Center","thumbnail":"burning.jpeg","abstract":"Introduction to the workshop motivations and the schedule.","visibility":"visible","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"category-1"},"children":[{"type":"text","value":"Category 1"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:introduction:index.md","_source":"local_fs","_file":"modules/introduction/index.md","_stem":"modules/introduction/index","_extension":"md","plainText":"---\norder: 1\ncategory: Lecture\ntitle: Introduction\nauthor: eScience Center\nthumbnail: \"burning.jpeg\"\nabstract: Introduction to the workshop motivations and the schedule.\nvisibility: visible\n---\n\n# Category 1\n"},{"_path":"/modules/introduction/info","_dir":"introduction","_draft":false,"_partial":false,"_locale":"","title":"Learning objectives","description":"Here we introduce the motivations behind this workshop.","type":"info","order":0,"body":{"type":"root","children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Here we introduce the motivations behind this workshop."}]},{"type":"element","tag":"h3","props":{"id":"schedule"},"children":[{"type":"text","value":"Schedule"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Time"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"10:30-11:00"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Walk in with tea and coffee"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"11:00-12:00"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Lecture"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"12:00-12:45"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Lunch"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"12:45-13:45"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Hands-on workshop part 1"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"13:45-14:00"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Break"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"14:00-14:45"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Hands-on workshop part 2"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"14:45-15:15"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Wrap up & drinks"}]}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"schedule","depth":3,"text":"Schedule"}]}},"_type":"markdown","_id":"local_fs:modules:introduction:info.md","_source":"local_fs","_file":"modules/introduction/info.md","_stem":"modules/introduction/info","_extension":"md","plainText":"---\ntitle: Learning objectives\ntype: info\norder: 0\n---\n\nHere we introduce the motivations behind this workshop.\n\n### Schedule\n| Time | |\n| :--- | :--- |\n| 10:30-11:00 | Walk in with tea and coffee |\n| 11:00-12:00 | Lecture |\n| 12:00-12:45 | Lunch |\n| 12:45-13:45 | Hands-on workshop part 1 |\n| 13:45-14:00 | Break |\n| 14:00-14:45 | Hands-on workshop part 2 |\n| 14:45-15:15 | Wrap up & drinks |\n"},{"_path":"/modules/introduction/slides","_dir":"introduction","_draft":false,"_partial":false,"_locale":"","title":"Introduction","description":"","type":"slides","order":1,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"green-digital-skills"},"children":[{"type":"text","value":"Green Digital Skills"}]},{"type":"element","tag":"h3","props":{"id":"prinses-máxima-centrum"},"children":[{"type":"text","value":"Prinses Máxima Centrum"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"21st November 2024"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"who-we-are"},"children":[{"type":"text","value":"Who we are"}]},{"type":"element","tag":"div","props":{"style":"width: 60%; float: left; margin-top: 1%"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Netherlands eScience Center\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The national centre for research software"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Collaboratively design sustainable software with researchers, and build digital skills and expertise through teaching"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"SURF\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The ICT cooperative of Dutch education and research institutions"}]}]}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 40%; float: right"},"children":[{"type":"element","tag":"img","props":{"src":"/modules/introduction/media/nlesc.svg","width":"50%","style":"margin-bottom:3cm;"},"children":[]},{"type":"element","tag":"img","props":{"src":"/modules/introduction/media/surf.svg","width":"50%"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"why-do-we-care"},"children":[{"type":"text","value":"Why do we care?"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Relevant projects at NLeSC","src":"/modules/introduction/media/relevant-projects.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:\nAt eScience Center we have many projects concerning environmental destruction due to climate change.\nWe all have expertise in HPC and (computationally) efficient computing so the energy aspects are increasingly interesting to us too."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"More projects","src":"/modules/introduction/media/more_projects.png"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The TulipaEnergyModel is developed as part of a project to make optimal decisions in the electricity energy market, taking into account its interactions and couplings with other energy sectors (including various renewables)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"KernelTuner helps to optimize your GPU kernel code within certain chosen metrics, which can be chosen to help lower overall energy cost."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"before-we-start"},"children":[{"type":"text","value":"Before we start"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"This is a pilot workshop - this is the first time we teach this."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"You are a diverse crowd!\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"No \"one-size-fits-all\" approach"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"This is a broad and high-level introduction to a very deep area"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"We want to help you find the aspect you are interested in and get you set up"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We have people who maybe do data analysis, some scripting (R, Python?) but also others launching some much more complex bioinformatics workflows, and submitting jobs to HPC (either your local cluster or Snellius)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We have tried to include something for everyone here, to get you started with where to go for further expertise"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For the technical aspects there are many good (but much longer) courses available that go into this in depth"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We also give best practices that you might not have considered, or discussion points regarding the need for policy\nWe want you to get set up with the tools you might need and know where to look to pursue that further"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"schedule"},"children":[{"type":"text","value":"Schedule"}]},{"type":"element","tag":"table","props":{},"children":[{"type":"element","tag":"thead","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"th","props":{"align":"left"},"children":[{"type":"text","value":"Time"}]},{"type":"element","tag":"th","props":{"align":"left"},"children":[]}]}]},{"type":"element","tag":"tbody","props":{},"children":[{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"10:30-11:00"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Walk in with tea and coffee"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"11:00-12:00"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Lecture"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"12:00-12:45"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Lunch"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"12:45-13:45"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Hands-on workshop part 1"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"13:45-14:00"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Break"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"14:00-14:45"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Hands-on workshop part 2"}]}]},{"type":"element","tag":"tr","props":{},"children":[{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"14:45-15:15"}]},{"type":"element","tag":"td","props":{"align":"left"},"children":[{"type":"text","value":"Wrap up & drinks"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://www.esciencecenter.nl","rel":["nofollow"]},"children":[{"type":"text","value":"www.esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"mailto:info@esciencecenter.nl"},"children":[{"type":"text","value":"info@esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"020 - 460 47 70"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"prinses-máxima-centrum","depth":3,"text":"Prinses Máxima Centrum"},{"id":"who-we-are","depth":3,"text":"Who we are"},{"id":"why-do-we-care","depth":3,"text":"Why do we care?"},{"id":"before-we-start","depth":3,"text":"Before we start"},{"id":"schedule","depth":3,"text":"Schedule"}]}},"_type":"markdown","_id":"local_fs:modules:introduction:slides.md","_source":"local_fs","_file":"modules/introduction/slides.md","_stem":"modules/introduction/slides","_extension":"md","plainText":"---\ntitle: Introduction\ntype: slides\norder: 1\n---\n\n<!-- .slide: data-state=\"title\" -->\n\n# Green Digital Skills\n### Prinses Máxima Centrum\n\n21st November 2024\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Who we are\n\n<div style=\"width: 60%; float: left; margin-top: 1%\">\n\n- Netherlands eScience Center\n  - The national centre for research software\n  - Collaboratively design sustainable software with researchers, and build digital skills and expertise through teaching\n- SURF\n  - The ICT cooperative of Dutch education and research institutions\n\n</div>\n\n<div style=\"width: 40%; float: right\">\n\n<img src=\"media/nlesc.svg\" width=\"50%\" style=\"margin-bottom:3cm;\"/>\n\n<img src=\"media/surf.svg\" width=\"50%\" />\n\n</div>\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Why do we care?\n\n![Relevant projects at NLeSC](media/relevant-projects.png)\n\n\nNote:\nAt eScience Center we have many projects concerning environmental destruction due to climate change.\nWe all have expertise in HPC and (computationally) efficient computing so the energy aspects are increasingly interesting to us too.\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n![More projects](media/more_projects.png)\n\n\nNote:\n\nThe TulipaEnergyModel is developed as part of a project to make optimal decisions in the electricity energy market, taking into account its interactions and couplings with other energy sectors (including various renewables).\n\nKernelTuner helps to optimize your GPU kernel code within certain chosen metrics, which can be chosen to help lower overall energy cost.\n\n===\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Before we start\n\n- This is a pilot workshop - this is the first time we teach this.\n- You are a diverse crowd!\n  - No \"one-size-fits-all\" approach\n  - This is a broad and high-level introduction to a very deep area\n- We want to help you find the aspect you are interested in and get you set up\n\nNote:\n\nWe have people who maybe do data analysis, some scripting (R, Python?) but also others launching some much more complex bioinformatics workflows, and submitting jobs to HPC (either your local cluster or Snellius)\n\nWe have tried to include something for everyone here, to get you started with where to go for further expertise\n\nFor the technical aspects there are many good (but much longer) courses available that go into this in depth\n\nWe also give best practices that you might not have considered, or discussion points regarding the need for policy\nWe want you to get set up with the tools you might need and know where to look to pursue that further\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Schedule\n| Time | |\n| :--- | :--- |\n| 10:30-11:00 | Walk in with tea and coffee |\n| 11:00-12:00 | Lecture |\n| 12:00-12:45 | Lunch |\n| 12:45-13:45 | Hands-on workshop part 1 |\n| 13:45-14:00 | Break |\n| 14:00-14:45 | Hands-on workshop part 2 |\n| 14:45-15:15 | Wrap up & drinks |\n\n===\n\n<!-- .slide: data-state=\"keepintouch\" -->\n\nwww.esciencecenter.nl\n\ninfo@esciencecenter.nl\n\n020 - 460 47 70\n"},{"_path":"/modules/optimizing-energy-use","_dir":"modules","_draft":false,"_partial":false,"_locale":"","title":"Optimizing Energy Usage","description":"","order":3,"category":"Lecture","author":"eScience Center","thumbnail":"optimizing-thumbnail.avif","abstract":"Learn about what choices you can make to optimize the energy usage of your research code.","visibility":"visible","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"category-2"},"children":[{"type":"text","value":"Category 2"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:optimizing-energy-use:index.md","_source":"local_fs","_file":"modules/optimizing-energy-use/index.md","_stem":"modules/optimizing-energy-use/index","_extension":"md","plainText":"---\norder: 3\ncategory: Lecture\ntitle: Optimizing Energy Usage\nauthor: eScience Center\nthumbnail: \"optimizing-thumbnail.avif\"\nabstract: Learn about what choices you can make to optimize the energy usage of your research code.\nvisibility: visible\n---\n\n# Category 2\n"},{"_path":"/modules/optimizing-energy-use/info","_dir":"optimizing-energy-use","_draft":false,"_partial":false,"_locale":"","title":"Learning objectives","description":"","type":"info","order":0,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"learning-objectives"},"children":[{"type":"text","value":"Learning Objectives"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this module you will learn to answer the following questions:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How do I measure how much energy I am using?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Does this correspond to the real usage?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Does making my code more time-efficient mean it's greener?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What programming language should I choose?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What are some best practices for green coding?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What do I do if I don't develop the code (or for whatever reason can't modify it)?"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"learning-objectives","depth":2,"text":"Learning Objectives"}]}},"_type":"markdown","_id":"local_fs:modules:optimizing-energy-use:info.md","_source":"local_fs","_file":"modules/optimizing-energy-use/info.md","_stem":"modules/optimizing-energy-use/info","_extension":"md","plainText":"---\ntitle: Learning objectives\ntype: info\norder: 0\n---\n\n## Learning Objectives\n\nIn this module you will learn to answer the following questions:\n\n* How do I measure how much energy I am using?\n* Does this correspond to the real usage?\n* Does making my code more time-efficient mean it's greener? \n* What programming language should I choose?\n* What are some best practices for green coding?\n* What do I do if I don't develop the code (or for whatever reason can't modify it)?\n"},{"_path":"/modules/optimizing-energy-use/slides_optimizing_energy_use","_dir":"optimizing-energy-use","_draft":false,"_partial":false,"_locale":"","title":"Optimizing in Practice","description":"===","type":"slides","order":1,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"optimizing-energy-use-in-practice"},"children":[{"type":"text","value":"Optimizing Energy Use in Practice"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-we-will-cover-here"},"children":[{"type":"text","value":"What we will cover here"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What development choices matter?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What should you optimize and how do you know?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What can you do if you can't change the code you're using?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-development-choices-matter"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"What development choices matter?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"good-software-practices"},"children":[{"type":"text","value":"Good software practices"}]},{"type":"element","tag":"center","props":{},"children":[{"type":"element","tag":"img","props":{"src":"media/testing-motivation1.png","width":"30%","style":"display:inline;"},"children":[]},{"type":"element","tag":"img","props":{"src":"media/testing-motivation2.png","width":"30%","style":"display:inline;"},"children":[]},{"type":"element","tag":"img","props":{"src":"media/testing-motivation3.png","width":"30%","style":"display:inline;"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"small","props":{},"children":[{"type":"text","value":" Find the complete articles "},{"type":"element","tag":"a","props":{"href":"https://www.science.org/doi/full/10.1126/science.314.5807.1856","rel":["nofollow"]},"children":[{"type":"text","value":"here"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"https://arstechnica.com/information-technology/2019/10/chemists-discover-cross-platform-python-scripts-not-so-cross-platform/","rel":["nofollow"]},"children":[{"type":"text","value":"here"}]},{"type":"text","value":", and "},{"type":"element","tag":"a","props":{"href":"https://www.wired.com/2010/11/1110mars-climate-observer-report/","rel":["nofollow"]},"children":[{"type":"text","value":"here"}]},{"type":"text","value":" "}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Clean and maintainable software with a robust testing framework is essential\nfor sustainable/green software:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Ease of use, reduce error during data settings"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Less bugs, avoid wasteful bugged runs"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Poor testing and bad software practices lead not only to wrong and retracted papers, but also contribute to a lot of wasted energy..."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the long run, this is as important as measuring the energy use of your code, optimizing run time etc."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We (optionally) cover good software practices in this afternoon's hands-on workshop."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"software-life-cycle"},"children":[{"type":"text","value":"Software life cycle"}]},{"type":"element","tag":"center","props":{},"children":[{"type":"element","tag":"img","props":{"src":"media/cicd_scheme.png","width":"50%"},"children":[]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Thinking about long term sustainability, documentation."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Reusable software is a key component of modern\nsoftware development, reducing the time/energy consuming\ntask of developing every component of complex softwares."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We (optionally) cover good software practices in this afternoon's hands-on workshop."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-language-should-i-use"},"children":[{"type":"text","value":"What language should I use?"}]},{"type":"element","tag":"div","props":{"style":"width: 50%; float: left; margin-top: 1%"},"children":[]},{"type":"element","tag":"div","props":{"style":"width: 50%; float: right"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Ranking of languages","src":"/modules/optimizing-energy-use/media/language_ranking.png"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Energy ranking of languages across many different benchmarks"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Table is from Pereira, R. et al. (2021) "},{"type":"element","tag":"a","props":{"href":"doi:10.1016/j.scico.2021.102609"},"children":[{"type":"text","value":"doi:10.1016/j.scico.2021.102609"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-language-should-i-use-1"},"children":[{"type":"text","value":"What language should I use?"}]},{"type":"element","tag":"div","props":{"style":"width: 50%; float: left; margin-top: 10%; text-align: left;"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Let's use C for everything!"}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 50%; float: right"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Ranking of languages","src":"/modules/optimizing-energy-use/media/language_ranking.png"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Energy ranking of languages across many different benchmarks"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Table is from Pereira, R. et al. (2021) "},{"type":"element","tag":"a","props":{"href":"doi:10.1016/j.scico.2021.102609"},"children":[{"type":"text","value":"doi:10.1016/j.scico.2021.102609"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-language-should-i-use-2"},"children":[{"type":"text","value":"What language should I use?"}]},{"type":"element","tag":"div","props":{"style":"width: 50%; float: left; margin-top: 10%; text-align: left;"},"children":[{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Let's use C for everything!"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Please don't. Reality is more nuanced."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Many major numerical libraries in Python are not Python \"under the surface\""}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The core is usually C++ or similar"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"e.g. PyTorch, Tensorflow, numpy (and many others)"}]}]}]}]}]},{"type":"element","tag":"div","props":{"style":"width: 50%; float: right"},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Ranking of languages","src":"/modules/optimizing-energy-use/media/language_ranking.png"},"children":[]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Typical ranking:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"C++ and Rust at the top"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Python and R at the bottom"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"use-the-right-tool-for-each-task"},"children":[{"type":"text","value":"Use the right tool for each task"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Should I avoid \"slow\" and inefficient programming languages?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Well, each has its purpose\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Python: great for stitching pieces together, easy prototyping"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"C/C++/Fortran: better at crunching numbers fast"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Language benchmarks available in the literature can be misleading here\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Python/R for can be fine, it's more about the libraries you are using"}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-should-you-optimize-and-how-do-you-know"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"What should you optimize and how do you know?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"dont-optimize-everything"},"children":[{"type":"text","value":"Don't optimize everything"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"It is important that frequently used tools are as efficient as possible"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Your single-use analysis scripts probably don't matter so much - just use the easiest language for the job"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Optimization is not free and costs development time (and energy) especially in lower level languages like C"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Generally there are not enough RSEs to do all the coding and optimizations, and researchers don't have time"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"minimize-time-to-solution"},"children":[{"type":"text","value":"Minimize time to solution"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"$$ E = Pt$$"}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Energy is Power * time"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"As a first approximation, more efficient (faster) software will be energy efficient\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"It is possible to run on many CPUs although there is overhead from the parallelism."}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"How to do this is very problem-dependent!"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:\nGenerally speaking, finish as quickly as possible so the CPU can drop to a lower energy state"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"How to get maximum speed out of your code (including parallelism/accelerators) is beyond the scope of this course by quite some distance."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"profile-your-code"},"children":[{"type":"text","value":"Profile your code"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"","src":"/modules/optimizing-energy-use/media/code-carbon.png"},"children":[]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"We recommend trying "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"CodeCarbon"}]},{"type":"text","value":" python package\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Estimates the amount of carbon dioxide (CO$_2$) produced by the cloud or personal computing resources used to execute the code"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Gives recommendations for reducing emissions (e.g. through optimizing the code or by hosting cloud infrastructure in geographical regions that use renewable energy sources)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"More in this afternoon's hands-on workshop"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are many ways to do energy profiling e.g. PMT (Power Measurement Toolkit), Rjoules, and many more."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We recommend trying CodeCarbon"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The code-carbon.io website decribes it as \"a lightweight software package that seamlessly integrates into your Python codebase. It estimates the amount of carbon dioxide (CO$_2$) produced by the cloud or personal computing resources used to execute the code."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It then shows developers how they can lessen emissions by optimizing their code or by hosting their cloud infrastructure in geographical regions that use renewable energy sources.\""}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This sounds like a good place to start for researchers here."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"img","props":{"src":"/modules/optimizing-energy-use/media/codecarbon_dashboard_screenshot.png","width":"100%"},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Screenshot from the website to illustrate functionality: "},{"type":"element","tag":"a","props":{"href":"https://codecarbon.io/#howitwork","rel":["nofollow"]},"children":[{"type":"text","value":"https://codecarbon.io/#howitwork"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In principle there is a dashboard showing your usage in the context of everyday values,\nas well as suggestions for where to run your cloud workflows to reduce carbon cost (assuming\nyou have control over this)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"However, getting the dashboard locally is not really possible/easy yet unfortunately.\nCodeCarbon is promising and developing fast, with lots of interested parties, so\na good choice for the future."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"what-can-you-do-if-you-cant-change-the-code-youre-using"},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"What can you do if you can't change the code you're using?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"change-how-you-run-it"},"children":[{"type":"text","value":"Change how you run it"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Perhaps you can profile the code but you cannot do much with the results\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"e.g. You are not the developer, or don't feel experienced enough"}]}]}]}]},{"type":"element","tag":"img","props":{"src":"/modules/optimizing-energy-use/media/ear-logo.png","width":"40%","style":"padding-top: 1cm;"},"children":[]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Tools like the Energy Aware Runtime can help\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Dynamically scales the CPU or GPU clock frequency up or down while the code is running"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"When code is waiting a lot (for I/O or memory), frequency is scaled down"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Remember that Energy ~ frequency$^2$"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Also covered in this afternoon's hands-on workshop (HPC-track)"}]}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"change-when-you-run-it"},"children":[{"type":"text","value":"Change when you run it"}]},{"type":"element","tag":"img","props":{"src":"/modules/optimizing-energy-use/media/carbon-aware-software.png","width":"60%"},"children":[]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Interesting new tools such as Carbon Aware Task Scheduler (UK-only currently)\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Tells you what is the best time to run in the next 48 hours"}]}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Think about what resources you request\n"},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Number of CPU cores is clearly a large contributor"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Carbon footprint of memory is interesting - doesn't matter how much you use, but how much is available. Don't request 10 times the memory you need on a server \"just in case\""}]}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Carbon awareness image is from "},{"type":"element","tag":"a","props":{"href":"https://github.com/Green-Software-Foundation/carbon-aware-sdk","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/Green-Software-Foundation/carbon-aware-sdk"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Most jobs have some flexibility - we don't care if we run it right now or in a few hours. Especially over the weekend."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"a-warning-jevons-paradox"},"children":[{"type":"text","value":"A warning: Jevon's Paradox"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"In economics, the Jevons paradox occurs when technological progress increases\nthe efficiency with which a resource is used (reducing the amount necessary for any one use),\nbut the falling cost of use induces increases in demand enough that resource use is increased,\nrather than reduced."}]}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://en.wikipedia.org/wiki/Jevons_paradox","rel":["nofollow"]},"children":[{"type":"text","value":"https://en.wikipedia.org/wiki/Jevons_paradox"}]}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"img","props":{"alt":"Interchange in Chicago","src":"/modules/optimizing-energy-use/media/interchange.jpg"},"children":[]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note:\nIn practice, reducing energy use overall is more about organizational policy and value judgements about what the expected return is for a given amount of energy used."}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Are you thinking about this the right way?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Is green computing really a purely technical issue?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Is your footprint by computing really your biggest contribution to the climate crisis?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Organizational policy is as important if not more important"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Image attribution:\nSea Cow, CC BY-SA 4.0 "},{"type":"element","tag":"a","props":{"href":"https://creativecommons.org/licenses/by-sa/4.0","rel":["nofollow"]},"children":[{"type":"text","value":"https://creativecommons.org/licenses/by-sa/4.0"}]},{"type":"text","value":", via Wikimedia Commons"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"h3","props":{"id":"key-points"},"children":[{"type":"text","value":"Key points"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Don't neglect good software development practices"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The libraries you use can matter as much as language choice"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Only optimize code if it will have impact (runs a lot, uses a lot of energy)"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"If you can't change the code, choose when/where to submit it or use a frequency scaling tool"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"==="}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"http://www.esciencecenter.nl","rel":["nofollow"]},"children":[{"type":"text","value":"www.esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"mailto:info@esciencecenter.nl"},"children":[{"type":"text","value":"info@esciencecenter.nl"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"020 - 460 47 70"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"what-we-will-cover-here","depth":3,"text":"What we will cover here"},{"id":"what-development-choices-matter","depth":3,"text":"What development choices matter?"},{"id":"good-software-practices","depth":3,"text":"Good software practices"},{"id":"software-life-cycle","depth":3,"text":"Software life cycle"},{"id":"what-language-should-i-use","depth":3,"text":"What language should I use?"},{"id":"what-language-should-i-use-1","depth":3,"text":"What language should I use?"},{"id":"what-language-should-i-use-2","depth":3,"text":"What language should I use?"},{"id":"use-the-right-tool-for-each-task","depth":3,"text":"Use the right tool for each task"},{"id":"what-should-you-optimize-and-how-do-you-know","depth":3,"text":"What should you optimize and how do you know?"},{"id":"dont-optimize-everything","depth":3,"text":"Don't optimize everything"},{"id":"minimize-time-to-solution","depth":3,"text":"Minimize time to solution"},{"id":"profile-your-code","depth":3,"text":"Profile your code"},{"id":"what-can-you-do-if-you-cant-change-the-code-youre-using","depth":3,"text":"What can you do if you can't change the code you're using?"},{"id":"change-how-you-run-it","depth":3,"text":"Change how you run it"},{"id":"change-when-you-run-it","depth":3,"text":"Change when you run it"},{"id":"a-warning-jevons-paradox","depth":3,"text":"A warning: Jevon's Paradox"},{"id":"key-points","depth":3,"text":"Key points"}]}},"_type":"markdown","_id":"local_fs:modules:optimizing-energy-use:slides_optimizing_energy_use.md","_source":"local_fs","_file":"modules/optimizing-energy-use/slides_optimizing_energy_use.md","_stem":"modules/optimizing-energy-use/slides_optimizing_energy_use","_extension":"md","plainText":"---\ntitle: Optimizing in Practice\ntype: slides\norder: 1\n---\n\n<!-- .slide: data-state=\"title\" -->\n\n# Optimizing Energy Use in Practice\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### What we will cover here\n- What development choices matter?\n- What should you optimize and how do you know?\n- What can you do if you can't change the code you're using?\n\n===\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _What development choices matter?_\n\n===\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Good software practices\n\n<center>\n<img src=\"media/testing-motivation1.png\" width=\"30%\" style=\"display:inline;\">\n<img src=\"media/testing-motivation2.png\" width=\"30%\" style=\"display:inline;\">\n<img src=\"media/testing-motivation3.png\" width=\"30%\" style=\"display:inline;\">\n</center>\n\n<small> Find the complete articles [here](https://www.science.org/doi/full/10.1126/science.314.5807.1856), [here](https://arstechnica.com/information-technology/2019/10/chemists-discover-cross-platform-python-scripts-not-so-cross-platform/), and [here](https://www.wired.com/2010/11/1110mars-climate-observer-report/) </small>\n\n\nClean and maintainable software with a robust testing framework is essential\nfor sustainable/green software:\n - Ease of use, reduce error during data settings\n - Less bugs, avoid wasteful bugged runs\n\nNote:\n\nPoor testing and bad software practices lead not only to wrong and retracted papers, but also contribute to a lot of wasted energy...\n\nIn the long run, this is as important as measuring the energy use of your code, optimizing run time etc.\n\nWe (optionally) cover good software practices in this afternoon's hands-on workshop.\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Software life cycle\n\n<center>\n<img src=\"media/cicd_scheme.png\" width=\"50%\">\n</center>\n\n- Thinking about long term sustainability, documentation.\n- Reusable software is a key component of modern\nsoftware development, reducing the time/energy consuming\ntask of developing every component of complex softwares.\n\nNote:\n\nWe (optionally) cover good software practices in this afternoon's hands-on workshop.\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### What language should I use?\n\n<div style=\"width: 50%; float: left; margin-top: 1%\">\n\n\n</div>\n\n<div style=\"width: 50%; float: right\">\n\n![Ranking of languages](media/language_ranking.png)\n\n</div>\n\nNote:\n\nEnergy ranking of languages across many different benchmarks\n\nTable is from Pereira, R. et al. (2021) <doi:10.1016/j.scico.2021.102609>\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### What language should I use?\n\n<div style=\"width: 50%; float: left; margin-top: 10%; text-align: left;\">\n\n- Let's use C for everything!\n\n</div>\n\n<div style=\"width: 50%; float: right\">\n\n![Ranking of languages](media/language_ranking.png)\n\n</div>\n\nNote:\n\nEnergy ranking of languages across many different benchmarks\n\nTable is from Pereira, R. et al. (2021) <doi:10.1016/j.scico.2021.102609>\n\n===\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n### What language should I use?\n\n<div style=\"width: 50%; float: left; margin-top: 10%; text-align: left;\">\n\n- Let's use C for everything!\n- Please don't. Reality is more nuanced.\n- **Many major numerical libraries in Python are not Python \"under the surface\"**\n  - The core is usually C++ or similar\n  - e.g. PyTorch, Tensorflow, numpy (and many others)\n\n\n</div>\n\n<div style=\"width: 50%; float: right\">\n\n![Ranking of languages](media/language_ranking.png)\n\n</div>\n\n\nNote:\n\nTypical ranking:\n  - C++ and Rust at the top\n  - Python and R at the bottom\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Use the right tool for each task\n\n- Should I avoid \"slow\" and inefficient programming languages?\n- Well, each has its purpose\n  - Python: great for stitching pieces together, easy prototyping\n  - C/C++/Fortran: better at crunching numbers fast\n- Language benchmarks available in the literature can be misleading here\n  - Python/R for can be fine, it's more about the libraries you are using\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _What should you optimize and how do you know?_\n\n===\n\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Don't optimize everything\n\n- **It is important that frequently used tools are as efficient as possible**\n- Your single-use analysis scripts probably don't matter so much - just use the easiest language for the job\n- Optimization is not free and costs development time (and energy) especially in lower level languages like C\n- Generally there are not enough RSEs to do all the coding and optimizations, and researchers don't have time\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Minimize time to solution\n\n`$$ E = Pt$$`\n- Energy is Power * time\n- As a first approximation, more efficient (faster) software will be energy efficient\n  - It is possible to run on many CPUs although there is overhead from the parallelism.\n\nHow to do this is very problem-dependent!\n\nNote:\nGenerally speaking, finish as quickly as possible so the CPU can drop to a lower energy state\n\nHow to get maximum speed out of your code (including parallelism/accelerators) is beyond the scope of this course by quite some distance.\n\n===\n\n### Profile your code\n\n![](media/code-carbon.png)\n\n- We recommend trying `CodeCarbon` python package\n  - Estimates the amount of carbon dioxide (CO$_2$) produced by the cloud or personal computing resources used to execute the code\n  - Gives recommendations for reducing emissions (e.g. through optimizing the code or by hosting cloud infrastructure in geographical regions that use renewable energy sources)\n  - *More in this afternoon's hands-on workshop*\n\nNote:\n\nThere are many ways to do energy profiling e.g. PMT (Power Measurement Toolkit), Rjoules, and many more.\n\nWe recommend trying CodeCarbon\n\nThe code-carbon.io website decribes it as \"a lightweight software package that seamlessly integrates into your Python codebase. It estimates the amount of carbon dioxide (CO$_2$) produced by the cloud or personal computing resources used to execute the code.\n\nIt then shows developers how they can lessen emissions by optimizing their code or by hosting their cloud infrastructure in geographical regions that use renewable energy sources.\"\n\nThis sounds like a good place to start for researchers here.\n\n===\n\n\n<img src=\"media/codecarbon_dashboard_screenshot.png\" width=\"100%\" />\n\nNote:\n\nScreenshot from the website to illustrate functionality: <https://codecarbon.io/#howitwork>\n\nIn principle there is a dashboard showing your usage in the context of everyday values,\nas well as suggestions for where to run your cloud workflows to reduce carbon cost (assuming\nyou have control over this).\n\nHowever, getting the dashboard locally is not really possible/easy yet unfortunately.\nCodeCarbon is promising and developing fast, with lots of interested parties, so\na good choice for the future.\n\n===\n\n\n<!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _What can you do if you can't change the code you're using?_\n\n===\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Change how you run it\n\n\n- Perhaps you can profile the code but you cannot do much with the results\n  - e.g. You are not the developer, or don't feel experienced enough\n\n<img src=\"media/ear-logo.png\" width=\"40%\" style=\"padding-top: 1cm;\"/>\n\n- Tools like the Energy Aware Runtime can help\n  - Dynamically scales the CPU or GPU clock frequency up or down while the code is running\n  - When code is waiting a lot (for I/O or memory), frequency is scaled down\n  - Remember that Energy ~ frequency$^2$\n  - *Also covered in this afternoon's hands-on workshop (HPC-track)*\n\nNote:\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Change when you run it\n\n<img src=\"media/carbon-aware-software.png\" width=\"60%\">\n\n- Interesting new tools such as Carbon Aware Task Scheduler (UK-only currently)\n  - Tells you what is the best time to run in the next 48 hours\n- Think about what resources you request\n  - Number of CPU cores is clearly a large contributor\n  - Carbon footprint of memory is interesting - doesn't matter how much you use, but how much is available. Don't request 10 times the memory you need on a server \"just in case\"\n\nNote:\n\nCarbon awareness image is from <https://github.com/Green-Software-Foundation/carbon-aware-sdk>.\n\nMost jobs have some flexibility - we don't care if we run it right now or in a few hours. Especially over the weekend.\n\n\n===\n\n\n<!-- .slide: data-state=\"standard\" -->\n\n### A warning: Jevon's Paradox\n\n\n_In economics, the Jevons paradox occurs when technological progress increases\nthe efficiency with which a resource is used (reducing the amount necessary for any one use),\nbut the falling cost of use induces increases in demand enough that resource use is increased,\nrather than reduced._\n\n- [https://en.wikipedia.org/wiki/Jevons_paradox](https://en.wikipedia.org/wiki/Jevons_paradox)\n\n![Interchange in Chicago](media/interchange.jpg)\n\nNote:\nIn practice, reducing energy use overall is more about organizational policy and value judgements about what the expected return is for a given amount of energy used.\n\n* Are you thinking about this the right way?\n* Is green computing really a purely technical issue?\n* Is your footprint by computing really your biggest contribution to the climate crisis?\n* Organizational policy is as important if not more important\n\nImage attribution:\nSea Cow, CC BY-SA 4.0 <https://creativecommons.org/licenses/by-sa/4.0>, via Wikimedia Commons\n\n===\n\n<!-- .slide: data-state=\"standard\" -->\n\n### Key points\n  \n- Don't neglect good software development practices\n- The libraries you use can matter as much as language choice\n- Only optimize code if it will have impact (runs a lot, uses a lot of energy)\n- If you can't change the code, choose when/where to submit it or use a frequency scaling tool\n\n===\n\n\n<!-- .slide: data-state=\"keepintouch\" -->\n\n\nwww.esciencecenter.nl\n\ninfo@esciencecenter.nl\n\n020 - 460 47 70\n"},{"_path":"/modules/optimizing-energy-use/useful_links","_dir":"optimizing-energy-use","_draft":false,"_partial":false,"_locale":"","title":"Useful Links","description":"","type":"reading","order":4,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"reading-material"},"children":[{"type":"text","value":"Reading material"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://www.sciencedirect.com/science/article/abs/pii/S0167642321000022","rel":["nofollow"]},"children":[{"type":"text","value":"https://www.sciencedirect.com/science/article/abs/pii/S0167642321000022"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://link.springer.com/content/pdf/10.1186/1471-2105-9-82.pdf","rel":["nofollow"]},"children":[{"type":"text","value":"https://link.springer.com/content/pdf/10.1186/1471-2105-9-82.pdf"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=876288&casa_token=t3_vJU1MZzoAAAAA:XFmC7USWBN185EN6njXKePUjsByVwm-VWrYvnrYQrFzDE5hdJOereEfSu3y4zS3BBoFdUF_5cPY&tag=1","rel":["nofollow"]},"children":[{"type":"text","value":"https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=876288&casa_token=t3_vJU1MZzoAAAAA:XFmC7USWBN185EN6njXKePUjsByVwm-VWrYvnrYQrFzDE5hdJOereEfSu3y4zS3BBoFdUF_5cPY&tag=1"}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"reading-material","depth":2,"text":"Reading material"}]}},"_type":"markdown","_id":"local_fs:modules:optimizing-energy-use:useful_links.md","_source":"local_fs","_file":"modules/optimizing-energy-use/useful_links.md","_stem":"modules/optimizing-energy-use/useful_links","_extension":"md","plainText":"---\ntitle: Useful Links\ntype: reading\norder: 4\n---\n\n## Reading material\n* <https://www.sciencedirect.com/science/article/abs/pii/S0167642321000022>\n* <https://link.springer.com/content/pdf/10.1186/1471-2105-9-82.pdf>\n* <https://ieeexplore.ieee.org/stamp/stamp.jsp?arnumber=876288&casa_token=t3_vJU1MZzoAAAAA:XFmC7USWBN185EN6njXKePUjsByVwm-VWrYvnrYQrFzDE5hdJOereEfSu3y4zS3BBoFdUF_5cPY&tag=1>\n"},{"_path":"/modules/software-development-handson/excercises-code-carbon-r","_dir":"software-development-handson","_draft":false,"_partial":false,"_locale":"","title":"Code Carbon in R","description":"","type":"exercise","order":6,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"codecarbon-in-r"},"children":[{"type":"text","value":"CodeCarbon in R"}]},{"type":"element","tag":"h2","props":{"id":"introduction"},"children":[{"type":"text","value":"Introduction"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you are mainly coding in R, you may want to learn more about the impact of your R code in terms of energy consumption and carbon footprint. However, there aren't yet as of now R packages that allow to do this in a reliable and user-friendly way. One promising tool is the "},{"type":"element","tag":"a","props":{"href":"https://rishalab.github.io/RJoules/","rel":["nofollow"]},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"RJoules package"}]}]},{"type":"text","value":"; however, it is still in development and restricted to certain operating systems used by developers (i.e., linux)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"CodeCarbon"}]},{"type":"text","value":" is a Python package that estimates the carbon footprint of code. You can "},{"type":"element","tag":"a","props":{"href":"https://mlco2.github.io/codecarbon/","rel":["nofollow"]},"children":[{"type":"text","value":"read more about it here"}]},{"type":"text","value":". This Python module is well documented and easy to use. How sad that it is only available for Python... But there is a way to use it in R! In fact, it is possible and relatively easy to run Python in RStudio. This can be done through the "},{"type":"element","tag":"a","props":{"href":"https://rstudio.github.io/reticulate/","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"reticulate"}]}]},{"type":"text","value":" package, which allows you to run Python code from R directly into your R script. For more complex workflows, "},{"type":"element","tag":"a","props":{"href":"https://quarto.org/docs/computations/python.html","rel":["nofollow"]},"children":[{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"Quarto"}]}]},{"type":"text","value":" can be used to combine R and Python code in the same document. In fact, Quarto markdown files (.qmd) are exceptionally good at calling R and Python code in the same document, whilst also making it explicit what code belongs to each, using the native syntax for both languages in the same document and analysis workflow."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This tutorial shows how to implement CodeCarbon in R through RStudio. An example workflow is provided by measuring the carbon footprint of two different R packages used to fit mixed-effects models. Additionally, time-varying confounding is introduced into the built-in R "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ChickWeight"}]},{"type":"text","value":" data through simulation to compare how different statistical modelling strategies to account for confounding compare in terms of their energy consumption and carbon footprint."}]},{"type":"element","tag":"h2","props":{"id":"installation"},"children":[{"type":"text","value":"Installation"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The detailed instructions for installation of Python and CodeCarbon are found in the "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/green-digital-skills/modules/software-development-handson/exercises_codecarbon","rel":["nofollow"]},"children":[{"type":"text","value":"prior lesson"}]},{"type":"text","value":". It is assumed that you have already followed these steps."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you have not done so, "},{"type":"element","tag":"a","props":{"href":"https://posit.co/download/rstudio-desktop/","rel":["nofollow"]},"children":[{"type":"text","value":"install R and RStudio"}]},{"type":"text","value":". Note that these demonstrations were conducted under R version 4.4.0 and RStudio 2024.04.0, so it is recommended that you install these or more recent versions."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Lastly, all the necessary materials and R scripts for this tutorial can be downloaded from Zenodo (doi: "},{"type":"element","tag":"a","props":{"href":"https://doi.org/10.5281/zenodo.14617645","rel":["nofollow"]},"children":[{"type":"text","value":"10.5281/zenodo.14617645"}]},{"type":"text","value":"). You can also download the ZIP file by "},{"type":"element","tag":"a","props":{"href":"https://zenodo.org/records/14617645/files/UtrechtUniversity/code-carbon-r-v1.0.0.zip?download=1","rel":["nofollow"]},"children":[{"type":"text","value":"following this link"}]},{"type":"text","value":", unpack it, and place it in a familiar folder in your computer."}]},{"type":"element","tag":"h2","props":{"id":"calling-codecarbon-in-an-r-script"},"children":[{"type":"text","value":"Calling CodeCarbon in an R script"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You will found a sample R script named "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"code-carbon-script.R"}]},{"type":"text","value":" inside the "},{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"R folder"}]},{"type":"text","value":" if you successfully downloaded the material with the prior steps. This script can be adapted to test your own R code. It incorporates the following steps:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First, you will need to install the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"reticulate"}]},{"type":"text","value":" package and load it into your session:"}]},{"type":"element","tag":"pre","props":{"code":"install.packages(\"reticulate\")\nlibrary(reticulate)\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"install.packages(\"reticulate\")\nlibrary(reticulate)\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Load the CodeCarbon module using the reticulate "},{"type":"element","tag":"a","props":{"href":"https://rstudio.github.io/reticulate/reference/import.html","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"import"}]}]},{"type":"text","value":" function."}]},{"type":"element","tag":"pre","props":{"code":"codecarbon <- import(\"codecarbon\")\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"codecarbon <- import(\"codecarbon\")\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Import the OfflineEmissionsTracker class"}]},{"type":"element","tag":"pre","props":{"code":"OfflineEmissionsTracker <- codecarbon$OfflineEmissionsTracker\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"OfflineEmissionsTracker <- codecarbon$OfflineEmissionsTracker\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Set the emissions trackers parameter and initialize. This will automatically detect your system's characteristics and open a file to save the report later on. You can also specify the country code, timing of measurements, among others. See the "},{"type":"element","tag":"a","props":{"href":"https://mlco2.github.io/codecarbon/parameters.html#id6","rel":["nofollow"]},"children":[{"type":"text","value":"CodeCarbon documentation"}]},{"type":"text","value":" for more details:"}]},{"type":"element","tag":"pre","props":{"code":"tracker <- OfflineEmissionsTracker(\n  country_iso_code = \"NLD\",\n  measure_power_secs = 5\n)\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"tracker <- OfflineEmissionsTracker(\n  country_iso_code = \"NLD\",\n  measure_power_secs = 5\n)\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Start tracking the emissions, run your code, and finish tracking once your code ran."}]},{"type":"element","tag":"pre","props":{"code":"tracker$start()\n\n# Your R code here\n\ntracker$stop()\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"tracker$start()\n\n# Your R code here\n\ntracker$stop()\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This will terminate the report and save it in your default working directory, unless you specified earlier the path to save it according to the provided documentation."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note that CodeCarbon will continue to track until you explicitly stop it with "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tracker$stop()"}]},{"type":"text","value":". Thus, you may want to run all lines of code from start -> code -> stop in one go to measure the consumption of that specific code."}]},{"type":"element","tag":"h2","props":{"id":"calling-codecarbon-in-a-quarto-markdown-qmd-file-in-rstudio"},"children":[{"type":"text","value":"Calling CodeCarbon in a Quarto markdown (qmd) file in RStudio"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you use Quarto, you can call Python and R code in the same document, using their native syntax. For this, you can specify the language of the code block using the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"python"}]},{"type":"text","value":" or "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"r"}]},{"type":"text","value":" tags:"}]},{"type":"element","tag":"pre","props":{"code":"{python}\n# Your python code here\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{python}\n# Your python code here\n"}]}]},{"type":"element","tag":"pre","props":{"code":"{r}\n# Your R code here\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{r}\n# Your R code here\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The advantage of using Quarto is that you don't need to rewrite python code using the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"reticulate"}]},{"type":"text","value":" syntax. You can simply copy and paste the Python code into the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"python"}]},{"type":"text","value":" code block. This is a great advantage when you are not very familiar with Python and you want to reuse well-documented native python code, or simply to efficiently communicate with Python programmers."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Because Rstudio loads the reticulate package once it reads the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"python"}]},{"type":"text","value":" tag, you don't need to load the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"reticulate"}]},{"type":"text","value":" package in the code block. Thus, we will start by calling the CodeCarbon module in Python."}]},{"type":"element","tag":"h3","props":{"id":"setup"},"children":[{"type":"text","value":"Setup"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the downloaded folder, you will find an R project icon named "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"code-carbon-R.Rproj"}]},{"type":"text","value":". Open this project in RStudio. This will set a default working directory, which is useful to read the associated scripts and save the emissions reports. Now, navigate to the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"R"}]},{"type":"text","value":" folder, where you will find a document called "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"code-carbon-Quarto.qmd"}]},{"type":"text","value":". You may open this file in RStudio to reproduce the following steps in the corresponding section."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"em","props":{},"children":[{"type":"text","value":"Tip: The rest of this tutorial can be followed through the code-carbon-Quarto.qmd file in RStudio."}]}]}]},{"type":"element","tag":"h3","props":{"id":"instructions"},"children":[{"type":"text","value":"Instructions"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Start by pressing the play button below that reads \"Run Current Chunk\":"}]},{"type":"element","tag":"pre","props":{"code":"{python}\n# Load the CodeCarbon module\nfrom codecarbon import OfflineEmissionsTracker\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{python}\n# Load the CodeCarbon module\nfrom codecarbon import OfflineEmissionsTracker\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Then, we will initialize the tracker and start tracking the emissions. Beware that you will need to stop tracking the emissions before with the code that will appear later on in this document to start a new tracker. For this, we can use a safety check to avoid running multiple trackers at the same time."}]},{"type":"element","tag":"pre","props":{"code":"{python}\ntracker = OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5)\n\nif getattr(tracker, \"_start_time\", None) is not None:\n    print(\"Warning: Tracker is already running! Did you forget to stop it?\")\nelse:\n    tracker.start()\n    print(\"Tracker started successfully.\")\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{python}\ntracker = OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5)\n\nif getattr(tracker, \"_start_time\", None) is not None:\n    print(\"Warning: Tracker is already running! Did you forget to stop it?\")\nelse:\n    tracker.start()\n    print(\"Tracker started successfully.\")\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can now change to R language by using the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"r"}]},{"type":"text","value":" tag. In this code block, you can introduce your R code. For example, a fictitious computationally intensive function for which you would like to test its energy consumption."}]},{"type":"element","tag":"pre","props":{"code":"{r}\nintense_computation(large_dataset)\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{r}\nintense_computation(large_dataset)\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finally, you can stop tracking the emissions and print the results. You will again find the report as a csv file in your default working directory."}]},{"type":"element","tag":"pre","props":{"code":"{python}\nemissions: float = tracker.stop()\nprint(f\"Emissions tracked: {emissions} kg CO₂e\")\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"{python}\nemissions: float = tracker.stop()\nprint(f\"Emissions tracked: {emissions} kg CO₂e\")\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This value represents the estimated carbon emissions equivalent in kilograms."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Combining R and Python code in a .qmd file will work best if you are rendering your document to any of the output report files implemented in Quarto (i.e., PDF, html, docx, slides, etc). This is because code blocks are executed in the order they are found in the document. However, if you mainly work with R scripts, running CodeCarbon with the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"reticulate"}]},{"type":"text","value":" package in R will be the best approach."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For the last part of this tutorial, a hybrid approach is used where:"}]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Individual R scripts are adapted from the sample "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"code-carbon-script.R"}]},{"type":"text","value":" to include CodeCarbon tracking for every individual task."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"The individual R scripts are then sourced into the Quarto document to demonstrate the energy consumption and carbon footprint of different R packages used to fit mixed-effects models."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"This model workflow produces an individual output report for every R script and task, which will be found in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"emissions"}]},{"type":"text","value":" folder."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This approach offers the advantage of more precise measurements because every script starts with the initialization of the tracker and ends with the stop command in one go."}]},{"type":"element","tag":"h2","props":{"id":"demonstration"},"children":[{"type":"text","value":"Demonstration"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We will compare two R packages commonly used to fit mixed-effects models that are often compared due to their computational speed. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"lme4"}]},{"type":"text","value":" is suitable for generalized linear mixed models, runs in C++, and is optimized for speed,"},{"type":"element","tag":"sup","props":{},"children":[{"type":"text","value":"1"}]},{"type":"text","value":" whereas "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nlme"}]},{"type":"text","value":" can additionally fit non-linear models, but is written in R language (before: S and S-Plus)"},{"type":"element","tag":"sup","props":{},"children":[{"type":"text","value":"2"}]},{"type":"text","value":" which makes computations somewhat slower and with a potentially higher carbon footprint."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"However, there are often preliminary modelling steps needed when trying to elucidate the main effects with these two packages. One example is time varying confounding, for which different modelling approaches have been proposed. Inverse probability weighting (IPW) is a powerful tool for such analyses, but many different models can be used to obtain inverse probability weights to be used in the main mixed-effects models. Generalized linear models can be used as a fast an computationally efficient option to obtain IPW through the built-in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stats"}]},{"type":"text","value":" R package, which is written in R and C language, but is highly susceptible to incorrect model specification. Novel non-parametric methods are robust to model misspecification,"},{"type":"element","tag":"sup","props":{},"children":[{"type":"text","value":"3"}]},{"type":"text","value":" and are implemented in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"CBPS"}]},{"type":"text","value":" package, which despite running in C++ for computational efficiency, uses intensive and lengthy calculations. These two methods will be compared using Python "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"CodeCarbon"}]},{"type":"text","value":". We will use the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"WeightIt"}]},{"type":"text","value":" package written in R language,"},{"type":"element","tag":"sup","props":{},"children":[{"type":"text","value":"4"}]},{"type":"text","value":" which has implemented these two methods and many others which can similarly be tested and compared in terms of energy consumption and carbon footprint."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We will use the built-in R "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"ChickWeight"}]},{"type":"text","value":" dataset to simulate new data with time-varying treatment-outcome confounding to study the effect of 4 different diets on weight, by accounting for the confounding effect of a time-varying binary disease 1, and an ordinal disease 2, which disease status may also vary in time."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"First, install and load all the necessary R packages to avoid these one-time installations being tracked by CodeCarbon. The "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pacman"}]},{"type":"text","value":" package nicely handles installation and loading."}]},{"type":"element","tag":"pre","props":{"code":"if (!require(\"pacman\", quietly = TRUE)) {\n  install.packages(\"pacman\")\n}\n\npacman::p_load(\n  tidyverse,        # Used for basic data handling and visualization.\n  conflicted,       # Used to handle conflicts between packages.\n  reticulate,       # Used to call Python code in R.\n  lme4,             # Used to fit linear mixed-effects models.\n  nlme,             # Used to fit non-linear mixed-effects models.\n  WeightIt,         # Used to obtain inverse probability weights (IPW).\n  CBPS              # Used to obtain non-parametric CBPS IPW.\n)\n\nconflicts_prefer(dplyr::select, dplyr::lag, dplyr::filter)\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"if (!require(\"pacman\", quietly = TRUE)) {\n  install.packages(\"pacman\")\n}\n\npacman::p_load(\n  tidyverse,        # Used for basic data handling and visualization.\n  conflicted,       # Used to handle conflicts between packages.\n  reticulate,       # Used to call Python code in R.\n  lme4,             # Used to fit linear mixed-effects models.\n  nlme,             # Used to fit non-linear mixed-effects models.\n  WeightIt,         # Used to obtain inverse probability weights (IPW).\n  CBPS              # Used to obtain non-parametric CBPS IPW.\n)\n\nconflicts_prefer(dplyr::select, dplyr::lag, dplyr::filter)\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We now simulate the data and measure the time required to complete and it's carbon footprint. The input and output parameters have been adapted in the R script to save the output file in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"emissions"}]},{"type":"text","value":" folder. By running this chunk of code, you will also see the live emissions tracking as R console output."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Important! If the code is interrupted before finishing, emissions will keep to be tracked and shown until you stop it by running the last line in the scripts. This is important to keep in mind when running new code chunks and start a new tracker. Run tracker$stop() whenever your code is prematurely interrupted before reaching the end of the script."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Tip: If any of the scripts take too long to run, you can try modifying the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"sample_size"}]},{"type":"text","value":" parameter in the "},{"type":"element","tag":"strong","props":{},"children":[{"type":"text","value":"data_simulation.R"}]},{"type":"text","value":" script. This will also be changed below in this code file to explore emissions with different sample sizes."}]},{"type":"element","tag":"pre","props":{"code":"source(\"data-simulation.R\")\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"source(\"data-simulation.R\")\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's now measure the energy consumption of obtaining inverse probability weights with a generalized linear model (glm) in the built-in "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"stats"}]},{"type":"text","value":" R package."}]},{"type":"element","tag":"pre","props":{"code":"source(\"ipw_glm.R\")\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"source(\"ipw_glm.R\")\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"And compare against the novel non-parametric method implemented in the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"CBPS"}]},{"type":"text","value":" package. This will take longer to run than the prior steps, so we will track emissions every 5 seconds."}]},{"type":"element","tag":"pre","props":{"code":"source(\"ipw_CBPS.R\")\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"source(\"ipw_CBPS.R\")\n"}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Question: Would you prefer the faster glm method or the more robust CBPS method to obtain IPW?"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Finally, we will fit the mixed-effects models with the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"lme4"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nlme"}]},{"type":"text","value":" packages, and compare their energy consumption."}]},{"type":"element","tag":"pre","props":{"code":"source(\"mixed_model_lme4.R\")\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"source(\"mixed_model_lme4.R\")\n"}]}]},{"type":"element","tag":"pre","props":{"code":"source(\"mixed_model_nlme.R\")\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"source(\"mixed_model_nlme.R\")\n"}]}]},{"type":"element","tag":"h3","props":{"id":"simulation-with-a-larger-dataset"},"children":[{"type":"text","value":"Simulation with a larger dataset"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The original tests used 550 observations in a total of 50 chicks. This was sufficient to demonstrate the differences in emissions with the two IPW methods, but not with the different mixed-effects packages. We will next simulate a much larger dataset with 5000 chicks to be able to compare "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"lme4"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nlme"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"code":"# Simulate new data and prepare the dataset for analysis \n\nsimulated_data <- simulate_chickweight(n_chicks = 5000)\n\nanalysis_data <- simulated_data %>%\n  arrange(Chick, Time) %>%\n  group_by(Chick) %>%\n  mutate(\n    lag_disease_1 = lag(disease_1),\n    lag_disease_2 = lag(disease_2),\n    lag_weight = lag(weight)\n  ) %>%\n  ungroup()\n\nanalysis_data <- analysis_data %>%\n  filter(!is.na(lag_disease_1))\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# Simulate new data and prepare the dataset for analysis \n\nsimulated_data <- simulate_chickweight(n_chicks = 5000)\n\nanalysis_data <- simulated_data %>%\n  arrange(Chick, Time) %>%\n  group_by(Chick) %>%\n  mutate(\n    lag_disease_1 = lag(disease_1),\n    lag_disease_2 = lag(disease_2),\n    lag_weight = lag(weight)\n  ) %>%\n  ungroup()\n\nanalysis_data <- analysis_data %>%\n  filter(!is.na(lag_disease_1))\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We will use the IPW obtained with glm for faster computations."}]},{"type":"element","tag":"pre","props":{"code":"source(\"ipw_glm.R\")\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"source(\"ipw_glm.R\")\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"And now we can compare the energy consumption of fitting the exact same model with the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"lme4"}]},{"type":"text","value":" and "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"nlme"}]},{"type":"text","value":"."}]},{"type":"element","tag":"pre","props":{"code":"source(\"mixed_model_lme4.R\")\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"source(\"mixed_model_lme4.R\")\n"}]}]},{"type":"element","tag":"pre","props":{"code":"source(\"mixed_model_nlme.R\")\n","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"source(\"mixed_model_nlme.R\")\n"}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Question: How do the energy consumption and carbon footprint of the two packages compare with the larger dataset when fitting the same model?"}]}]},{"type":"element","tag":"h2","props":{"id":"conclusions"},"children":[{"type":"text","value":"Conclusions"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This tutorial provides different alternatives to implement CodeCarbon in R workflows. The provided code can be adapted and used by R code developers and other R users to test the efficiency and carbon footprint of their code. Existing R packages able to perform the same tasks can be compared in terms of energy consumption, which can be an additional criterion to choose between them. However, it should be kept in mind that energy consumption an carbon footprint are among the many factors to consider when choosing between different packages. For instance, it could be justifiable to use a method that consumes more energy and has a higher carbon footprint if it offers other significant advantages."}]},{"type":"element","tag":"h2","props":{"id":"references"},"children":[{"type":"text","value":"References"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"ol","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Bates, Douglas, Martin Mächler, Ben Bolker, and Steve Walker. 2015. “Fitting Linear Mixed-Effects Models Using Lme4.” Journal of Statistical Software 67 (1). "},{"type":"element","tag":"a","props":{"href":"https://doi.org/10.18637/jss.v067.i01","rel":["nofollow"]},"children":[{"type":"text","value":"https://doi.org/10.18637/jss.v067.i01"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Fong, Christian, Chad Hazlett, and Kosuke Imai. 2018. “Covariate Balancing Propensity Score for a Continuous Treatment: Application to the Efficacy of Political Advertisements.” The Annals of Applied Statistics 12 (1). "},{"type":"element","tag":"a","props":{"href":"https://doi.org/10.1214/17-aoas1101","rel":["nofollow"]},"children":[{"type":"text","value":"https://doi.org/10.1214/17-aoas1101"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Greifer, Noah. 2017. “WeightIt: Weighting for Covariate Balance in Observational Studies.” The R Foundation. "},{"type":"element","tag":"a","props":{"href":"https://doi.org/10.32614/cran.package.weightit","rel":["nofollow"]},"children":[{"type":"text","value":"https://doi.org/10.32614/cran.package.weightit"}]},{"type":"text","value":"."}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"Pinheiro, José C., and Douglas M. Bates. 2000. Mixed-Effects Models in s and s-PLUS. New York: Springer. "},{"type":"element","tag":"a","props":{"href":"https://doi.org/10.1007/b98882","rel":["nofollow"]},"children":[{"type":"text","value":"https://doi.org/10.1007/b98882"}]},{"type":"text","value":"."}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"introduction","depth":2,"text":"Introduction"},{"id":"installation","depth":2,"text":"Installation"},{"id":"calling-codecarbon-in-an-r-script","depth":2,"text":"Calling CodeCarbon in an R script"},{"id":"calling-codecarbon-in-a-quarto-markdown-qmd-file-in-rstudio","depth":2,"text":"Calling CodeCarbon in a Quarto markdown (qmd) file in RStudio","children":[{"id":"setup","depth":3,"text":"Setup"},{"id":"instructions","depth":3,"text":"Instructions"}]},{"id":"demonstration","depth":2,"text":"Demonstration","children":[{"id":"simulation-with-a-larger-dataset","depth":3,"text":"Simulation with a larger dataset"}]},{"id":"conclusions","depth":2,"text":"Conclusions"},{"id":"references","depth":2,"text":"References"}]}},"_type":"markdown","_id":"local_fs:modules:software-development-handson:excercises-code-carbon-r.md","_source":"local_fs","_file":"modules/software-development-handson/excercises-code-carbon-r.md","_stem":"modules/software-development-handson/excercises-code-carbon-r","_extension":"md","plainText":"---\ntitle: \"Code Carbon in R\"\ntype: exercise\norder: 6\n---\n\n# CodeCarbon in R\n\n## Introduction\n---------------\n\nIf you are mainly coding in R, you may want to learn more about the impact of your R code in terms of energy consumption and carbon footprint. However, there aren't yet as of now R packages that allow to do this in a reliable and user-friendly way. One promising tool is the [**RJoules package**](https://rishalab.github.io/RJoules/); however, it is still in development and restricted to certain operating systems used by developers (i.e., linux).\n\n**CodeCarbon** is a Python package that estimates the carbon footprint of code. You can [read more about it here](https://mlco2.github.io/codecarbon/). This Python module is well documented and easy to use. How sad that it is only available for Python... But there is a way to use it in R! In fact, it is possible and relatively easy to run Python in RStudio. This can be done through the [`reticulate`](https://rstudio.github.io/reticulate/) package, which allows you to run Python code from R directly into your R script. For more complex workflows, [**Quarto**](https://quarto.org/docs/computations/python.html) can be used to combine R and Python code in the same document. In fact, Quarto markdown files (.qmd) are exceptionally good at calling R and Python code in the same document, whilst also making it explicit what code belongs to each, using the native syntax for both languages in the same document and analysis workflow.\n\nThis tutorial shows how to implement CodeCarbon in R through RStudio. An example workflow is provided by measuring the carbon footprint of two different R packages used to fit mixed-effects models. Additionally, time-varying confounding is introduced into the built-in R `ChickWeight` data through simulation to compare how different statistical modelling strategies to account for confounding compare in terms of their energy consumption and carbon footprint.\n\n## Installation\n---------------\n\nThe detailed instructions for installation of Python and CodeCarbon are found in the [prior lesson](https://esciencecenter-digital-skills.github.io/green-digital-skills/modules/software-development-handson/exercises_codecarbon). It is assumed that you have already followed these steps.\n\nIf you have not done so, [install R and RStudio](https://posit.co/download/rstudio-desktop/). Note that these demonstrations were conducted under R version 4.4.0 and RStudio 2024.04.0, so it is recommended that you install these or more recent versions.\n\nLastly, all the necessary materials and R scripts for this tutorial can be downloaded from Zenodo (doi: [10.5281/zenodo.14617645](https://doi.org/10.5281/zenodo.14617645)). You can also download the ZIP file by [following this link](https://zenodo.org/records/14617645/files/UtrechtUniversity/code-carbon-r-v1.0.0.zip?download=1), unpack it, and place it in a familiar folder in your computer. \n\n## Calling CodeCarbon in an R script\n-------------------------------------\n\nYou will found a sample R script named **code-carbon-script.R** inside the *R folder* if you successfully downloaded the material with the prior steps. This script can be adapted to test your own R code. It incorporates the following steps:\n\nFirst, you will need to install the `reticulate` package and load it into your session:\n\n```         \ninstall.packages(\"reticulate\")\nlibrary(reticulate)\n```\n\nLoad the CodeCarbon module using the reticulate [`import`](https://rstudio.github.io/reticulate/reference/import.html) function.\n\n```         \ncodecarbon <- import(\"codecarbon\")\n```\n\nImport the OfflineEmissionsTracker class\n\n```         \nOfflineEmissionsTracker <- codecarbon$OfflineEmissionsTracker\n```\n\nSet the emissions trackers parameter and initialize. This will automatically detect your system's characteristics and open a file to save the report later on. You can also specify the country code, timing of measurements, among others. See the [CodeCarbon documentation](https://mlco2.github.io/codecarbon/parameters.html#id6) for more details:\n\n```         \ntracker <- OfflineEmissionsTracker(\n  country_iso_code = \"NLD\",\n  measure_power_secs = 5\n)\n```\n\nStart tracking the emissions, run your code, and finish tracking once your code ran.\n\n```         \ntracker$start()\n\n# Your R code here\n\ntracker$stop()\n```\n\nThis will terminate the report and save it in your default working directory, unless you specified earlier the path to save it according to the provided documentation.\n\nNote that CodeCarbon will continue to track until you explicitly stop it with `tracker$stop()`. Thus, you may want to run all lines of code from start -\\> code -\\> stop in one go to measure the consumption of that specific code.\n\n## Calling CodeCarbon in a Quarto markdown (qmd) file in RStudio\n----------------------------------------------------------------\n\nIf you use Quarto, you can call Python and R code in the same document, using their native syntax. For this, you can specify the language of the code block using the `python` or `r` tags:\n\n\n```\n{python}\n# Your python code here\n``` \n\n```\n{r}\n# Your R code here\n```\n\nThe advantage of using Quarto is that you don't need to rewrite python code using the `reticulate` syntax. You can simply copy and paste the Python code into the `python` code block. This is a great advantage when you are not very familiar with Python and you want to reuse well-documented native python code, or simply to efficiently communicate with Python programmers.\n\nBecause Rstudio loads the reticulate package once it reads the `python` tag, you don't need to load the `reticulate` package in the code block. Thus, we will start by calling the CodeCarbon module in Python.\n\n### Setup \n\nIn the downloaded folder, you will find an R project icon named **code-carbon-R.Rproj**. Open this project in RStudio. This will set a default working directory, which is useful to read the associated scripts and save the emissions reports. Now, navigate to the **R** folder, where you will find a document called **code-carbon-Quarto.qmd**. You may open this file in RStudio to reproduce the following steps in the corresponding section. \n\n> *Tip: The rest of this tutorial can be followed through the code-carbon-Quarto.qmd file in RStudio.*\n\n### Instructions  \n\nStart by pressing the play button below that reads \"Run Current Chunk\":\n\n```\n{python}\n# Load the CodeCarbon module\nfrom codecarbon import OfflineEmissionsTracker\n```\n\nThen, we will initialize the tracker and start tracking the emissions. Beware that you will need to stop tracking the emissions before with the code that will appear later on in this document to start a new tracker. For this, we can use a safety check to avoid running multiple trackers at the same time.\n\n```\n{python}\ntracker = OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5)\n\nif getattr(tracker, \"_start_time\", None) is not None:\n    print(\"Warning: Tracker is already running! Did you forget to stop it?\")\nelse:\n    tracker.start()\n    print(\"Tracker started successfully.\")\n```\n\nYou can now change to R language by using the `r` tag. In this code block, you can introduce your R code. For example, a fictitious computationally intensive function for which you would like to test its energy consumption.\n\n``` \n{r}\nintense_computation(large_dataset)\n```\n\nFinally, you can stop tracking the emissions and print the results. You will again find the report as a csv file in your default working directory.\n\n\n```\n{python}\nemissions: float = tracker.stop()\nprint(f\"Emissions tracked: {emissions} kg CO₂e\")\n```\n\nThis value represents the estimated carbon emissions equivalent in kilograms.\n\nCombining R and Python code in a .qmd file will work best if you are rendering your document to any of the output report files implemented in Quarto (i.e., PDF, html, docx, slides, etc). This is because code blocks are executed in the order they are found in the document. However, if you mainly work with R scripts, running CodeCarbon with the `reticulate` package in R will be the best approach.\n\nFor the last part of this tutorial, a hybrid approach is used where:\n1.  Individual R scripts are adapted from the sample **code-carbon-script.R** to include CodeCarbon tracking for every individual task.  \n2.  The individual R scripts are then sourced into the Quarto document to demonstrate the energy consumption and carbon footprint of different R packages used to fit mixed-effects models.  \n3.  This model workflow produces an individual output report for every R script and task, which will be found in the `emissions` folder. \n\nThis approach offers the advantage of more precise measurements because every script starts with the initialization of the tracker and ends with the stop command in one go.\n\n## Demonstration\n----------------\n\nWe will compare two R packages commonly used to fit mixed-effects models that are often compared due to their computational speed. `lme4` is suitable for generalized linear mixed models, runs in C++, and is optimized for speed,<sup>1</sup> whereas `nlme` can additionally fit non-linear models, but is written in R language (before: S and S-Plus)<sup>2</sup> which makes computations somewhat slower and with a potentially higher carbon footprint.\n\nHowever, there are often preliminary modelling steps needed when trying to elucidate the main effects with these two packages. One example is time varying confounding, for which different modelling approaches have been proposed. Inverse probability weighting (IPW) is a powerful tool for such analyses, but many different models can be used to obtain inverse probability weights to be used in the main mixed-effects models. Generalized linear models can be used as a fast an computationally efficient option to obtain IPW through the built-in `stats` R package, which is written in R and C language, but is highly susceptible to incorrect model specification. Novel non-parametric methods are robust to model misspecification,<sup>3</sup> and are implemented in the `CBPS` package, which despite running in C++ for computational efficiency, uses intensive and lengthy calculations. These two methods will be compared using Python `CodeCarbon`. We will use the `WeightIt` package written in R language,<sup>4</sup> which has implemented these two methods and many others which can similarly be tested and compared in terms of energy consumption and carbon footprint.\n\nWe will use the built-in R `ChickWeight` dataset to simulate new data with time-varying treatment-outcome confounding to study the effect of 4 different diets on weight, by accounting for the confounding effect of a time-varying binary disease 1, and an ordinal disease 2, which disease status may also vary in time.\n\nFirst, install and load all the necessary R packages to avoid these one-time installations being tracked by CodeCarbon. The `pacman` package nicely handles installation and loading.\n\n``` {.r .cell-code}\nif (!require(\"pacman\", quietly = TRUE)) {\n  install.packages(\"pacman\")\n}\n\npacman::p_load(\n  tidyverse,        # Used for basic data handling and visualization.\n  conflicted,       # Used to handle conflicts between packages.\n  reticulate,       # Used to call Python code in R.\n  lme4,             # Used to fit linear mixed-effects models.\n  nlme,             # Used to fit non-linear mixed-effects models.\n  WeightIt,         # Used to obtain inverse probability weights (IPW).\n  CBPS              # Used to obtain non-parametric CBPS IPW.\n)\n\nconflicts_prefer(dplyr::select, dplyr::lag, dplyr::filter)\n```\n\n\nWe now simulate the data and measure the time required to complete and it's carbon footprint. The input and output parameters have been adapted in the R script to save the output file in the `emissions` folder. By running this chunk of code, you will also see the live emissions tracking as R console output.\n\n> Important! If the code is interrupted before finishing, emissions will keep to be tracked and shown until you stop it by running the last line in the scripts. This is important to keep in mind when running new code chunks and start a new tracker. Run tracker\\$stop() whenever your code is prematurely interrupted before reaching the end of the script.\n\nTip: If any of the scripts take too long to run, you can try modifying the `sample_size` parameter in the **data_simulation.R** script. This will also be changed below in this code file to explore emissions with different sample sizes.\n\n``` {.r .cell-code}\nsource(\"data-simulation.R\")\n```\n\nLet's now measure the energy consumption of obtaining inverse probability weights with a generalized linear model (glm) in the built-in `stats` R package.\n\n\n``` {.r .cell-code}\nsource(\"ipw_glm.R\")\n```\n\n\nAnd compare against the novel non-parametric method implemented in the `CBPS` package. This will take longer to run than the prior steps, so we will track emissions every 5 seconds.\n\n``` {.r .cell-code}\nsource(\"ipw_CBPS.R\")\n```\n\n> Question: Would you prefer the faster glm method or the more robust CBPS method to obtain IPW? \n\nFinally, we will fit the mixed-effects models with the `lme4` and `nlme` packages, and compare their energy consumption.\n\n``` {.r .cell-code}\nsource(\"mixed_model_lme4.R\")\n```\n\n``` {.r .cell-code}\nsource(\"mixed_model_nlme.R\")\n```\n\n### Simulation with a larger dataset\n\n\nThe original tests used 550 observations in a total of 50 chicks. This was sufficient to demonstrate the differences in emissions with the two IPW methods, but not with the different mixed-effects packages. We will next simulate a much larger dataset with 5000 chicks to be able to compare `lme4` and `nlme`.\n\n\n``` {.r .cell-code}\n# Simulate new data and prepare the dataset for analysis \n\nsimulated_data <- simulate_chickweight(n_chicks = 5000)\n\nanalysis_data <- simulated_data %>%\n  arrange(Chick, Time) %>%\n  group_by(Chick) %>%\n  mutate(\n    lag_disease_1 = lag(disease_1),\n    lag_disease_2 = lag(disease_2),\n    lag_weight = lag(weight)\n  ) %>%\n  ungroup()\n\nanalysis_data <- analysis_data %>%\n  filter(!is.na(lag_disease_1))\n```\n\n\nWe will use the IPW obtained with glm for faster computations.\n\n\n``` {.r .cell-code}\nsource(\"ipw_glm.R\")\n```\n\nAnd now we can compare the energy consumption of fitting the exact same model with the `lme4` and `nlme`.\n\n\n``` {.r .cell-code}\nsource(\"mixed_model_lme4.R\")\n```\n\n``` {.r .cell-code}\nsource(\"mixed_model_nlme.R\")\n```\n\n> Question: How do the energy consumption and carbon footprint of the two packages compare with the larger dataset when fitting the same model? \n\n## Conclusions\n---------------\n\nThis tutorial provides different alternatives to implement CodeCarbon in R workflows. The provided code can be adapted and used by R code developers and other R users to test the efficiency and carbon footprint of their code. Existing R packages able to perform the same tasks can be compared in terms of energy consumption, which can be an additional criterion to choose between them. However, it should be kept in mind that energy consumption an carbon footprint are among the many factors to consider when choosing between different packages. For instance, it could be justifiable to use a method that consumes more energy and has a higher carbon footprint if it offers other significant advantages. \n\n\n## References \n---------------\n\n1.  Bates, Douglas, Martin Mächler, Ben Bolker, and Steve Walker. 2015. “Fitting Linear Mixed-Effects Models Using Lme4.” Journal of Statistical Software 67 (1). https://doi.org/10.18637/jss.v067.i01.\n\n2.  Fong, Christian, Chad Hazlett, and Kosuke Imai. 2018. “Covariate Balancing Propensity Score for a Continuous Treatment: Application to the Efficacy of Political Advertisements.” The Annals of Applied Statistics 12 (1). https://doi.org/10.1214/17-aoas1101.\n\n3.  Greifer, Noah. 2017. “WeightIt: Weighting for Covariate Balance in Observational Studies.” The R Foundation. https://doi.org/10.32614/cran.package.weightit.\n\n4.  Pinheiro, José C., and Douglas M. Bates. 2000. Mixed-Effects Models in s and s-PLUS. New York: Springer. https://doi.org/10.1007/b98882."},{"_path":"/modules/software-development-handson/exercises_cicd","_dir":"software-development-handson","_draft":false,"_partial":false,"_locale":"","title":"CI/CD optimization","description":"","type":"exercise","order":4,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"make-your-automated-testing-framework-use-less-energy"},"children":[{"type":"text","value":"Make your automated testing framework use less energy"}]},{"type":"element","tag":"h2","props":{"id":"testing-is-necessary"},"children":[{"type":"text","value":"Testing is necessary"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A robust testing framework is an essential part of good software development practices. It is even more vital in a research environment since wrong or misleading scientific results may be caused by bad or insufficient testing. Automated testing aids in scientific reproducibility and reduces the amount of time wasted trying to go back to find which version still worked with a given feature."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you are unsure about what a testing framework is or how to set one up, you can learn about it in the "},{"type":"element","tag":"a","props":{"href":"exercises_good-practices"},"children":[{"type":"text","value":"Good Practices"}]},{"type":"text","value":" exercises of this hands-on module (specifically, it is "},{"type":"element","tag":"a","props":{"href":"exercises_good-practices#_4-testing"},"children":[{"type":"text","value":"step 4"}]},{"type":"text","value":". Adding tests to your scientific code is a good step towards avoiding wasted energy in the long run."}]},{"type":"element","tag":"h2","props":{"id":"testing-uses-energy"},"children":[{"type":"text","value":"Testing uses energy"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Despite the need for it, testing necessarily uses energy. By adding a testing suite to your software you are making the value judgement that the benefits are worth the additional energy cost of running automatic tests."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"But there are ways to mimimize the amount of energy used.\nThe defaults used by most people when adding automated tests to their code base are often wasteful, due to many tests being run when it is not necessary."}]},{"type":"element","tag":"h2","props":{"id":"reduce-energy-waste-from-unnecessary-testing"},"children":[{"type":"text","value":"Reduce energy waste from unnecessary testing"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In the following we address some relatively simple changes that can be made to reduce the unnecessary running of tests.\nThe solutions are given for projects that use "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pytest"}]},{"type":"text","value":" (the ubiquitous python testing framework) and automation using features of "},{"type":"element","tag":"a","props":{"href":"www.github.com"},"children":[{"type":"text","value":"GitHub"}]},{"type":"text","value":", which is a very common place to host code repositories. However, if you are using a different language (e.g. "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"R"}]},{"type":"text","value":") or you do not use GitHub (maybe GitLab, bitbucket etc) then the general principle should still apply. It may be possible to recreate the same changes by modifying the relevant configuration (we will try to help where we can)."}]},{"type":"element","tag":"h3","props":{"id":"_1-cancel-running-workflows-on-a-new-push"},"children":[{"type":"text","value":"1. Cancel running workflows on a new push"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"By default, it is often the case that currently running tests continue to completion, even if you have pushed new changes to the branch. While that may be desirable in some cases, it is most often not wanted. The user is most interested in whether the newest version of a branch is passing the tests or not."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Luckily, it is possible to "},{"type":"element","tag":"a","props":{"href":"https://docs.github.com/en/enterprise-cloud@latest/actions/writing-workflows/choosing-what-your-workflow-does/control-the-concurrency-of-workflows-and-jobs#example-using-concurrency-and-the-default-behavior","rel":["nofollow"]},"children":[{"type":"text","value":"automatically cancel running tests if new code is pushed to the branch"}]},{"type":"text","value":"."}]},{"type":"element","tag":"h3","props":{"id":"_2-only-re-run-tests-that-failed"},"children":[{"type":"text","value":"2. Only re-run tests that failed"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Use the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pytest --last-failed"}]},{"type":"text","value":" command by exploiting the gh actions cache functionality using a ready-made github action:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"pytest-last-failed: "},{"type":"element","tag":"a","props":{"href":"https://github.com/sjvrijn/pytest-last-failed","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/sjvrijn/pytest-last-failed"}]}]}]},{"type":"element","tag":"h3","props":{"id":"_3-set-the-workflow-trigger-appropriately-for-each-part-of-the-test-framework"},"children":[{"type":"text","value":"3. Set the workflow trigger appropriately for each part of the test framework"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Test workflows are triggered to run when a particular event happens. To avoid tests running unnecessarily, it is important to ensure that this trigger is set correctly."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Certain test workflows do not need to run on every push, for example, and could be configured to only run on merges to the main branch (or on tagging releases)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://docs.github.com/en/actions/writing-workflows/choosing-when-your-workflow-runs/events-that-trigger-workflows","rel":["nofollow"]},"children":[{"type":"text","value":"GitHub docs on triggering workflows"}]}]},{"type":"element","tag":"h3","props":{"id":"_4-test-on-different-platformsversions-that-make-sense"},"children":[{"type":"text","value":"4. Test on different platforms/versions that make sense"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"It is possible to run your automated tests on several platforms (e.g. different versions of Ubuntu, MacOS and Windows) and also on different kinds of software stack (different libraries, "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"python"}]},{"type":"text","value":" versions etc.). On GitHub, for example, this can be done using "},{"type":"element","tag":"a","props":{"href":"https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/running-variations-of-jobs-in-a-workflow","rel":["nofollow"]},"children":[{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"matrix"}]},{"type":"text","value":" strategies"}]},{"type":"text","value":". This is generally desirable, in order to ensure portability across systems."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"However, testing all these combinations comes at a cost. It is important to think about how many users you have (maybe it is just you and some colleagues) and whether what you are testing is actually necessary. For example, supporting every python version from the last 10 years is probably overkill and will waste a lot of energy."}]},{"type":"element","tag":"h3","props":{"id":"_5-create-dependencies-between-tests"},"children":[{"type":"text","value":"5. Create dependencies between tests"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Continuing to run all tests when one has failed does not always make sense. For example, if a basic linting step has failed, it may be desirable not to run the remaining test suite until that is fixed."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"With GitHub actions this is possible by making dependencies between your jobs: "},{"type":"element","tag":"a","props":{"href":"https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/using-jobs-in-a-workflow#example-requiring-successful-dependent-jobs","rel":["nofollow"]},"children":[{"type":"text","value":"see relevant example here"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Alterntively, you may wish to only run the linting tests once the basic tests pass (i.e. no point linting broken code). Which way of adding dependencies is best at reducing unnecessary tests running is dependent on your specific setup."}]},{"type":"element","tag":"h3","props":{"id":"other-toolsplugins-worth-a-look"},"children":[{"type":"text","value":"Other tools/plugins worth a look"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"A possible alternative to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"pytest-last-failed"}]},{"type":"text","value":":"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"pytest-testmon: "},{"type":"element","tag":"a","props":{"href":"https://github.com/tarpas/pytest-testmon","rel":["nofollow"]},"children":[{"type":"text","value":"https://github.com/tarpas/pytest-testmon"}]},{"type":"text","value":", a pytest plugin that only runs tests that concern code that has been affected by changes (interesting but challenging, and possibly unreliable)"}]}]},{"type":"element","tag":"h2","props":{"id":"conclusion"},"children":[{"type":"text","value":"Conclusion"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Testing is essential to reducing waste in research software development, but can cause significant energy consumption itself. This is due to the way most testing frameworks are by default configured to run all of the tests, all of the time. By following some or all of the above changes, you can likely save energy by reducing a lot of pointless tests being run."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"testing-is-necessary","depth":2,"text":"Testing is necessary"},{"id":"testing-uses-energy","depth":2,"text":"Testing uses energy"},{"id":"reduce-energy-waste-from-unnecessary-testing","depth":2,"text":"Reduce energy waste from unnecessary testing","children":[{"id":"_1-cancel-running-workflows-on-a-new-push","depth":3,"text":"1. Cancel running workflows on a new push"},{"id":"_2-only-re-run-tests-that-failed","depth":3,"text":"2. Only re-run tests that failed"},{"id":"_3-set-the-workflow-trigger-appropriately-for-each-part-of-the-test-framework","depth":3,"text":"3. Set the workflow trigger appropriately for each part of the test framework"},{"id":"_4-test-on-different-platformsversions-that-make-sense","depth":3,"text":"4. Test on different platforms/versions that make sense"},{"id":"_5-create-dependencies-between-tests","depth":3,"text":"5. Create dependencies between tests"},{"id":"other-toolsplugins-worth-a-look","depth":3,"text":"Other tools/plugins worth a look"}]},{"id":"conclusion","depth":2,"text":"Conclusion"}]}},"_type":"markdown","_id":"local_fs:modules:software-development-handson:exercises_cicd.md","_source":"local_fs","_file":"modules/software-development-handson/exercises_cicd.md","_stem":"modules/software-development-handson/exercises_cicd","_extension":"md","plainText":"---\ntitle: CI/CD optimization\ntype: exercise\norder: 4\n---\n\n# Make your automated testing framework use less energy\n\n## Testing is necessary\nA robust testing framework is an essential part of good software development practices. It is even more vital in a research environment since wrong or misleading scientific results may be caused by bad or insufficient testing. Automated testing aids in scientific reproducibility and reduces the amount of time wasted trying to go back to find which version still worked with a given feature.\n\nIf you are unsure about what a testing framework is or how to set one up, you can learn about it in the [Good Practices](exercises_good-practices) exercises of this hands-on module (specifically, it is [step 4](exercises_good-practices#_4-testing). Adding tests to your scientific code is a good step towards avoiding wasted energy in the long run.\n\n\n## Testing uses energy\nDespite the need for it, testing necessarily uses energy. By adding a testing suite to your software you are making the value judgement that the benefits are worth the additional energy cost of running automatic tests.\n\nBut there are ways to mimimize the amount of energy used.\nThe defaults used by most people when adding automated tests to their code base are often wasteful, due to many tests being run when it is not necessary.\n\n## Reduce energy waste from unnecessary testing\nIn the following we address some relatively simple changes that can be made to reduce the unnecessary running of tests.\nThe solutions are given for projects that use `pytest` (the ubiquitous python testing framework) and automation using features of [GitHub](www.github.com), which is a very common place to host code repositories. However, if you are using a different language (e.g. `R`) or you do not use GitHub (maybe GitLab, bitbucket etc) then the general principle should still apply. It may be possible to recreate the same changes by modifying the relevant configuration (we will try to help where we can).\n\n### 1. Cancel running workflows on a new push\nBy default, it is often the case that currently running tests continue to completion, even if you have pushed new changes to the branch. While that may be desirable in some cases, it is most often not wanted. The user is most interested in whether the newest version of a branch is passing the tests or not.\n\nLuckily, it is possible to [automatically cancel running tests if new code is pushed to the branch](https://docs.github.com/en/enterprise-cloud@latest/actions/writing-workflows/choosing-what-your-workflow-does/control-the-concurrency-of-workflows-and-jobs#example-using-concurrency-and-the-default-behavior).\n\n### 2. Only re-run tests that failed\nUse the `pytest --last-failed` command by exploiting the gh actions cache functionality using a ready-made github action:\n* pytest-last-failed: <https://github.com/sjvrijn/pytest-last-failed>\n\n### 3. Set the workflow trigger appropriately for each part of the test framework\nTest workflows are triggered to run when a particular event happens. To avoid tests running unnecessarily, it is important to ensure that this trigger is set correctly.\n\nCertain test workflows do not need to run on every push, for example, and could be configured to only run on merges to the main branch (or on tagging releases).\n\n[GitHub docs on triggering workflows](https://docs.github.com/en/actions/writing-workflows/choosing-when-your-workflow-runs/events-that-trigger-workflows)\n\n\n### 4. Test on different platforms/versions that make sense\nIt is possible to run your automated tests on several platforms (e.g. different versions of Ubuntu, MacOS and Windows) and also on different kinds of software stack (different libraries, `python` versions etc.). On GitHub, for example, this can be done using [`matrix` strategies](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/running-variations-of-jobs-in-a-workflow). This is generally desirable, in order to ensure portability across systems.\n\nHowever, testing all these combinations comes at a cost. It is important to think about how many users you have (maybe it is just you and some colleagues) and whether what you are testing is actually necessary. For example, supporting every python version from the last 10 years is probably overkill and will waste a lot of energy.\n\n\n### 5. Create dependencies between tests\n\nContinuing to run all tests when one has failed does not always make sense. For example, if a basic linting step has failed, it may be desirable not to run the remaining test suite until that is fixed.\n\nWith GitHub actions this is possible by making dependencies between your jobs: [see relevant example here](https://docs.github.com/en/actions/writing-workflows/choosing-what-your-workflow-does/using-jobs-in-a-workflow#example-requiring-successful-dependent-jobs).\n\nAlterntively, you may wish to only run the linting tests once the basic tests pass (i.e. no point linting broken code). Which way of adding dependencies is best at reducing unnecessary tests running is dependent on your specific setup.\n\n\n### Other tools/plugins worth a look\n\nA possible alternative to `pytest-last-failed`:\n* pytest-testmon: <https://github.com/tarpas/pytest-testmon>, a pytest plugin that only runs tests that concern code that has been affected by changes (interesting but challenging, and possibly unreliable)\n\n\n## Conclusion\nTesting is essential to reducing waste in research software development, but can cause significant energy consumption itself. This is due to the way most testing frameworks are by default configured to run all of the tests, all of the time. By following some or all of the above changes, you can likely save energy by reducing a lot of pointless tests being run.\n\n"},{"_path":"/modules/software-development-handson/exercises_codecarbon","_dir":"software-development-handson","_draft":false,"_partial":false,"_locale":"","title":"Code Carbon","description":"","type":"exercise","order":5,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"codecarbon"},"children":[{"type":"text","value":"CodeCarbon"}]},{"type":"element","tag":"h2","props":{"id":"introduction"},"children":[{"type":"text","value":"Introduction"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"An important step in trying to improve the energy efficiency of your\nsoftware is to measure the actual energy consumed during the execution\nof your code."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"There are a handful of open-source software packages available online\nto measure the energy consumption of a piece of code, including\n"},{"type":"element","tag":"a","props":{"href":"https://github.com/powerapi-ng/powerapi","rel":["nofollow"]},"children":[{"type":"text","value":"PowerAPI"}]},{"type":"text","value":",\n"},{"type":"element","tag":"a","props":{"href":"https://github.com/energymon/energymon","rel":["nofollow"]},"children":[{"type":"text","value":"EnergyMon"}]},{"type":"text","value":" or\n"},{"type":"element","tag":"a","props":{"href":"https://git.astron.nl/RD/pmt","rel":["nofollow"]},"children":[{"type":"text","value":"PMT"}]},{"type":"text","value":". In this hands-on exercice, we\nwill focus on "},{"type":"element","tag":"a","props":{"href":"https://codecarbon.io/","rel":["nofollow"]},"children":[{"type":"text","value":"CodeCarbon"}]},{"type":"text","value":", a Python package\nreadily available on Linux, Windows and MacOS."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We will start by testing CodeCarbon on a simple example\ncode provided below, then provide guidance on how to test a snippet\nof your own code. For the later, we advise selecting a well-contained, single-purpose\nfunction at first and progressively extend to larger and more complex\nworkflows. The runtime of your selected function/program should be\nof the order of ~10s since CodeCarbon is not designed for high frequency\nmeasurments."}]},{"type":"element","tag":"h3","props":{"id":"prerequisite"},"children":[{"type":"text","value":"Prerequisite"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"a working knowledge of Python. See "},{"type":"element","tag":"a","props":{"href":"https://swcarpentry.github.io/python-novice-inflammation/index.html","rel":["nofollow"]},"children":[{"type":"text","value":"Python Carpentries"}]},{"type":"text","value":" for a quick introduction."}]}]},{"type":"element","tag":"h2","props":{"id":"installing-codecarbon"},"children":[{"type":"text","value":"Installing CodeCarbon"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Code Carbon is written in Python and brings a number of dependencies.\nIt is recommended to setup a dedicated environment using a package\nand environment management tool such as "},{"type":"element","tag":"a","props":{"href":"https://docs.conda.io/projects/conda/en/latest/user-guide/getting-started.html","rel":["nofollow"]},"children":[{"type":"text","value":"Conda"}]},{"type":"text","value":" to avoid disrupting the packages currently available\non your computer. However, this step is not mandatory."}]},{"type":"element","tag":"h3","props":{"id":"on-macos-and-linux"},"children":[{"type":"text","value":"On MacOS and Linux:"}]},{"type":"element","tag":"h4","props":{"id":"using-conda"},"children":[{"type":"text","value":"Using Conda:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Create a new Conda environment:"}]},{"type":"element","tag":"pre","props":{"code":"conda create -n greencomputing python=3.12 \n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"conda create -n greencomputing python=3.12 \n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Activate the new environment:"}]},{"type":"element","tag":"pre","props":{"code":"conda activate greencomputing\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"conda activate greencomputing\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Use the package manager 'pip' to get CodeCarbon (and its dependencies):"}]},{"type":"element","tag":"pre","props":{"code":"pip install codecarbon\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"pip install codecarbon\n"}]}]},{"type":"element","tag":"h4","props":{"id":"without-environment-manager"},"children":[{"type":"text","value":"Without environment manager:"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this case, we assume that Python is already available on your computer."}]},{"type":"element","tag":"pre","props":{"code":"python -m pip install codecarbon\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"python -m pip install codecarbon\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To check that CodeCarbon is effectively installed, try the following command:"}]},{"type":"element","tag":"pre","props":{"code":"python -c \"from codecarbon import OfflineEmissionsTracker; print('SUCCESS')\"\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"python -c \"from codecarbon import OfflineEmissionsTracker; print('SUCCESS')\"\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If CodeCarbon was successfully installed, the command will simply return 'SUCCESS'."}]},{"type":"element","tag":"h3","props":{"id":"on-windows"},"children":[{"type":"text","value":"On Windows"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The above installation instructions should work on Windows if using "},{"type":"element","tag":"a","props":{"href":"https://learn.microsoft.com/en-us/windows/wsl/install","rel":["nofollow"]},"children":[{"type":"text","value":"WSL"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If not, it is generally easiest to install python packages using conda which can be installed according to "},{"type":"element","tag":"a","props":{"href":"https://docs.conda.io/projects/conda/en/latest/user-guide/install/windows.html","rel":["nofollow"]},"children":[{"type":"text","value":"these instructions"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you have another setup or requirements then please ask - we will do our best to help you get set up!"}]},{"type":"element","tag":"h2","props":{"id":"using-codecarbon-a-first-example"},"children":[{"type":"text","value":"Using CodeCarbon: a first example"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The test case consists in computing the Euclidian distance\nbetween all the points contained in a list, where each point is defined by\ntwo coordinates. To illustrate how changes to the code can impact the energy consumption,\ntwo implementations of the computation are provided: a naive version\nrelying on Python's list and a version using Numpy. The code can\nbe obtained "},{"type":"element","tag":"a","props":{"href":"/modules/software-development-handson/media/EuclidianDistance.py","target":"_blank"},"children":[{"type":"text","value":"here"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's now write a small Python driver to execute the computation\nand measure the energy consumption."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We will start by importing the Python modules needed. In a new\npython file (e.g. EDCodeCarbonTest.py), write the following:"}]},{"type":"element","tag":"pre","props":{"code":"import random\nimport numpy as np\nfrom EuclidianDistance import get_distances\nfrom codecarbon import OfflineEmissionsTracker \n","filename":"EDCodeCarbonTest.py","highlights":[4,5,6,7],"language":"python","meta":"meta-info=val","className":["language-python"]},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"import random\nimport numpy as np\nfrom EuclidianDistance import get_distances\nfrom codecarbon import OfflineEmissionsTracker \n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The first two modules are needed in order to generate data. From the\ncode provided above, we will use the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"get_distances"}]},{"type":"text","value":" function, and\nfinally we will use CodeCarbon's "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OfflineEmissionsTracker"}]},{"type":"text","value":".\nNote that CodeCarbon can also be used "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"Online"}]},{"type":"text","value":", allowing live access to\ncarbon intensity data and a dashboard, but the setup is more complicated."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Once the modules are loaded, we can write the main function of our program,\nappending to the file created above:"}]},{"type":"element","tag":"pre","props":{"code":"if __name__ == \"__main__\":\n    # Prepare a list of coordinates\n    # Define the list length\n    n_npts = 20000\n\n    # Get Numpy's random number generator with a fixed seed\n    rng = np.random.default_rng(12345)\n\n    # Populate the list, with coordinates uniformly sampled\n    # in the [0,1] interval.\n    points = []\n    for _ in range(n_npts):\n        points.append((rng.uniform(0.0, 1.0), rng.uniform(0.0, 1.0)))\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"if __name__ == \"__main__\":\n    # Prepare a list of coordinates\n    # Define the list length\n    n_npts = 20000\n\n    # Get Numpy's random number generator with a fixed seed\n    rng = np.random.default_rng(12345)\n\n    # Populate the list, with coordinates uniformly sampled\n    # in the [0,1] interval.\n    points = []\n    for _ in range(n_npts):\n        points.append((rng.uniform(0.0, 1.0), rng.uniform(0.0, 1.0)))\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"We now have a list of points to pass to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"get_distances"}]},{"type":"text","value":" function.\nBut we first need to initialize CodeCarbon emission tracker. In this example,\nwe will use a context manager such as:"}]},{"type":"element","tag":"pre","props":{"code":"    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:\n        >> compute intensive code ...\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:\n        >> compute intensive code ...\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"where the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tracker"}]},{"type":"text","value":" will directly start and report energy consumption as\nwe execute the code. There are numerous runtime options available when\ninitializing the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OfflineEmissionsTracker"}]},{"type":"text","value":", refers to CodeCarbon\n"},{"type":"element","tag":"a","props":{"href":"https://mlco2.github.io/codecarbon/parameters.html","rel":["nofollow"]},"children":[{"type":"text","value":"documentation"}]},{"type":"text","value":" for a complete\noverview. In the example above we only provided the Netherlands ISO 3 letters code,\nand the interval (in seconds) to measure hardware power usage.\nLet's now add our actual computation in the code as follows:"}]},{"type":"element","tag":"pre","props":{"code":"    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:\n        get_distances(points, \"base\")\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:\n        get_distances(points, \"base\")\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"where we use the base implementation of the Euclidean distance calculation. It is now\ntime to run the program."}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[],"style":"color: darkred;"},"children":[{"type":"text","value":"Note"}]},{"type":"text","value":": On MacOS, CodeCarbon relies on PowerMetrics to access hardware power data, thus requiring root/sudo access. You will be prompted for your login password"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The actual output of running the Python program will depend on your platform and hardware,\nbut it will resemble the following (here on MacOS):"}]},{"type":"element","tag":"pre","props":{"code":"[...] [setup] RAM Tracking...\n[...] [setup] GPU Tracking...\n[...] No GPU found.\n[...] [setup] CPU Tracking...\n[...] Tracking Apple CPU and GPU via PowerMetrics\n[...] >>> Tracker's metadata:\n[...]   Platform system: macOS-14.6.1-arm64-arm-64bit\n[...]   Python version: 3.12.7\n[...]   CodeCarbon version: 2.7.1\n[...]   Available RAM : 24.000 GB\n[...]   CPU count: 8\n[...]   CPU model: Apple M2\n[...]   GPU count: 1\n[...]   GPU model: Apple M2\n[...] Saving emissions data to file ./NLeSC/Training/CodeCarbon/emissions.csv\n[...] Energy consumed for RAM : 0.000013 kWh. RAM Power : 9.000000000000002 W\n[...] Energy consumed for all CPUs : 0.000010 kWh. Total CPU Power : 7.500399999999999 W\n[...] Energy consumed for all GPUs : 0.000000 kWh. Total GPU Power : 0.001 W\n[...] Energy consumed for RAM : 0.000038 kWh. RAM Power : 9.000000000000002 W\n[...] 0.000048 kWh of electricity used since the beginning.\n[...] Energy consumed for all CPUs : 0.000033 kWh. Total CPU Power : 8.2367 W\n[...] Energy consumed for all GPUs : 0.000000 kWh. Total GPU Power : 0.002 W\n[...] Energy consumed for RAM : 0.000048 kWh. RAM Power : 9.000000000000002 W\n[...] ...\n[...] 0.000321 kWh of electricity used since the beginning.\n[...] 0.000890 g.CO2eq/s mean an estimation of 28.064960638276645 kg.CO2eq/year\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"[...] [setup] RAM Tracking...\n[...] [setup] GPU Tracking...\n[...] No GPU found.\n[...] [setup] CPU Tracking...\n[...] Tracking Apple CPU and GPU via PowerMetrics\n[...] >>> Tracker's metadata:\n[...]   Platform system: macOS-14.6.1-arm64-arm-64bit\n[...]   Python version: 3.12.7\n[...]   CodeCarbon version: 2.7.1\n[...]   Available RAM : 24.000 GB\n[...]   CPU count: 8\n[...]   CPU model: Apple M2\n[...]   GPU count: 1\n[...]   GPU model: Apple M2\n[...] Saving emissions data to file ./NLeSC/Training/CodeCarbon/emissions.csv\n[...] Energy consumed for RAM : 0.000013 kWh. RAM Power : 9.000000000000002 W\n[...] Energy consumed for all CPUs : 0.000010 kWh. Total CPU Power : 7.500399999999999 W\n[...] Energy consumed for all GPUs : 0.000000 kWh. Total GPU Power : 0.001 W\n[...] Energy consumed for RAM : 0.000038 kWh. RAM Power : 9.000000000000002 W\n[...] 0.000048 kWh of electricity used since the beginning.\n[...] Energy consumed for all CPUs : 0.000033 kWh. Total CPU Power : 8.2367 W\n[...] Energy consumed for all GPUs : 0.000000 kWh. Total GPU Power : 0.002 W\n[...] Energy consumed for RAM : 0.000048 kWh. RAM Power : 9.000000000000002 W\n[...] ...\n[...] 0.000321 kWh of electricity used since the beginning.\n[...] 0.000890 g.CO2eq/s mean an estimation of 28.064960638276645 kg.CO2eq/year\n"}]}]},{"type":"element","tag":"blockquote","props":{},"children":[{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"code","props":{"className":[],"style":"color: darkred;"},"children":[{"type":"text","value":"Note"}]},{"type":"text","value":": If the CPU on your system is not recognized by CodeCarbon, a default CPU will be used but the code will issue Warnings."}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"At time interval specified when initializing the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OfflineEmissionsTracker"}]},{"type":"text","value":", power and energy\nare reported for the various hardware. Based on the country code provided, an estimate of\nthe CO2eq emission rate is also reported at the end. As you can see, a constant 9W power is used for the RAM here, whereas\nsmall fluctuations are observed on the CPU side. Even though the RAM and CPU are shared with other programs running\non your computer, CodeCarbon assign their full usage to the measured code. A more accurate measurement of the specific\nprocess CPU usage can be obtained by providing an extra argument to the tracker initialization, "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tracking_mode = \"process\""}]},{"type":"text","value":".\nHowever, this method does not provide a good measurement of the memory power."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Let's now switch to the Numpy version of program by updating the call to the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"get_distances"}]},{"type":"text","value":" function:"}]},{"type":"element","tag":"pre","props":{"code":"        get_distances(points, \"numpy\")\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"        get_distances(points, \"numpy\")\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"And re-run the program. The measured energy consumption for thid case is 0.000194 kWh, for an estimated\nemission rate of 0.000538 g.CO2eq/s.\nThis small example demonstrate how by relying on a more efficient implementation, the energy consumption and associated\nemissions can be reduced, mostly due to a shorter runtime. Feel free to experiment with the following:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"changing problem size"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"update the parameters of the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"OfflineEmissionsTracker"}]},{"type":"text","value":", changing the country code for instance"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"try an alternative implementation of the distance computation"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"add timers to the script to estimate if the average power, is it changing between the two provided implementation ?"}]}]},{"type":"element","tag":"h2","props":{"id":"using-codecarbon-your-own-code"},"children":[{"type":"text","value":"Using CodeCarbon: your own code"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If your target code is based on Python, the simplest way to adapt the small example provided above to\nyour case is wrap your entire program into a single function call and replace the "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"get_distances"}]},{"type":"text","value":" function\nby your own."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"An alternate solution, applicable to softwares written in other programming language such as R or C++, is to\nrely on Python subprocess. In the following, let's assume that you have an executable R file (i.e.\nwith "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"#! /usr/bin/Rscript"}]},{"type":"text","value":" on the first line)."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Create a new python file (e.g. CodeCarbonWrap.py), with the following imports:"}]},{"type":"element","tag":"pre","props":{"code":"import subprocess\nfrom codecarbon import OfflineEmissionsTracker\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"import subprocess\nfrom codecarbon import OfflineEmissionsTracker\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"and the following main function:"}]},{"type":"element","tag":"pre","props":{"code":"if __name__ == \"__main__\":\n    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:                                                                                 \n        subprocess.call ([\"/usr/bin/Rscript\", \"--vanilla\", \"/pathto/MyrScript.r\"])\n"},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"if __name__ == \"__main__\":\n    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:                                                                                 \n        subprocess.call ([\"/usr/bin/Rscript\", \"--vanilla\", \"/pathto/MyrScript.r\"])\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Note that because the script R script is executed in an external process, the option "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"tracking_mode = \"process\""}]},{"type":"text","value":"\nis no longer adapted and only the mode where the CPU usage of the entire computer is measured is relevant. You\nshould thus be aware of the other programs running on your computer (e.g. a web brower with video streaming) as their\nCPU usage will be measured as well, and for more accurate measurements those programs should be terminated."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For a full tutorial of the use of CodeCarbon in R workflows, please refer to the next lesson."}]},{"type":"element","tag":"h2","props":{"id":"conclusion"},"children":[{"type":"text","value":"Conclusion"}]},{"type":"element","tag":"hr","props":{},"children":[]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this short tutorial, you have tested first-hand how to measure the energy consumption of a piece of code\nusing "},{"type":"element","tag":"a","props":{"href":"https://codecarbon.io/","rel":["nofollow"]},"children":[{"type":"text","value":"CodeCarbon"}]},{"type":"text","value":". CodeCarbon can be deployed on larger application as well as\non HPC platforms.\nAlthough written in Python, CodeCarbon can be used for any other languages as long as you are able to use\nPython subprocess to execute the external program (i.e. R, C++, Fortran, ...)."}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"introduction","depth":2,"text":"Introduction","children":[{"id":"prerequisite","depth":3,"text":"Prerequisite"}]},{"id":"installing-codecarbon","depth":2,"text":"Installing CodeCarbon","children":[{"id":"on-macos-and-linux","depth":3,"text":"On MacOS and Linux:"},{"id":"on-windows","depth":3,"text":"On Windows"}]},{"id":"using-codecarbon-a-first-example","depth":2,"text":"Using CodeCarbon: a first example"},{"id":"using-codecarbon-your-own-code","depth":2,"text":"Using CodeCarbon: your own code"},{"id":"conclusion","depth":2,"text":"Conclusion"}]}},"_type":"markdown","_id":"local_fs:modules:software-development-handson:exercises_codecarbon.md","_source":"local_fs","_file":"modules/software-development-handson/exercises_codecarbon.md","_stem":"modules/software-development-handson/exercises_codecarbon","_extension":"md","plainText":"---\ntitle: \"Code Carbon\"\ntype: exercise\norder: 5\n---\n\n# CodeCarbon\n\n## Introduction\n---------------\n\nAn important step in trying to improve the energy efficiency of your\nsoftware is to measure the actual energy consumed during the execution\nof your code.\n\nThere are a handful of open-source software packages available online\nto measure the energy consumption of a piece of code, including \n[PowerAPI](https://github.com/powerapi-ng/powerapi),\n[EnergyMon](https://github.com/energymon/energymon) or\n[PMT](https://git.astron.nl/RD/pmt). In this hands-on exercice, we \nwill focus on [CodeCarbon](https://codecarbon.io/), a Python package\nreadily available on Linux, Windows and MacOS.\n\nWe will start by testing CodeCarbon on a simple example\ncode provided below, then provide guidance on how to test a snippet\nof your own code. For the later, we advise selecting a well-contained, single-purpose\nfunction at first and progressively extend to larger and more complex\nworkflows. The runtime of your selected function/program should be\nof the order of ~10s since CodeCarbon is not designed for high frequency\nmeasurments.\n\n### Prerequisite\n\n - a working knowledge of Python. See [Python Carpentries](https://swcarpentry.github.io/python-novice-inflammation/index.html) for a quick introduction.\n\n## Installing CodeCarbon\n------------------------\n\nCode Carbon is written in Python and brings a number of dependencies.\nIt is recommended to setup a dedicated environment using a package\nand environment management tool such as [Conda](https://docs.conda.io/projects/conda/en/latest/user-guide/getting-started.html) to avoid disrupting the packages currently available\non your computer. However, this step is not mandatory.\n\n### On MacOS and Linux:\n\n#### Using Conda:\n\nCreate a new Conda environment:\n```\nconda create -n greencomputing python=3.12 \n```\n\nActivate the new environment:\n```\nconda activate greencomputing\n```\n\nUse the package manager 'pip' to get CodeCarbon (and its dependencies):\n```\npip install codecarbon\n```\n\n#### Without environment manager:\n\nIn this case, we assume that Python is already available on your computer.\n```\npython -m pip install codecarbon\n```\n\nTo check that CodeCarbon is effectively installed, try the following command:\n```\npython -c \"from codecarbon import OfflineEmissionsTracker; print('SUCCESS')\"\n```\nIf CodeCarbon was successfully installed, the command will simply return 'SUCCESS'.\n\n\n### On Windows\n\nThe above installation instructions should work on Windows if using [WSL](https://learn.microsoft.com/en-us/windows/wsl/install).\n\nIf not, it is generally easiest to install python packages using conda which can be installed according to [these instructions](https://docs.conda.io/projects/conda/en/latest/user-guide/install/windows.html).\n\nIf you have another setup or requirements then please ask - we will do our best to help you get set up!\n\n\n## Using CodeCarbon: a first example\n------------------------------------\n\nThe test case consists in computing the Euclidian distance\nbetween all the points contained in a list, where each point is defined by\ntwo coordinates. To illustrate how changes to the code can impact the energy consumption,\ntwo implementations of the computation are provided: a naive version\nrelying on Python's list and a version using Numpy. The code can\nbe obtained [here](media/EuclidianDistance.py).\n\nLet's now write a small Python driver to execute the computation\nand measure the energy consumption.\n\nWe will start by importing the Python modules needed. In a new\npython file (e.g. EDCodeCarbonTest.py), write the following:\n```python [EDCodeCarbonTest.py]{4-6,7} meta-info=val\nimport random\nimport numpy as np\nfrom EuclidianDistance import get_distances\nfrom codecarbon import OfflineEmissionsTracker \n```\n\nThe first two modules are needed in order to generate data. From the\ncode provided above, we will use the ```get_distances``` function, and\nfinally we will use CodeCarbon's ```OfflineEmissionsTracker```.\nNote that CodeCarbon can also be used ```Online```, allowing live access to\ncarbon intensity data and a dashboard, but the setup is more complicated.\n\nOnce the modules are loaded, we can write the main function of our program,\nappending to the file created above:\n```\nif __name__ == \"__main__\":\n    # Prepare a list of coordinates\n    # Define the list length\n    n_npts = 20000\n\n    # Get Numpy's random number generator with a fixed seed\n    rng = np.random.default_rng(12345)\n\n    # Populate the list, with coordinates uniformly sampled\n    # in the [0,1] interval.\n    points = []\n    for _ in range(n_npts):\n        points.append((rng.uniform(0.0, 1.0), rng.uniform(0.0, 1.0)))\n```\n\nWe now have a list of points to pass to the ```get_distances``` function.\nBut we first need to initialize CodeCarbon emission tracker. In this example,\nwe will use a context manager such as:\n```\n    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:\n        >> compute intensive code ...\n```\nwhere the ```tracker``` will directly start and report energy consumption as\nwe execute the code. There are numerous runtime options available when\ninitializing the ```OfflineEmissionsTracker```, refers to CodeCarbon\n[documentation](https://mlco2.github.io/codecarbon/parameters.html) for a complete\noverview. In the example above we only provided the Netherlands ISO 3 letters code,\nand the interval (in seconds) to measure hardware power usage.\nLet's now add our actual computation in the code as follows:\n```\n    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:\n        get_distances(points, \"base\")\n```\nwhere we use the base implementation of the Euclidean distance calculation. It is now\ntime to run the program.\n\n> `Note`{style=\"color: darkred;\"}: On MacOS, CodeCarbon relies on PowerMetrics to access hardware power data, thus requiring root/sudo access. You will be prompted for your login password\n\n\nThe actual output of running the Python program will depend on your platform and hardware,\nbut it will resemble the following (here on MacOS):\n```\n[...] [setup] RAM Tracking...\n[...] [setup] GPU Tracking...\n[...] No GPU found.\n[...] [setup] CPU Tracking...\n[...] Tracking Apple CPU and GPU via PowerMetrics\n[...] >>> Tracker's metadata:\n[...]   Platform system: macOS-14.6.1-arm64-arm-64bit\n[...]   Python version: 3.12.7\n[...]   CodeCarbon version: 2.7.1\n[...]   Available RAM : 24.000 GB\n[...]   CPU count: 8\n[...]   CPU model: Apple M2\n[...]   GPU count: 1\n[...]   GPU model: Apple M2\n[...] Saving emissions data to file ./NLeSC/Training/CodeCarbon/emissions.csv\n[...] Energy consumed for RAM : 0.000013 kWh. RAM Power : 9.000000000000002 W\n[...] Energy consumed for all CPUs : 0.000010 kWh. Total CPU Power : 7.500399999999999 W\n[...] Energy consumed for all GPUs : 0.000000 kWh. Total GPU Power : 0.001 W\n[...] Energy consumed for RAM : 0.000038 kWh. RAM Power : 9.000000000000002 W\n[...] 0.000048 kWh of electricity used since the beginning.\n[...] Energy consumed for all CPUs : 0.000033 kWh. Total CPU Power : 8.2367 W\n[...] Energy consumed for all GPUs : 0.000000 kWh. Total GPU Power : 0.002 W\n[...] Energy consumed for RAM : 0.000048 kWh. RAM Power : 9.000000000000002 W\n[...] ...\n[...] 0.000321 kWh of electricity used since the beginning.\n[...] 0.000890 g.CO2eq/s mean an estimation of 28.064960638276645 kg.CO2eq/year\n```\n\n> `Note`{style=\"color: darkred;\"}: If the CPU on your system is not recognized by CodeCarbon, a default CPU will be used but the code will issue Warnings.\n\nAt time interval specified when initializing the ```OfflineEmissionsTracker```, power and energy\nare reported for the various hardware. Based on the country code provided, an estimate of\nthe CO2eq emission rate is also reported at the end. As you can see, a constant 9W power is used for the RAM here, whereas\nsmall fluctuations are observed on the CPU side. Even though the RAM and CPU are shared with other programs running\non your computer, CodeCarbon assign their full usage to the measured code. A more accurate measurement of the specific\nprocess CPU usage can be obtained by providing an extra argument to the tracker initialization, ```tracking_mode = \"process\"```.\nHowever, this method does not provide a good measurement of the memory power.\n\nLet's now switch to the Numpy version of program by updating the call to the ```get_distances``` function:\n```\n        get_distances(points, \"numpy\")\n```\nAnd re-run the program. The measured energy consumption for thid case is 0.000194 kWh, for an estimated\nemission rate of 0.000538 g.CO2eq/s.\nThis small example demonstrate how by relying on a more efficient implementation, the energy consumption and associated\nemissions can be reduced, mostly due to a shorter runtime. Feel free to experiment with the following:\n - changing problem size\n - update the parameters of the ```OfflineEmissionsTracker```, changing the country code for instance\n - try an alternative implementation of the distance computation\n - add timers to the script to estimate if the average power, is it changing between the two provided implementation ?\n\n## Using CodeCarbon: your own code\n----------------------------------\nIf your target code is based on Python, the simplest way to adapt the small example provided above to\nyour case is wrap your entire program into a single function call and replace the ```get_distances``` function\nby your own.\n\nAn alternate solution, applicable to softwares written in other programming language such as R or C++, is to\nrely on Python subprocess. In the following, let's assume that you have an executable R file (i.e.\nwith ```#! /usr/bin/Rscript``` on the first line).\n\nCreate a new python file (e.g. CodeCarbonWrap.py), with the following imports:\n```\nimport subprocess\nfrom codecarbon import OfflineEmissionsTracker\n```\nand the following main function:\n\n```\nif __name__ == \"__main__\":\n    with OfflineEmissionsTracker(country_iso_code=\"NLD\",\n                                 measure_power_secs=5) as tracker:                                                                                 \n        subprocess.call ([\"/usr/bin/Rscript\", \"--vanilla\", \"/pathto/MyrScript.r\"])\n```\nNote that because the script R script is executed in an external process, the option ```tracking_mode = \"process\"```\nis no longer adapted and only the mode where the CPU usage of the entire computer is measured is relevant. You\nshould thus be aware of the other programs running on your computer (e.g. a web brower with video streaming) as their\nCPU usage will be measured as well, and for more accurate measurements those programs should be terminated.\n\nFor a full tutorial of the use of CodeCarbon in R workflows, please refer to the next lesson.\n\n## Conclusion\n-------------\n\nIn this short tutorial, you have tested first-hand how to measure the energy consumption of a piece of code\nusing [CodeCarbon](https://codecarbon.io/). CodeCarbon can be deployed on larger application as well as\non HPC platforms.\nAlthough written in Python, CodeCarbon can be used for any other languages as long as you are able to use\nPython subprocess to execute the external program (i.e. R, C++, Fortran, ...).\n"},{"_path":"/modules/software-development-handson/exercises_good-practices","_dir":"software-development-handson","_draft":false,"_partial":false,"_locale":"","title":"Good Practices","description":"Good practices in software engineering are essential to reduce energy usage. Without proper (automated) testing, documentation and sharing, resources are wasted constantly.","type":"exercise","order":3,"body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"good-practices-will-save-the-earth"},"children":[{"type":"text","value":"Good practices will save the earth!"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Good practices in software engineering are essential to reduce energy usage. Without proper (automated) testing, documentation and sharing, resources are wasted constantly."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Examples are:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"running (and failing) untested or badly tested workflows in high-resource jobs"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"having to redo a lot of work because things are lost as they were not stored/versioned properly"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"having to redo someone elses work because it was not properly published or licensed"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://coderefinery.org/","rel":["nofollow"]},"children":[{"type":"text","value":"CodeRefinery"}]},{"type":"text","value":" is a very good resource for learning best practices in programming and data management for research software. Their "},{"type":"element","tag":"a","props":{"href":"https://coderefinery.org/lessons/","rel":["nofollow"]},"children":[{"type":"text","value":"full blown course"}]},{"type":"text","value":" lasts 6 days and goes fairly deep into the most important aspects of software development."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The "},{"type":"element","tag":"a","props":{"href":"https://coderefinery.github.io/research-software-engineering/","rel":["nofollow"]},"children":[{"type":"text","value":"“CodeRefinery in 1 hour” course"}]},{"type":"text","value":" condenses most of the materials in a 1 hours crash-course. For this exercise we will follow the contents of this crash course. Below you will find the links to the six course chapters on various of research software development."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Besides the links to the coderefinery course, in each of the sections below you will also find links to corresponding modules in the "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/research-software-support/","rel":["nofollow"]},"children":[{"type":"text","value":"Research Software Support platform."}]},{"type":"text","value":". These materials are less hands-on because they are made for research supporters, however they often give you a nice conceptual overview of the concepts. You can regard these as optional additional materials."}]},{"type":"element","tag":"h2","props":{"id":"_0-example-project"},"children":[{"type":"text","value":"0. Example project"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The course starts with introducing an example project that will be used throughout the course."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"You can also choose to follow the exercises using your own software project, in that case start with "},{"type":"element","tag":"a","props":{"href":"#_1-version-control-and-code-review"},"children":[{"type":"text","value":"step 1"}]},{"type":"text","value":". Throughout the exercises, the example project will be used, we trust you can translate the steps to your own project. If you notice that this doesn't work for you, try using the example project."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"If you want to use the example project, follow the link below and read up on simulating the motion of planets.\n"},{"type":"element","tag":"a","props":{"href":"https://coderefinery.github.io/research-software-engineering/example/","rel":["nofollow"]},"children":[{"type":"text","value":"Example project: simulating the motion of planets"}]}]},{"type":"element","tag":"h2","props":{"id":"_1-version-control-and-code-review"},"children":[{"type":"text","value":"1. Version control and code review"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Follow the materials and exercises from coderefinery about\n"},{"type":"element","tag":"a","props":{"href":"https://coderefinery.github.io/research-software-engineering/version-control/","rel":["nofollow"]},"children":[{"type":"text","value":"version control and code review"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additional Research Software Support materials on "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/research-software-support/modules/version-control/info","rel":["nofollow"]},"children":[{"type":"text","value":"software version control"}]}]},{"type":"element","tag":"h2","props":{"id":"_2-documentation"},"children":[{"type":"text","value":"2. Documentation"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Follow the materials and exercises from coderefinery about "},{"type":"element","tag":"a","props":{"href":"https://coderefinery.github.io/research-software-engineering/documentation/","rel":["nofollow"]},"children":[{"type":"text","value":"documentation"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additional Research Software Support materials on "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/research-software-support/modules/documentation/info","rel":["nofollow"]},"children":[{"type":"text","value":"documentation"}]}]},{"type":"element","tag":"h2","props":{"id":"_3-reproducible-dependencies-and-environments"},"children":[{"type":"text","value":"3. Reproducible dependencies and environments"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Follow the materials and exercises from coderefinery about "},{"type":"element","tag":"a","props":{"href":"https://coderefinery.github.io/research-software-engineering/reproducibility/","rel":["nofollow"]},"children":[{"type":"text","value":"reproducible dependencies and environments"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additional Research Software Support materials on "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/research-software-support/modules/distributing/info","rel":["nofollow"]},"children":[{"type":"text","value":"distributing software"}]}]},{"type":"element","tag":"h2","props":{"id":"_4-testing"},"children":[{"type":"text","value":"4. Testing"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Follow the materials and exercises from coderefinery about "},{"type":"element","tag":"a","props":{"href":"https://coderefinery.github.io/research-software-engineering/testing/","rel":["nofollow"]},"children":[{"type":"text","value":"Testing"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additional Research Software Support materials on "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/research-software-support/modules/testing/info","rel":["nofollow"]},"children":[{"type":"text","value":"testing"}]}]},{"type":"element","tag":"h2","props":{"id":"_5-automation-and-reproducible-workflows"},"children":[{"type":"text","value":"5. Automation and reproducible workflows"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Follow the materials and exercises from coderefinery about "},{"type":"element","tag":"a","props":{"href":"https://coderefinery.github.io/research-software-engineering/automation/","rel":["nofollow"]},"children":[{"type":"text","value":"Automation and reproducible workflows"}]}]},{"type":"element","tag":"h2","props":{"id":"_6-sharing-licensing-and-publishing"},"children":[{"type":"text","value":"6. Sharing (licensing and publishing)"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Follow the materials and exercises from coderefinery about "},{"type":"element","tag":"a","props":{"href":"https://coderefinery.github.io/research-software-engineering/sharing/","rel":["nofollow"]},"children":[{"type":"text","value":"Sharing (licensing and publishing)"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Additional Research Software Support materials on "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/research-software-support/modules/licenses/info","rel":["nofollow"]},"children":[{"type":"text","value":"licenses"}]},{"type":"text","value":", "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/research-software-support/modules/publication/info","rel":["nofollow"]},"children":[{"type":"text","value":"publication"}]},{"type":"text","value":" and "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/research-software-support/modules/citation/info","rel":["nofollow"]},"children":[{"type":"text","value":"citation"}]},{"type":"text","value":","}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"_0-example-project","depth":2,"text":"0. Example project"},{"id":"_1-version-control-and-code-review","depth":2,"text":"1. Version control and code review"},{"id":"_2-documentation","depth":2,"text":"2. Documentation"},{"id":"_3-reproducible-dependencies-and-environments","depth":2,"text":"3. Reproducible dependencies and environments"},{"id":"_4-testing","depth":2,"text":"4. Testing"},{"id":"_5-automation-and-reproducible-workflows","depth":2,"text":"5. Automation and reproducible workflows"},{"id":"_6-sharing-licensing-and-publishing","depth":2,"text":"6. Sharing (licensing and publishing)"}]}},"_type":"markdown","_id":"local_fs:modules:software-development-handson:exercises_good-practices.md","_source":"local_fs","_file":"modules/software-development-handson/exercises_good-practices.md","_stem":"modules/software-development-handson/exercises_good-practices","_extension":"md","plainText":"---\ntitle: Good Practices\ntype: exercise\norder: 3\n---\n\n# Good practices will save the earth!\n\nGood practices in software engineering are essential to reduce energy usage. Without proper (automated) testing, documentation and sharing, resources are wasted constantly. \n\nExamples are:\n- running (and failing) untested or badly tested workflows in high-resource jobs\n- having to redo a lot of work because things are lost as they were not stored/versioned properly\n- having to redo someone elses work because it was not properly published or licensed\n\n[CodeRefinery](https://coderefinery.org/) is a very good resource for learning best practices in programming and data management for research software. Their [full blown course](https://coderefinery.org/lessons/) lasts 6 days and goes fairly deep into the most important aspects of software development. \n\nThe [“CodeRefinery in 1 hour” course](https://coderefinery.github.io/research-software-engineering/) condenses most of the materials in a 1 hours crash-course. For this exercise we will follow the contents of this crash course. Below you will find the links to the six course chapters on various of research software development. \n\nBesides the links to the coderefinery course, in each of the sections below you will also find links to corresponding modules in the [Research Software Support platform.](https://esciencecenter-digital-skills.github.io/research-software-support/). These materials are less hands-on because they are made for research supporters, however they often give you a nice conceptual overview of the concepts. You can regard these as optional additional materials. \n\n## 0. Example project\n\nThe course starts with introducing an example project that will be used throughout the course. \n\nYou can also choose to follow the exercises using your own software project, in that case start with [step 1](#_1-version-control-and-code-review). Throughout the exercises, the example project will be used, we trust you can translate the steps to your own project. If you notice that this doesn't work for you, try using the example project.\n\nIf you want to use the example project, follow the link below and read up on simulating the motion of planets. \n[Example project: simulating the motion of planets](https://coderefinery.github.io/research-software-engineering/example/)\n\n## 1. Version control and code review\n\nFollow the materials and exercises from coderefinery about \n[version control and code review](https://coderefinery.github.io/research-software-engineering/version-control/).\n\nAdditional Research Software Support materials on [software version control](https://esciencecenter-digital-skills.github.io/research-software-support/modules/version-control/info)\n\n## 2. Documentation\n\nFollow the materials and exercises from coderefinery about [documentation](https://coderefinery.github.io/research-software-engineering/documentation/).\n\nAdditional Research Software Support materials on [documentation](https://esciencecenter-digital-skills.github.io/research-software-support/modules/documentation/info)\n\n\n## 3. Reproducible dependencies and environments\n\nFollow the materials and exercises from coderefinery about [reproducible dependencies and environments](https://coderefinery.github.io/research-software-engineering/reproducibility/)\n\nAdditional Research Software Support materials on [distributing software](https://esciencecenter-digital-skills.github.io/research-software-support/modules/distributing/info)\n\n\n## 4. Testing\nFollow the materials and exercises from coderefinery about [Testing](https://coderefinery.github.io/research-software-engineering/testing/)\n\nAdditional Research Software Support materials on [testing](https://esciencecenter-digital-skills.github.io/research-software-support/modules/testing/info)\n\n\n## 5. Automation and reproducible workflows\n\nFollow the materials and exercises from coderefinery about [Automation and reproducible workflows](https://coderefinery.github.io/research-software-engineering/automation/)\n\n## 6. Sharing (licensing and publishing)\n\nFollow the materials and exercises from coderefinery about [Sharing (licensing and publishing)](https://coderefinery.github.io/research-software-engineering/sharing/)\n\nAdditional Research Software Support materials on [licenses](https://esciencecenter-digital-skills.github.io/research-software-support/modules/licenses/info), [publication](https://esciencecenter-digital-skills.github.io/research-software-support/modules/publication/info) and [citation](https://esciencecenter-digital-skills.github.io/research-software-support/modules/citation/info), \n"},{"_path":"/modules/software-development-handson/further_reading_module1","_dir":"software-development-handson","_draft":false,"_partial":false,"_locale":"","title":"Extra material","description":"","type":"reading","order":6,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"courses-in-green-computing-that-could-be-of-interest"},"children":[{"type":"text","value":"Courses in \"Green\" computing that could be of interest"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://research.vu.nl/en/courses/green-lab-4","rel":["nofollow"]},"children":[{"type":"text","value":"https://research.vu.nl/en/courses/green-lab-4"}]}]},{"type":"element","tag":"li","props":{},"children":[{"type":"element","tag":"a","props":{"href":"https://training.linuxfoundation.org/training/green-software-for-practitioners-lfc131/","rel":["nofollow"]},"children":[{"type":"text","value":"https://training.linuxfoundation.org/training/green-software-for-practitioners-lfc131/"}]}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"courses-in-green-computing-that-could-be-of-interest","depth":2,"text":"Courses in \"Green\" computing that could be of interest"}]}},"_type":"markdown","_id":"local_fs:modules:software-development-handson:further_reading_module1.md","_source":"local_fs","_file":"modules/software-development-handson/further_reading_module1.md","_stem":"modules/software-development-handson/further_reading_module1","_extension":"md","plainText":"---\ntitle: Extra material\ntype: reading\norder: 6\n---\n\n## Courses in \"Green\" computing that could be of interest\n* <https://research.vu.nl/en/courses/green-lab-4>\n* <https://training.linuxfoundation.org/training/green-software-for-practitioners-lfc131/>\n"},{"_path":"/modules/software-development-handson","_dir":"modules","_draft":false,"_partial":false,"_locale":"","title":"Software Development","description":"","order":2,"category":"Workshop","author":"eScience Center","thumbnail":"software-development-thumbnail.avif","abstract":"Learn best practices in software development to reduce energy consumption and how to profile energy usage.","visibility":"visible","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"category-1"},"children":[{"type":"text","value":"Category 1"}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[]}},"_type":"markdown","_id":"local_fs:modules:software-development-handson:index.md","_source":"local_fs","_file":"modules/software-development-handson/index.md","_stem":"modules/software-development-handson/index","_extension":"md","plainText":"---\norder: 2\ncategory: Workshop\ntitle: Software Development\nauthor: eScience Center\nthumbnail: \"software-development-thumbnail.avif\"\nabstract: Learn best practices in software development to reduce energy consumption and how to profile energy usage. \nvisibility: visible\n---\n\n# Category 1\n"},{"_path":"/modules/software-development-handson/info","_dir":"software-development-handson","_draft":false,"_partial":false,"_locale":"","title":"Learning objectives","description":"","type":"info","order":0,"body":{"type":"root","children":[{"type":"element","tag":"h2","props":{"id":"learning-objectives"},"children":[{"type":"text","value":"Learning Objectives"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"In this module you will learn to answer the following questions:"}]},{"type":"element","tag":"ul","props":{},"children":[{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How do I set up or adapt my continuous integration and deployment system to minimize energy usage?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What are good triggers and intervals to run my various types of tests?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How do I measure the energy performance of particular areas of my code?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"How do I decide which areas are suitable to be improved?"}]},{"type":"element","tag":"li","props":{},"children":[{"type":"text","value":"What changes can I make to improve the energy efficiency of my code?"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"learning-objectives","depth":2,"text":"Learning Objectives"}]}},"_type":"markdown","_id":"local_fs:modules:software-development-handson:info.md","_source":"local_fs","_file":"modules/software-development-handson/info.md","_stem":"modules/software-development-handson/info","_extension":"md","plainText":"---\ntitle: Learning objectives\ntype: info\norder: 0\n---\n\n## Learning Objectives\n\nIn this module you will learn to answer the following questions:\n\n* How do I set up or adapt my continuous integration and deployment system to minimize energy usage?\n* What are good triggers and intervals to run my various types of tests? \n* How do I measure the energy performance of particular areas of my code?\n* How do I decide which areas are suitable to be improved?\n* What changes can I make to improve the energy efficiency of my code?\n"},{"_path":"/readme","_dir":"","_draft":false,"_partial":false,"_locale":"","title":"Green Digital Skills","description":"This repository contains the contents for the Green Digital Skills lesson material. This is intended to raise awareness of environmental issues relating to research computing, providing some best practices in green coding and exploring a range of solutions to profile and reduce energy usage for different kinds of common workflows.","body":{"type":"root","children":[{"type":"element","tag":"h1","props":{"id":"green-digital-skills"},"children":[{"type":"text","value":"Green Digital Skills"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This repository contains the contents for the Green Digital Skills lesson material. This is intended to raise awareness of environmental issues relating to research computing, providing some best practices in green coding and exploring a range of solutions to profile and reduce energy usage for different kinds of common workflows."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The website with this lesson material can be found here: "},{"type":"element","tag":"a","props":{"href":"https://esciencecenter-digital-skills.github.io/green-digital-skills/","rel":["nofollow"]},"children":[{"type":"text","value":"https://esciencecenter-digital-skills.github.io/green-digital-skills/"}]}]},{"type":"element","tag":"h2","props":{"id":"target-audience"},"children":[{"type":"text","value":"Target audience"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"The current lesson material is being developed for a pilot workshop at the Prinses Máxima Centrum."}]},{"type":"element","tag":"h2","props":{"id":"technical-documentation"},"children":[{"type":"text","value":"Technical documentation"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"This platform uses the "},{"type":"element","tag":"a","props":{"href":"https://github.com/esciencecenter-digital-skills/NEBULA","rel":["nofollow"]},"children":[{"type":"text","value":"NEBULA framework"}]},{"type":"text","value":"."}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"For elaborate setup instructions and other documentation, see the "},{"type":"element","tag":"a","props":{"href":"https://github.com/esciencecenter-digital-skills/NEBULA-docs","rel":["nofollow"]},"children":[{"type":"text","value":"NEBULA documentation"}]}]},{"type":"element","tag":"h2","props":{"id":"quick-local-setup"},"children":[{"type":"text","value":"Quick local setup"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"More detailed information about local setup can be found in the "},{"type":"element","tag":"a","props":{"href":"https://github.com/esciencecenter-digital-skills/NEBULA-docs/blob/main/local-rendering.md","rel":["nofollow"]},"children":[{"type":"text","value":"NEBULA local rendering docs"}]}]},{"type":"element","tag":"h3","props":{"id":"content-directoryrepository"},"children":[{"type":"text","value":"Content directory/repository"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To use NEBULA to build the content in this repository locally, you will need to clone this repository and the NEBULA repository:"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"git clone git@github.com:esciencecenter-digital-skills/green-digital-skills.git\ngit clone git@github.com:esciencecenter-digital-skills/NEBULA.git\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"git clone git@github.com:esciencecenter-digital-skills/green-digital-skills.git\ngit clone git@github.com:esciencecenter-digital-skills/NEBULA.git\n"}]}]},{"type":"element","tag":"h3","props":{"id":"link-to-the-content-repository"},"children":[{"type":"text","value":"Link to the content repository"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"To make sure that NEBULA knows where to find the content, we create the following environment variable:"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"export CONTENT_PATH=\"~/path/to/your/content/repository\"\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"export CONTENT_PATH=\"~/path/to/your/content/repository\"\n"}]}]},{"type":"element","tag":"h3","props":{"id":"install-dependencies"},"children":[{"type":"text","value":"Install dependencies"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Install the dependencies using the "},{"type":"element","tag":"a","props":{"href":"https://docs.npmjs.com/downloading-and-installing-node-js-and-npm","rel":["nofollow"]},"children":[{"type":"text","value":"node package manager"}]},{"type":"text","value":":"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"# node package manager\nnpm install\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# node package manager\nnpm install\n"}]}]},{"type":"element","tag":"h3","props":{"id":"local-development-build"},"children":[{"type":"text","value":"Local development build"}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Start the development server on "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost:3000"}]},{"type":"text","value":":"}]},{"type":"element","tag":"pre","props":{"className":["language-bash"],"code":"# node package manager\nnpm run dev\n","language":"bash","meta":""},"children":[{"type":"element","tag":"code","props":{"__ignoreMap":""},"children":[{"type":"text","value":"# node package manager\nnpm run dev\n"}]}]},{"type":"element","tag":"p","props":{},"children":[{"type":"text","value":"Now you can open a browser and navigate to "},{"type":"element","tag":"code","props":{"className":[]},"children":[{"type":"text","value":"http://localhost:3000/green-digital-skills"}]}]}],"toc":{"title":"","searchDepth":2,"depth":2,"links":[{"id":"target-audience","depth":2,"text":"Target audience"},{"id":"technical-documentation","depth":2,"text":"Technical documentation"},{"id":"quick-local-setup","depth":2,"text":"Quick local setup","children":[{"id":"content-directoryrepository","depth":3,"text":"Content directory/repository"},{"id":"link-to-the-content-repository","depth":3,"text":"Link to the content repository"},{"id":"install-dependencies","depth":3,"text":"Install dependencies"},{"id":"local-development-build","depth":3,"text":"Local development build"}]}]}},"_type":"markdown","_id":"local_fs:README.md","_source":"local_fs","_file":"README.md","_stem":"README","_extension":"md","plainText":"# Green Digital Skills\nThis repository contains the contents for the Green Digital Skills lesson material. This is intended to raise awareness of environmental issues relating to research computing, providing some best practices in green coding and exploring a range of solutions to profile and reduce energy usage for different kinds of common workflows.\n\nThe website with this lesson material can be found here: <https://esciencecenter-digital-skills.github.io/green-digital-skills/>\n\n## Target audience\nThe current lesson material is being developed for a pilot workshop at the Prinses Máxima Centrum.\n\n## Technical documentation\nThis platform uses the [NEBULA framework](https://github.com/esciencecenter-digital-skills/NEBULA).\n\nFor elaborate setup instructions and other documentation, see the [NEBULA documentation](https://github.com/esciencecenter-digital-skills/NEBULA-docs)\n\n## Quick local setup\n\nMore detailed information about local setup can be found in the [NEBULA local rendering docs](https://github.com/esciencecenter-digital-skills/NEBULA-docs/blob/main/local-rendering.md)\n\n### Content directory/repository\n\nTo use NEBULA to build the content in this repository locally, you will need to clone this repository and the NEBULA repository:\n\n```bash\ngit clone git@github.com:esciencecenter-digital-skills/green-digital-skills.git\ngit clone git@github.com:esciencecenter-digital-skills/NEBULA.git\n```\n\n### Link to the content repository\n\nTo make sure that NEBULA knows where to find the content, we create the following environment variable:\n\n```bash\nexport CONTENT_PATH=\"~/path/to/your/content/repository\"\n```\n\n### Install dependencies\n\nInstall the dependencies using the [node package manager](https://docs.npmjs.com/downloading-and-installing-node-js-and-npm):\n\n```bash\n# node package manager\nnpm install\n```\n\n### Local development build\n\nStart the development server on `http://localhost:3000`:\n\n```bash\n# node package manager\nnpm run dev\n```\n\nNow you can open a browser and navigate to `http://localhost:3000/green-digital-skills`\n"}],"navigation":[{"title":"Config","_path":"/config"},{"title":"Hello world","_path":"/"},{"title":"LICENSE","_path":"/license"},{"title":"Main","_path":"/main","children":[{"title":"About","_path":"/main/about"},{"title":"Contribute","_path":"/main/contribute"},{"title":"Workshops","_path":"/main/workshops"}]},{"title":"Modules","_path":"/modules","children":[{"title":"Environmental Impact","_path":"/modules/environmental_impact","children":[{"title":"Exercises","_path":"/modules/environmental_impact/exercises"},{"title":"Environmental Impact","_path":"/modules/environmental_impact"},{"title":"Learning objectives","_path":"/modules/environmental_impact/info"},{"title":"Energy","_path":"/modules/environmental_impact/slides_energy_budget"},{"title":"Carbon","_path":"/modules/environmental_impact/slides_energy_budget_part_2"},{"title":"Useful links","_path":"/modules/environmental_impact/useful_links"}]},{"title":"High Performance Computing","_path":"/modules/hpc-handson","children":[{"title":"EARL","_path":"/modules/hpc-handson/earl"},{"title":"Exercises","_path":"/modules/hpc-handson/exercises"},{"title":"Reading material","_path":"/modules/hpc-handson/further_reading"},{"title":"High Performance Computing","_path":"/modules/hpc-handson"},{"title":"Learning objectives","_path":"/modules/hpc-handson/info"},{"title":"Introduction","_path":"/modules/hpc-handson/introduction"},{"title":"HPC Hands-on","_path":"/modules/hpc-handson/slides_hpc"},{"title":"EAR Tools","_path":"/modules/hpc-handson/tools"}]},{"title":"Introduction","_path":"/modules/introduction-handson","children":[{"title":"Why care?","_path":"/modules/introduction-handson/ex_motivation"},{"title":"Green workplace","_path":"/modules/introduction-handson/ex_workfloor"},{"title":"Reading material","_path":"/modules/introduction-handson/further_reading_module1"},{"title":"Introduction","_path":"/modules/introduction-handson"},{"title":"Learning objectives","_path":"/modules/introduction-handson/info"},{"title":"Introduction","_path":"/modules/introduction-handson/sl_introduction-handson"}]},{"title":"Introduction","_path":"/modules/introduction","children":[{"title":"Introduction","_path":"/modules/introduction"},{"title":"Learning objectives","_path":"/modules/introduction/info"},{"title":"Introduction","_path":"/modules/introduction/slides"}]},{"title":"Optimizing Energy Usage","_path":"/modules/optimizing-energy-use","children":[{"title":"Optimizing Energy Usage","_path":"/modules/optimizing-energy-use"},{"title":"Learning objectives","_path":"/modules/optimizing-energy-use/info"},{"title":"Optimizing in Practice","_path":"/modules/optimizing-energy-use/slides_optimizing_energy_use"},{"title":"Useful Links","_path":"/modules/optimizing-energy-use/useful_links"}]},{"title":"Software Development","_path":"/modules/software-development-handson","children":[{"title":"Code Carbon in R","_path":"/modules/software-development-handson/excercises-code-carbon-r"},{"title":"CI/CD optimization","_path":"/modules/software-development-handson/exercises_cicd"},{"title":"Code Carbon","_path":"/modules/software-development-handson/exercises_codecarbon"},{"title":"Good Practices","_path":"/modules/software-development-handson/exercises_good-practices"},{"title":"Extra material","_path":"/modules/software-development-handson/further_reading_module1"},{"title":"Software Development","_path":"/modules/software-development-handson"},{"title":"Learning objectives","_path":"/modules/software-development-handson/info"}]}]},{"title":"Green Digital Skills","_path":"/readme"}]}