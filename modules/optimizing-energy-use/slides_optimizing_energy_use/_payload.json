[{"data":1,"prerenderedAt":1037},["ShallowReactive",2],{"content-query-rjnmBlzztt":3,"content-query-AT44bg6JPw":952},{"_path":4,"_dir":5,"_draft":6,"_partial":6,"_locale":7,"title":8,"description":9,"type":10,"order":11,"body":12,"_type":946,"_id":947,"_source":948,"_file":949,"_extension":950,"plainText":951},"/modules/optimizing-energy-use/slides_optimizing_energy_use","optimizing-energy-use",false,"","Optimizing in Practice","===","slides",1,{"type":13,"children":14,"toc":925},"root",[15,24,29,36,56,60,69,73,79,98,134,139,152,157,162,167,172,176,182,190,203,207,211,215,221,226,240,244,249,259,263,268,279,289,293,297,305,309,314,351,361,365,370,383,387,393,432,436,440,448,452,458,484,488,492,498,508,529,534,539,544,548,554,563,600,604,609,614,619,624,629,633,641,645,651,698,702,706,712,719,765,778,783,787,793,801,813,823,828,851,864,868,874,897,901,911,920],{"type":16,"tag":17,"props":18,"children":20},"element","h1",{"id":19},"optimizing-energy-use-in-practice",[21],{"type":22,"value":23},"text","Optimizing Energy Use in Practice",{"type":16,"tag":25,"props":26,"children":27},"p",{},[28],{"type":22,"value":9},{"type":16,"tag":30,"props":31,"children":33},"h3",{"id":32},"what-we-will-cover-here",[34],{"type":22,"value":35},"What we will cover here",{"type":16,"tag":37,"props":38,"children":39},"ul",{},[40,46,51],{"type":16,"tag":41,"props":42,"children":43},"li",{},[44],{"type":22,"value":45},"What development choices matter?",{"type":16,"tag":41,"props":47,"children":48},{},[49],{"type":22,"value":50},"What should you optimize and how do you know?",{"type":16,"tag":41,"props":52,"children":53},{},[54],{"type":22,"value":55},"What can you do if you can't change the code you're using?",{"type":16,"tag":25,"props":57,"children":58},{},[59],{"type":22,"value":9},{"type":16,"tag":30,"props":61,"children":63},{"id":62},"what-development-choices-matter",[64],{"type":16,"tag":65,"props":66,"children":67},"em",{},[68],{"type":22,"value":45},{"type":16,"tag":25,"props":70,"children":71},{},[72],{"type":22,"value":9},{"type":16,"tag":30,"props":74,"children":76},{"id":75},"good-software-practices",[77],{"type":22,"value":78},"Good software practices",{"type":16,"tag":80,"props":81,"children":82},"center",{},[83,90,94],{"type":16,"tag":84,"props":85,"children":89},"img",{"src":86,"width":87,"style":88},"media/testing-motivation1.png","30%","display:inline;",[],{"type":16,"tag":84,"props":91,"children":93},{"src":92,"width":87,"style":88},"media/testing-motivation2.png",[],{"type":16,"tag":84,"props":95,"children":97},{"src":96,"width":87,"style":88},"media/testing-motivation3.png",[],{"type":16,"tag":25,"props":99,"children":100},{},[101],{"type":16,"tag":102,"props":103,"children":104},"small",{},[105,107,116,118,124,126,132],{"type":22,"value":106}," Find the complete articles ",{"type":16,"tag":108,"props":109,"children":113},"a",{"href":110,"rel":111},"https://www.science.org/doi/full/10.1126/science.314.5807.1856",[112],"nofollow",[114],{"type":22,"value":115},"here",{"type":22,"value":117},", ",{"type":16,"tag":108,"props":119,"children":122},{"href":120,"rel":121},"https://arstechnica.com/information-technology/2019/10/chemists-discover-cross-platform-python-scripts-not-so-cross-platform/",[112],[123],{"type":22,"value":115},{"type":22,"value":125},", and ",{"type":16,"tag":108,"props":127,"children":130},{"href":128,"rel":129},"https://www.wired.com/2010/11/1110mars-climate-observer-report/",[112],[131],{"type":22,"value":115},{"type":22,"value":133}," ",{"type":16,"tag":25,"props":135,"children":136},{},[137],{"type":22,"value":138},"Clean and maintainable software with a robust testing framework is essential\nfor sustainable/green software:",{"type":16,"tag":37,"props":140,"children":141},{},[142,147],{"type":16,"tag":41,"props":143,"children":144},{},[145],{"type":22,"value":146},"Ease of use, reduce error during data settings",{"type":16,"tag":41,"props":148,"children":149},{},[150],{"type":22,"value":151},"Less bugs, avoid wasteful bugged runs",{"type":16,"tag":25,"props":153,"children":154},{},[155],{"type":22,"value":156},"Note:",{"type":16,"tag":25,"props":158,"children":159},{},[160],{"type":22,"value":161},"Poor testing and bad software practices lead not only to wrong and retracted papers, but also contribute to a lot of wasted energy...",{"type":16,"tag":25,"props":163,"children":164},{},[165],{"type":22,"value":166},"In the long run, this is as important as measuring the energy use of your code, optimizing run time etc.",{"type":16,"tag":25,"props":168,"children":169},{},[170],{"type":22,"value":171},"We (optionally) cover good software practices in this afternoon's hands-on workshop.",{"type":16,"tag":25,"props":173,"children":174},{},[175],{"type":22,"value":9},{"type":16,"tag":30,"props":177,"children":179},{"id":178},"software-life-cycle",[180],{"type":22,"value":181},"Software life cycle",{"type":16,"tag":80,"props":183,"children":184},{},[185],{"type":16,"tag":84,"props":186,"children":189},{"src":187,"width":188},"media/cicd_scheme.png","50%",[],{"type":16,"tag":37,"props":191,"children":192},{},[193,198],{"type":16,"tag":41,"props":194,"children":195},{},[196],{"type":22,"value":197},"Thinking about long term sustainability, documentation.",{"type":16,"tag":41,"props":199,"children":200},{},[201],{"type":22,"value":202},"Reusable software is a key component of modern\nsoftware development, reducing the time/energy consuming\ntask of developing every component of complex softwares.",{"type":16,"tag":25,"props":204,"children":205},{},[206],{"type":22,"value":156},{"type":16,"tag":25,"props":208,"children":209},{},[210],{"type":22,"value":171},{"type":16,"tag":25,"props":212,"children":213},{},[214],{"type":22,"value":9},{"type":16,"tag":30,"props":216,"children":218},{"id":217},"what-language-should-i-use",[219],{"type":22,"value":220},"What language should I use?",{"type":16,"tag":222,"props":223,"children":225},"div",{"style":224},"width: 50%; float: left; margin-top: 1%",[],{"type":16,"tag":222,"props":227,"children":229},{"style":228},"width: 50%; float: right",[230],{"type":16,"tag":25,"props":231,"children":232},{},[233],{"type":16,"tag":84,"props":234,"children":239},{"alt":235,"src":236,"style":237},"Ranking of languages","/modules/optimizing-energy-use/media/language_ranking.png",{"aspectRatio":238},"876/950",[],{"type":16,"tag":25,"props":241,"children":242},{},[243],{"type":22,"value":156},{"type":16,"tag":25,"props":245,"children":246},{},[247],{"type":22,"value":248},"Energy ranking of languages across many different benchmarks",{"type":16,"tag":25,"props":250,"children":251},{},[252,254],{"type":22,"value":253},"Table is from Pereira, R. et al. (2021) ",{"type":16,"tag":108,"props":255,"children":257},{"href":256},"doi:10.1016/j.scico.2021.102609",[258],{"type":22,"value":256},{"type":16,"tag":25,"props":260,"children":261},{},[262],{"type":22,"value":9},{"type":16,"tag":30,"props":264,"children":266},{"id":265},"what-language-should-i-use-1",[267],{"type":22,"value":220},{"type":16,"tag":222,"props":269,"children":270},{"style":224},[271],{"type":16,"tag":37,"props":272,"children":273},{},[274],{"type":16,"tag":41,"props":275,"children":276},{},[277],{"type":22,"value":278},"Let's use C for everything!",{"type":16,"tag":222,"props":280,"children":281},{"style":228},[282],{"type":16,"tag":25,"props":283,"children":284},{},[285],{"type":16,"tag":84,"props":286,"children":288},{"alt":235,"src":236,"style":287},{"aspectRatio":238},[],{"type":16,"tag":25,"props":290,"children":291},{},[292],{"type":22,"value":156},{"type":16,"tag":25,"props":294,"children":295},{},[296],{"type":22,"value":248},{"type":16,"tag":25,"props":298,"children":299},{},[300,301],{"type":22,"value":253},{"type":16,"tag":108,"props":302,"children":303},{"href":256},[304],{"type":22,"value":256},{"type":16,"tag":25,"props":306,"children":307},{},[308],{"type":22,"value":9},{"type":16,"tag":30,"props":310,"children":312},{"id":311},"what-language-should-i-use-2",[313],{"type":22,"value":220},{"type":16,"tag":222,"props":315,"children":316},{"style":224},[317],{"type":16,"tag":37,"props":318,"children":319},{},[320,324,329],{"type":16,"tag":41,"props":321,"children":322},{},[323],{"type":22,"value":278},{"type":16,"tag":41,"props":325,"children":326},{},[327],{"type":22,"value":328},"Please don't. Reality is more nuanced.",{"type":16,"tag":41,"props":330,"children":331},{},[332,338],{"type":16,"tag":333,"props":334,"children":335},"strong",{},[336],{"type":22,"value":337},"Many major numerical libraries in Python are not Python \"under the surface\"",{"type":16,"tag":37,"props":339,"children":340},{},[341,346],{"type":16,"tag":41,"props":342,"children":343},{},[344],{"type":22,"value":345},"The core is usually C++ or similar",{"type":16,"tag":41,"props":347,"children":348},{},[349],{"type":22,"value":350},"e.g. PyTorch, Tensorflow, numpy (and many others)",{"type":16,"tag":222,"props":352,"children":353},{"style":228},[354],{"type":16,"tag":25,"props":355,"children":356},{},[357],{"type":16,"tag":84,"props":358,"children":360},{"alt":235,"src":236,"style":359},{"aspectRatio":238},[],{"type":16,"tag":25,"props":362,"children":363},{},[364],{"type":22,"value":156},{"type":16,"tag":25,"props":366,"children":367},{},[368],{"type":22,"value":369},"Typical ranking:",{"type":16,"tag":37,"props":371,"children":372},{},[373,378],{"type":16,"tag":41,"props":374,"children":375},{},[376],{"type":22,"value":377},"C++ and Rust at the top",{"type":16,"tag":41,"props":379,"children":380},{},[381],{"type":22,"value":382},"Python and R at the bottom",{"type":16,"tag":25,"props":384,"children":385},{},[386],{"type":22,"value":9},{"type":16,"tag":30,"props":388,"children":390},{"id":389},"use-the-right-tool-for-each-task",[391],{"type":22,"value":392},"Use the right tool for each task",{"type":16,"tag":37,"props":394,"children":395},{},[396,401,419],{"type":16,"tag":41,"props":397,"children":398},{},[399],{"type":22,"value":400},"Should I avoid \"slow\" and inefficient programming languages?",{"type":16,"tag":41,"props":402,"children":403},{},[404,406],{"type":22,"value":405},"Well, each has its purpose\n",{"type":16,"tag":37,"props":407,"children":408},{},[409,414],{"type":16,"tag":41,"props":410,"children":411},{},[412],{"type":22,"value":413},"Python: great for stitching pieces together, easy prototyping",{"type":16,"tag":41,"props":415,"children":416},{},[417],{"type":22,"value":418},"C/C++/Fortran: better at crunching numbers fast",{"type":16,"tag":41,"props":420,"children":421},{},[422,424],{"type":22,"value":423},"Language benchmarks available in the literature can be misleading here\n",{"type":16,"tag":37,"props":425,"children":426},{},[427],{"type":16,"tag":41,"props":428,"children":429},{},[430],{"type":22,"value":431},"Python/R for can be fine, it's more about the libraries you are using",{"type":16,"tag":25,"props":433,"children":434},{},[435],{"type":22,"value":156},{"type":16,"tag":25,"props":437,"children":438},{},[439],{"type":22,"value":9},{"type":16,"tag":30,"props":441,"children":443},{"id":442},"what-should-you-optimize-and-how-do-you-know",[444],{"type":16,"tag":65,"props":445,"children":446},{},[447],{"type":22,"value":50},{"type":16,"tag":25,"props":449,"children":450},{},[451],{"type":22,"value":9},{"type":16,"tag":30,"props":453,"children":455},{"id":454},"dont-optimize-everything",[456],{"type":22,"value":457},"Don't optimize everything",{"type":16,"tag":37,"props":459,"children":460},{},[461,469,474,479],{"type":16,"tag":41,"props":462,"children":463},{},[464],{"type":16,"tag":333,"props":465,"children":466},{},[467],{"type":22,"value":468},"It is important that frequently used tools are as efficient as possible",{"type":16,"tag":41,"props":470,"children":471},{},[472],{"type":22,"value":473},"Your single-use analysis scripts probably don't matter so much - just use the easiest language for the job",{"type":16,"tag":41,"props":475,"children":476},{},[477],{"type":22,"value":478},"Optimization is not free and costs development time (and energy) especially in lower level languages like C",{"type":16,"tag":41,"props":480,"children":481},{},[482],{"type":22,"value":483},"Generally there are not enough RSEs to do all the coding and optimizations, and researchers don't have time",{"type":16,"tag":25,"props":485,"children":486},{},[487],{"type":22,"value":156},{"type":16,"tag":25,"props":489,"children":490},{},[491],{"type":22,"value":9},{"type":16,"tag":30,"props":493,"children":495},{"id":494},"minimize-time-to-solution",[496],{"type":22,"value":497},"Minimize time to solution",{"type":16,"tag":25,"props":499,"children":500},{},[501],{"type":16,"tag":502,"props":503,"children":505},"code",{"className":504},[],[506],{"type":22,"value":507},"$$ E = Pt$$",{"type":16,"tag":37,"props":509,"children":510},{},[511,516],{"type":16,"tag":41,"props":512,"children":513},{},[514],{"type":22,"value":515},"Energy is Power * time",{"type":16,"tag":41,"props":517,"children":518},{},[519,521],{"type":22,"value":520},"As a first approximation, more efficient (faster) software will be energy efficient\n",{"type":16,"tag":37,"props":522,"children":523},{},[524],{"type":16,"tag":41,"props":525,"children":526},{},[527],{"type":22,"value":528},"It is possible to run on many CPUs although there is overhead from the parallelism.",{"type":16,"tag":25,"props":530,"children":531},{},[532],{"type":22,"value":533},"How to do this is very problem-dependent!",{"type":16,"tag":25,"props":535,"children":536},{},[537],{"type":22,"value":538},"Note:\nGenerally speaking, finish as quickly as possible so the CPU can drop to a lower energy state",{"type":16,"tag":25,"props":540,"children":541},{},[542],{"type":22,"value":543},"How to get maximum speed out of your code (including parallelism/accelerators) is beyond the scope of this course by quite some distance.",{"type":16,"tag":25,"props":545,"children":546},{},[547],{"type":22,"value":9},{"type":16,"tag":30,"props":549,"children":551},{"id":550},"profile-your-code",[552],{"type":22,"value":553},"Profile your code",{"type":16,"tag":25,"props":555,"children":556},{},[557],{"type":16,"tag":84,"props":558,"children":562},{"alt":7,"src":559,"style":560},"/modules/optimizing-energy-use/media/code-carbon.png",{"aspectRatio":561},"300/194",[],{"type":16,"tag":37,"props":564,"children":565},{},[566],{"type":16,"tag":41,"props":567,"children":568},{},[569,571,577,579],{"type":22,"value":570},"We recommend trying ",{"type":16,"tag":502,"props":572,"children":574},{"className":573},[],[575],{"type":22,"value":576},"CodeCarbon",{"type":22,"value":578}," python package\n",{"type":16,"tag":37,"props":580,"children":581},{},[582,587,592],{"type":16,"tag":41,"props":583,"children":584},{},[585],{"type":22,"value":586},"Estimates the amount of carbon dioxide (CO$_2$) produced by the cloud or personal computing resources used to execute the code",{"type":16,"tag":41,"props":588,"children":589},{},[590],{"type":22,"value":591},"Gives recommendations for reducing emissions (e.g. through optimizing the code or by hosting cloud infrastructure in geographical regions that use renewable energy sources)",{"type":16,"tag":41,"props":593,"children":594},{},[595],{"type":16,"tag":65,"props":596,"children":597},{},[598],{"type":22,"value":599},"More in this afternoon's hands-on workshop",{"type":16,"tag":25,"props":601,"children":602},{},[603],{"type":22,"value":156},{"type":16,"tag":25,"props":605,"children":606},{},[607],{"type":22,"value":608},"There are many ways to do energy profiling e.g. PMT (Power Measurement Toolkit), Rjoules, and many more.",{"type":16,"tag":25,"props":610,"children":611},{},[612],{"type":22,"value":613},"We recommend trying CodeCarbon",{"type":16,"tag":25,"props":615,"children":616},{},[617],{"type":22,"value":618},"The code-carbon.io website decribes it as \"a lightweight software package that seamlessly integrates into your Python codebase. It estimates the amount of carbon dioxide (CO$_2$) produced by the cloud or personal computing resources used to execute the code.",{"type":16,"tag":25,"props":620,"children":621},{},[622],{"type":22,"value":623},"It then shows developers how they can lessen emissions by optimizing their code or by hosting their cloud infrastructure in geographical regions that use renewable energy sources.\"",{"type":16,"tag":25,"props":625,"children":626},{},[627],{"type":22,"value":628},"This sounds like a good place to start for researchers here.",{"type":16,"tag":25,"props":630,"children":631},{},[632],{"type":22,"value":9},{"type":16,"tag":30,"props":634,"children":636},{"id":635},"what-can-you-do-if-you-cant-change-the-code-youre-using",[637],{"type":16,"tag":65,"props":638,"children":639},{},[640],{"type":22,"value":55},{"type":16,"tag":25,"props":642,"children":643},{},[644],{"type":22,"value":9},{"type":16,"tag":30,"props":646,"children":648},{"id":647},"what-if-i-cantwont-change-the-code",[649],{"type":22,"value":650},"What if I can't/won't change the code?",{"type":16,"tag":37,"props":652,"children":653},{},[654,667],{"type":16,"tag":41,"props":655,"children":656},{},[657,659],{"type":22,"value":658},"Perhaps you can profile the code but you cannot do much with the results\n",{"type":16,"tag":37,"props":660,"children":661},{},[662],{"type":16,"tag":41,"props":663,"children":664},{},[665],{"type":22,"value":666},"e.g. You are not the developer, or don't feel experienced enough",{"type":16,"tag":41,"props":668,"children":669},{},[670,672],{"type":22,"value":671},"There are tools such as the Energy Aware Runtime\n",{"type":16,"tag":37,"props":673,"children":674},{},[675,680,685,690],{"type":16,"tag":41,"props":676,"children":677},{},[678],{"type":22,"value":679},"Dynamically scales the CPU or GPU clock frequency up or down while the code is running",{"type":16,"tag":41,"props":681,"children":682},{},[683],{"type":22,"value":684},"When code is waiting a lot (for I/O or memory), frequency is scaled down",{"type":16,"tag":41,"props":686,"children":687},{},[688],{"type":22,"value":689},"Remember that Energy ~ frequency^2",{"type":16,"tag":41,"props":691,"children":692},{},[693],{"type":16,"tag":65,"props":694,"children":695},{},[696],{"type":22,"value":697},"Also covered in this afternoon's hands-on workshop (HPC-track)",{"type":16,"tag":25,"props":699,"children":700},{},[701],{"type":22,"value":156},{"type":16,"tag":25,"props":703,"children":704},{},[705],{"type":22,"value":9},{"type":16,"tag":30,"props":707,"children":709},{"id":708},"minimizing-energy-and-carbon",[710],{"type":22,"value":711},"Minimizing energy (and carbon)",{"type":16,"tag":84,"props":713,"children":718},{"src":714,"width":715,"style":716},"/modules/optimizing-energy-use/media/carbon-aware-software.png","40%",{"aspectRatio":717},"1920/1080",[],{"type":16,"tag":37,"props":720,"children":721},{},[722,734,747],{"type":16,"tag":41,"props":723,"children":724},{},[725,727,732],{"type":22,"value":726},"Think about ",{"type":16,"tag":65,"props":728,"children":729},{},[730],{"type":22,"value":731},"when",{"type":22,"value":733}," we run a job on a server. Energy mix different at different times",{"type":16,"tag":41,"props":735,"children":736},{},[737,739],{"type":22,"value":738},"Interesting new tools such as Carbon Aware Task Scheduler (UK-only currently)\n",{"type":16,"tag":37,"props":740,"children":741},{},[742],{"type":16,"tag":41,"props":743,"children":744},{},[745],{"type":22,"value":746},"Tells you what is the best time to run in the next 48 hours",{"type":16,"tag":41,"props":748,"children":749},{},[750,752],{"type":22,"value":751},"Think about what resources you request\n",{"type":16,"tag":37,"props":753,"children":754},{},[755,760],{"type":16,"tag":41,"props":756,"children":757},{},[758],{"type":22,"value":759},"Number of CPU cores is clearly a large contributor",{"type":16,"tag":41,"props":761,"children":762},{},[763],{"type":22,"value":764},"Carbon footprint of memory is interesting - it doesn't matter how much you use, but how much is available. Don't request 10 times the memory you need on a server \"just in case\"",{"type":16,"tag":25,"props":766,"children":767},{},[768,770,776],{"type":22,"value":769},"Note:\nCarbon awareness image is from ",{"type":16,"tag":108,"props":771,"children":774},{"href":772,"rel":773},"https://github.com/Green-Software-Foundation/carbon-aware-sdk",[112],[775],{"type":22,"value":772},{"type":22,"value":777},".",{"type":16,"tag":25,"props":779,"children":780},{},[781],{"type":22,"value":782},"Most jobs have some flexibility - we don't care if we run it right now or in a few hours. Especially over the weekend.",{"type":16,"tag":25,"props":784,"children":785},{},[786],{"type":22,"value":9},{"type":16,"tag":30,"props":788,"children":790},{"id":789},"a-warning-jevons-paradox",[791],{"type":22,"value":792},"A warning: Jevon's Paradox",{"type":16,"tag":25,"props":794,"children":795},{},[796],{"type":16,"tag":65,"props":797,"children":798},{},[799],{"type":22,"value":800},"In economics, the Jevons paradox occurs when technological progress increases\nthe efficiency with which a resource is used (reducing the amount necessary for any one use),\nbut the falling cost of use induces increases in demand enough that resource use is increased,\nrather than reduced.",{"type":16,"tag":37,"props":802,"children":803},{},[804],{"type":16,"tag":41,"props":805,"children":806},{},[807],{"type":16,"tag":108,"props":808,"children":811},{"href":809,"rel":810},"https://en.wikipedia.org/wiki/Jevons_paradox",[112],[812],{"type":22,"value":809},{"type":16,"tag":25,"props":814,"children":815},{},[816],{"type":16,"tag":84,"props":817,"children":822},{"alt":818,"src":819,"style":820},"Interchange in Chicago","/modules/optimizing-energy-use/media/interchange.jpg",{"aspectRatio":821},"1600/900",[],{"type":16,"tag":25,"props":824,"children":825},{},[826],{"type":22,"value":827},"Note:\nIn practice, reducing energy use overall is more about organizational policy and value judgements about what the expected return is for a given amount of energy used.",{"type":16,"tag":37,"props":829,"children":830},{},[831,836,841,846],{"type":16,"tag":41,"props":832,"children":833},{},[834],{"type":22,"value":835},"Are you thinking about this the right way?",{"type":16,"tag":41,"props":837,"children":838},{},[839],{"type":22,"value":840},"Is green computing really a purely technical issue?",{"type":16,"tag":41,"props":842,"children":843},{},[844],{"type":22,"value":845},"Is your footprint by computing really your biggest contribution to the climate crisis?",{"type":16,"tag":41,"props":847,"children":848},{},[849],{"type":22,"value":850},"Organizational policy is as important if not more important",{"type":16,"tag":25,"props":852,"children":853},{},[854,856,862],{"type":22,"value":855},"Image attribution:\nSea Cow, CC BY-SA 4.0 ",{"type":16,"tag":108,"props":857,"children":860},{"href":858,"rel":859},"https://creativecommons.org/licenses/by-sa/4.0",[112],[861],{"type":22,"value":858},{"type":22,"value":863},", via Wikimedia Commons",{"type":16,"tag":25,"props":865,"children":866},{},[867],{"type":22,"value":9},{"type":16,"tag":30,"props":869,"children":871},{"id":870},"key-points",[872],{"type":22,"value":873},"Key points",{"type":16,"tag":37,"props":875,"children":876},{},[877,882,887,892],{"type":16,"tag":41,"props":878,"children":879},{},[880],{"type":22,"value":881},"Don't neglect good software development practices",{"type":16,"tag":41,"props":883,"children":884},{},[885],{"type":22,"value":886},"The libraries you use can matter as much as language choice",{"type":16,"tag":41,"props":888,"children":889},{},[890],{"type":22,"value":891},"Only optimize code if it will have impact (runs a lot, uses a lot of energy)",{"type":16,"tag":41,"props":893,"children":894},{},[895],{"type":22,"value":896},"If you can't change the code, choose when/where to submit it or use a frequency scaling tool",{"type":16,"tag":25,"props":898,"children":899},{},[900],{"type":22,"value":9},{"type":16,"tag":25,"props":902,"children":903},{},[904],{"type":16,"tag":108,"props":905,"children":908},{"href":906,"rel":907},"http://www.esciencecenter.nl",[112],[909],{"type":22,"value":910},"www.esciencecenter.nl",{"type":16,"tag":25,"props":912,"children":913},{},[914],{"type":16,"tag":108,"props":915,"children":917},{"href":916},"mailto:info@esciencecenter.nl",[918],{"type":22,"value":919},"info@esciencecenter.nl",{"type":16,"tag":25,"props":921,"children":922},{},[923],{"type":22,"value":924},"020 - 460 47 70",{"title":7,"searchDepth":926,"depth":926,"links":927},2,[928,930,931,932,933,934,935,936,937,938,939,940,941,942,943,944,945],{"id":32,"depth":929,"text":35},3,{"id":62,"depth":929,"text":45},{"id":75,"depth":929,"text":78},{"id":178,"depth":929,"text":181},{"id":217,"depth":929,"text":220},{"id":265,"depth":929,"text":220},{"id":311,"depth":929,"text":220},{"id":389,"depth":929,"text":392},{"id":442,"depth":929,"text":50},{"id":454,"depth":929,"text":457},{"id":494,"depth":929,"text":497},{"id":550,"depth":929,"text":553},{"id":635,"depth":929,"text":55},{"id":647,"depth":929,"text":650},{"id":708,"depth":929,"text":711},{"id":789,"depth":929,"text":792},{"id":870,"depth":929,"text":873},"markdown","local_fs:modules:optimizing-energy-use:slides_optimizing_energy_use.md","local_fs","modules/optimizing-energy-use/slides_optimizing_energy_use.md","md","---\ntitle: Optimizing in Practice\ntype: slides\norder: 1\n---\n\n\u003C!-- .slide: data-state=\"title\" -->\n\n# Optimizing Energy Use in Practice\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### What we will cover here\n- What development choices matter?\n- What should you optimize and how do you know?\n- What can you do if you can't change the code you're using?\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _What development choices matter?_\n\n===\n\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### Good software practices\n\n\u003Ccenter>\n\u003Cimg src=\"media/testing-motivation1.png\" width=\"30%\" style=\"display:inline;\">\n\u003Cimg src=\"media/testing-motivation2.png\" width=\"30%\" style=\"display:inline;\">\n\u003Cimg src=\"media/testing-motivation3.png\" width=\"30%\" style=\"display:inline;\">\n\u003C/center>\n\n\u003Csmall> Find the complete articles [here](https://www.science.org/doi/full/10.1126/science.314.5807.1856), [here](https://arstechnica.com/information-technology/2019/10/chemists-discover-cross-platform-python-scripts-not-so-cross-platform/), and [here](https://www.wired.com/2010/11/1110mars-climate-observer-report/) \u003C/small>\n\n\nClean and maintainable software with a robust testing framework is essential\nfor sustainable/green software:\n - Ease of use, reduce error during data settings\n - Less bugs, avoid wasteful bugged runs\n\nNote:\n\nPoor testing and bad software practices lead not only to wrong and retracted papers, but also contribute to a lot of wasted energy...\n\nIn the long run, this is as important as measuring the energy use of your code, optimizing run time etc.\n\nWe (optionally) cover good software practices in this afternoon's hands-on workshop.\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### Software life cycle\n\n\u003Ccenter>\n\u003Cimg src=\"media/cicd_scheme.png\" width=\"50%\">\n\u003C/center>\n\n- Thinking about long term sustainability, documentation.\n- Reusable software is a key component of modern\nsoftware development, reducing the time/energy consuming\ntask of developing every component of complex softwares.\n\nNote:\n\nWe (optionally) cover good software practices in this afternoon's hands-on workshop.\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### What language should I use?\n\n\u003Cdiv style=\"width: 50%; float: left; margin-top: 1%\">\n\n\n\u003C/div>\n\n\u003Cdiv style=\"width: 50%; float: right\">\n\n![Ranking of languages](media/language_ranking.png)\n\n\u003C/div>\n\nNote:\n\nEnergy ranking of languages across many different benchmarks\n\nTable is from Pereira, R. et al. (2021) \u003Cdoi:10.1016/j.scico.2021.102609>\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### What language should I use?\n\n\u003Cdiv style=\"width: 50%; float: left; margin-top: 1%\">\n\n- Let's use C for everything!\n\n\u003C/div>\n\n\u003Cdiv style=\"width: 50%; float: right\">\n\n![Ranking of languages](media/language_ranking.png)\n\n\u003C/div>\n\nNote:\n\nEnergy ranking of languages across many different benchmarks\n\nTable is from Pereira, R. et al. (2021) \u003Cdoi:10.1016/j.scico.2021.102609>\n\n===\n\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### What language should I use?\n\n\u003Cdiv style=\"width: 50%; float: left; margin-top: 1%\">\n\n- Let's use C for everything!\n- Please don't. Reality is more nuanced.\n- **Many major numerical libraries in Python are not Python \"under the surface\"**\n  - The core is usually C++ or similar\n  - e.g. PyTorch, Tensorflow, numpy (and many others)\n\n\n\u003C/div>\n\n\u003Cdiv style=\"width: 50%; float: right\">\n\n![Ranking of languages](media/language_ranking.png)\n\n\u003C/div>\n\n\nNote:\n\nTypical ranking:\n  - C++ and Rust at the top\n  - Python and R at the bottom\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### Use the right tool for each task\n\n- Should I avoid \"slow\" and inefficient programming languages?\n- Well, each has its purpose\n  - Python: great for stitching pieces together, easy prototyping\n  - C/C++/Fortran: better at crunching numbers fast\n- Language benchmarks available in the literature can be misleading here\n  - Python/R for can be fine, it's more about the libraries you are using\n\nNote:\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _What should you optimize and how do you know?_\n\n===\n\n\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### Don't optimize everything\n\n- **It is important that frequently used tools are as efficient as possible**\n- Your single-use analysis scripts probably don't matter so much - just use the easiest language for the job\n- Optimization is not free and costs development time (and energy) especially in lower level languages like C\n- Generally there are not enough RSEs to do all the coding and optimizations, and researchers don't have time\n\nNote:\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### Minimize time to solution\n\n`$$ E = Pt$$`\n- Energy is Power * time\n- As a first approximation, more efficient (faster) software will be energy efficient\n  - It is possible to run on many CPUs although there is overhead from the parallelism.\n\nHow to do this is very problem-dependent!\n\nNote:\nGenerally speaking, finish as quickly as possible so the CPU can drop to a lower energy state\n\nHow to get maximum speed out of your code (including parallelism/accelerators) is beyond the scope of this course by quite some distance.\n\n===\n\n### Profile your code\n\n![](media/code-carbon.png)\n\n- We recommend trying `CodeCarbon` python package\n  - Estimates the amount of carbon dioxide (CO$_2$) produced by the cloud or personal computing resources used to execute the code\n  - Gives recommendations for reducing emissions (e.g. through optimizing the code or by hosting cloud infrastructure in geographical regions that use renewable energy sources)\n  - *More in this afternoon's hands-on workshop*\n\nNote:\n\nThere are many ways to do energy profiling e.g. PMT (Power Measurement Toolkit), Rjoules, and many more.\n\nWe recommend trying CodeCarbon\n\nThe code-carbon.io website decribes it as \"a lightweight software package that seamlessly integrates into your Python codebase. It estimates the amount of carbon dioxide (CO$_2$) produced by the cloud or personal computing resources used to execute the code.\n\nIt then shows developers how they can lessen emissions by optimizing their code or by hosting their cloud infrastructure in geographical regions that use renewable energy sources.\"\n\nThis sounds like a good place to start for researchers here.\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" data-background-gradient=\"radial-gradient(rgb(230, 200, 255), rgb(255, 255, 255))\" -->\n\n### _What can you do if you can't change the code you're using?_\n\n===\n\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### What if I can't/won't change the code?\n\n- Perhaps you can profile the code but you cannot do much with the results\n  - e.g. You are not the developer, or don't feel experienced enough\n- There are tools such as the Energy Aware Runtime\n  - Dynamically scales the CPU or GPU clock frequency up or down while the code is running\n  - When code is waiting a lot (for I/O or memory), frequency is scaled down\n  - Remember that Energy ~ frequency^2\n  - *Also covered in this afternoon's hands-on workshop (HPC-track)*\n\nNote:\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### Minimizing energy (and carbon)\n\n\u003Cimg src=\"media/carbon-aware-software.png\" width=\"40%\">\n\n- Think about _when_ we run a job on a server. Energy mix different at different times\n- Interesting new tools such as Carbon Aware Task Scheduler (UK-only currently)\n  - Tells you what is the best time to run in the next 48 hours\n- Think about what resources you request\n  - Number of CPU cores is clearly a large contributor\n  - Carbon footprint of memory is interesting - it doesn't matter how much you use, but how much is available. Don't request 10 times the memory you need on a server \"just in case\"\n\nNote:\nCarbon awareness image is from \u003Chttps://github.com/Green-Software-Foundation/carbon-aware-sdk>.\n\nMost jobs have some flexibility - we don't care if we run it right now or in a few hours. Especially over the weekend.\n\n\n===\n\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### A warning: Jevon's Paradox\n\n\n_In economics, the Jevons paradox occurs when technological progress increases\nthe efficiency with which a resource is used (reducing the amount necessary for any one use),\nbut the falling cost of use induces increases in demand enough that resource use is increased,\nrather than reduced._\n\n- [https://en.wikipedia.org/wiki/Jevons_paradox](https://en.wikipedia.org/wiki/Jevons_paradox)\n\n![Interchange in Chicago](media/interchange.jpg)\n\nNote:\nIn practice, reducing energy use overall is more about organizational policy and value judgements about what the expected return is for a given amount of energy used.\n\n* Are you thinking about this the right way?\n* Is green computing really a purely technical issue?\n* Is your footprint by computing really your biggest contribution to the climate crisis?\n* Organizational policy is as important if not more important\n\nImage attribution:\nSea Cow, CC BY-SA 4.0 \u003Chttps://creativecommons.org/licenses/by-sa/4.0>, via Wikimedia Commons\n\n===\n\n\u003C!-- .slide: data-state=\"standard\" -->\n\n### Key points\n  \n- Don't neglect good software development practices\n- The libraries you use can matter as much as language choice\n- Only optimize code if it will have impact (runs a lot, uses a lot of energy)\n- If you can't change the code, choose when/where to submit it or use a frequency scaling tool\n\n===\n\n\n\u003C!-- .slide: data-state=\"keepintouch\" -->\n\n\nwww.esciencecenter.nl\n\ninfo@esciencecenter.nl\n\n020 - 460 47 70\n",[953,1015],{"_path":954,"_dir":955,"_draft":6,"_partial":6,"_locale":7,"title":956,"description":7,"body":957,"_type":946,"_id":1012,"_source":948,"_file":1013,"_extension":950,"plainText":1014},"/main/about","main","About",{"type":13,"children":958,"toc":1008},[959,966,971,976,997,1003],{"type":16,"tag":960,"props":961,"children":963},"h2",{"id":962},"about-the-green-digital-skills-course",[964],{"type":22,"value":965},"About the Green Digital Skills course",{"type":16,"tag":25,"props":967,"children":968},{},[969],{"type":22,"value":970},"In this course, we want to equip the attendees with\na basic knowledge of the link from digital and computational science to energy consumption, and\neventually equivalent CO2 emissions.",{"type":16,"tag":25,"props":972,"children":973},{},[974],{"type":22,"value":975},"The course material consists of two parts:",{"type":16,"tag":37,"props":977,"children":978},{},[979,992],{"type":16,"tag":41,"props":980,"children":981},{},[982,984,990],{"type":22,"value":983},"a lecture, in three chapters, introducing the general topic of ",{"type":16,"tag":502,"props":985,"children":987},{"className":986},[],[988],{"type":22,"value":989},"green",{"type":22,"value":991}," computing",{"type":16,"tag":41,"props":993,"children":994},{},[995],{"type":22,"value":996},"a set of hands-on exercises, covering general good practices for software development, and tools for measuring energy and CO2 emissions on your laptop or on HPC clusters",{"type":16,"tag":960,"props":998,"children":1000},{"id":999},"target-audience",[1001],{"type":22,"value":1002},"Target audience",{"type":16,"tag":25,"props":1004,"children":1005},{},[1006],{"type":22,"value":1007},"The target audience for this course includes, but is not limited to, students, reseachers,\ndata scientists, and IT support staff performing computational science, handling data, or\nusing/developing scientific software.",{"title":7,"searchDepth":926,"depth":926,"links":1009},[1010,1011],{"id":962,"depth":926,"text":965},{"id":999,"depth":926,"text":1002},"local_fs:main:about.md","main/about.md","---\ntitle: About\n---\n\n## About the Green Digital Skills course\n\nIn this course, we want to equip the attendees with\na basic knowledge of the link from digital and computational science to energy consumption, and\neventually equivalent CO2 emissions.\n\nThe course material consists of two parts: \n - a lecture, in three chapters, introducing the general topic of `green` computing\n - a set of hands-on exercises, covering general good practices for software development, and tools for measuring energy and CO2 emissions on your laptop or on HPC clusters \n\n\n## Target audience\n\nThe target audience for this course includes, but is not limited to, students, reseachers,\ndata scientists, and IT support staff performing computational science, handling data, or\nusing/developing scientific software.\n",{"_path":1016,"_dir":955,"_draft":6,"_partial":6,"_locale":7,"title":1017,"description":7,"body":1018,"_type":946,"_id":1034,"_source":948,"_file":1035,"_extension":950,"plainText":1036},"/main/contribute","Contribute",{"type":13,"children":1019,"toc":1031},[1020,1026],{"type":16,"tag":960,"props":1021,"children":1023},{"id":1022},"contributing-to-this-lesson",[1024],{"type":22,"value":1025},"Contributing to this lesson",{"type":16,"tag":25,"props":1027,"children":1028},{},[1029],{"type":22,"value":1030},"Add contributing guidelines for you project.",{"title":7,"searchDepth":926,"depth":926,"links":1032},[1033],{"id":1022,"depth":926,"text":1025},"local_fs:main:contribute.md","main/contribute.md","---\ntitle: Contribute\n---\n\n## Contributing to this lesson\n\nAdd contributing guidelines for you project.",1731866273111]